(()=>{"use strict";var e={5214:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.module=void 0,t.module={emailOtpHtml:function(e){return`\n  <p><span style="font-size:14px">เรียน ผู้ใช้งาน</span></p>\n  <p>&nbsp;</p>\n  <p><span style="font-size:14px">&nbsp;        โปรดนำรหัส (OTP) ด้านล่างนี้ไประบุในหน้ายืนยันอีเมล เพื่อยืนยันตัวตนสำหรับเข้าใช้งานระบบ ICON Digital Gateway  รหัสนี้มีอายุการใช้งาน 5 นาที&nbsp;</span></p>\n  <p>&nbsp;</p>\n  <table border="0" cellpadding="1" cellspacing="1" style="height:50px; width:100%">\n\t  <tbody>\n\t\t  <tr>\n\t\t\t  <td style="background-color:#d6d2fb; text-align:center; width:587px"><span style="font-size:30px"><span style="font-family:Calibri,sans-serif; letter-spacing: 15px;">${e.pin_code}</span></span></td>\n\t\t  </tr>\n\t  </tbody>\n  </table>\n  <p>&nbsp;</p>\n  <p><span style="font-size:14px">Ref: ${e.ref_code}&nbsp;</span></p>\n  <p style="text-align:center">&nbsp;</p>\n  <p><span style="font-size:14px">ขอแสดงความนับถือ&nbsp;&nbsp;</span></p>\n  <p><span style="font-size:14px">ICON Digital Gateway&nbsp;</span></p>\n  <p>&nbsp;</p>\n  <p>&nbsp;</p>\n  <p style="text-align:center">&nbsp;</p>\n  <p style="text-align:center"><img title="ICON Framework" src="${e.logo}" style="height:48px; width:84px"/></p>\n  <p style="text-align:center">&nbsp;</p>\n  <p style="text-align:center"><span style="font-size:14px">บริษัท ไอคอน เฟรมเวิร์ค จำกัด&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:14px">สำนักงานใหญ่ ทรู ดิจิทัล พาร์ค สุขุมวิท 101 ตึกฟีนิกซ์ ชั้น 6 ห้องเลขที่ 602&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:14px">ถนนสุขุมวิท แขวงบางจาก เขตพระโขนง กรุงเทพมหานคร ประเทศไทย 10260&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:12pt"><span style="font-family:Calibri,sans-serif"><a href="https://iconframework.com/">iconframework.com</a></span></span></p>\n`},emailRequestPinHtml:function(e){return`\n  <p><span style="font-size:14px">เรียน ผู้ใช้งาน</span></p>\n  <p>&nbsp;</p>\n  <p><span style="font-size:14px">&nbsp;       โปรดนำ PIN ด้านล่างนี้ไประบุในหน้า PIN เพื่อใช้สำหรับตั้งรหัสผ่านใหม่  หมายเลข PIN คือ&nbsp;</span></p>\n  <p>&nbsp;</p>\n  <table border="0" cellpadding="1" cellspacing="1" style="height:50px; width:100%">\n\t  <tbody>\n\t\t  <tr>\n\t\t\t  <td style="background-color:#d6d2fb; text-align:center; width:587px"><span style="font-size:30px"><span style="font-family:Calibri,sans-serif; letter-spacing: 15px;">${e.pin_code}</span></span></td>\n\t\t  </tr>\n\t  </tbody>\n  </table>\n  <p>&nbsp;</p>\n  <p><span style="font-size:14px">หมายเหตุ: PIN มีอายุการใช้งาน 30 นาที หากเกินกำหนดเวลากรุณากดลืมรหัสผ่าน เพื่อขอ PIN อีกครั้ง&nbsp;</span></p>\n  <p style="text-align:center">&nbsp;</p>\n  <p><span style="font-size:14px">ขอแสดงความนับถือ&nbsp;&nbsp;</span></p>\n  <p><span style="font-size:14px">ICON Digital Gateway&nbsp;</span></p>\n  <p>&nbsp;</p>\n  <p>&nbsp;</p>\n  <p style="text-align:center">&nbsp;</p>\n  <p style="text-align:center"><img title="ICON Framework" src="${e.logo}" style="height:48px; width:84px"/></p>\n  <p style="text-align:center">&nbsp;</p>\n  <p style="text-align:center"><span style="font-size:14px">บริษัท ไอคอน เฟรมเวิร์ค จำกัด&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:14px">สำนักงานใหญ่ ทรู ดิจิทัล พาร์ค สุขุมวิท 101 ตึกฟีนิกซ์ ชั้น 6 ห้องเลขที่ 602&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:14px">ถนนสุขุมวิท แขวงบางจาก เขตพระโขนง กรุงเทพมหานคร ประเทศไทย 10260&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:12pt"><span style="font-family:Calibri,sans-serif"><a href="https://iconframework.com/">iconframework.com</a></span></span></p>\n`},emailInquiryHtml:function(e){return`\n  <p><span style="font-size:14px">เรียน Support</span></p>\n  <p>&nbsp;</p>\n  <p><span style="font-size:14px">&nbsp;        แจ้งเรื่องร้องเรียนรายละเอียด ดังนี้&nbsp;\n  <p><span style="font-size:14px"><span style="font-family:Calibri,sans-serif"><strong><span>หัวข้อ</span></strong>:\n  <span>${e.subject_name}</span></span></span></p>\n  <p><span style="font-size:14px"><span style="font-family:Calibri,sans-serif"><strong><span>รายละเอียด</span></strong> : \n  <span>${e.detail}</span></span></span></p>\n  <p style="text-align:center">&nbsp;</p>\n  <p><span style="font-size:14px">ขอแสดงความนับถือ&nbsp;&nbsp;</span></p>\n  <p><span style="font-size:14px">${e.customer_name}&nbsp;</span></p>\n  <p><span style="font-size:14px">${e.mobile_number}&nbsp;</span></p>\n  <p><span style="font-size:14px">${e.email}&nbsp;</span></p>\n  <p>&nbsp;</p>\n  <p>&nbsp;</p>\n  <p style="text-align:center">&nbsp;</p>\n  <p style="text-align:center"><img title="ICON Framework" src="${e.logo}" style="height:48px; width:84px"/></p>\n  <p style="text-align:center">&nbsp;</p>\n  <p style="text-align:center"><span style="font-size:14px">บริษัท ไอคอน เฟรมเวิร์ค จำกัด&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:14px">สำนักงานใหญ่ ทรู ดิจิทัล พาร์ค สุขุมวิท 101 ตึกฟีนิกซ์ ชั้น 6 ห้องเลขที่ 602&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:14px">ถนนสุขุมวิท แขวงบางจาก เขตพระโขนง กรุงเทพมหานคร ประเทศไทย 10260&nbsp;</span></p>\n  <p style="text-align:center"><span style="font-size:12pt"><span style="font-family:Calibri,sans-serif"><a href="https://iconframework.com/">iconframework.com</a></span></span></p>\n`}}},448:function(e,t,i){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.transport=void 0;const a=n(i(5184));n(i(5142)).default.config(),t.transport=a.default.createTransport({host:process.env.MAIL_HOST,port:parseInt(process.env.MAIL_PORT),ignoreTLS:!1,tls:{rejectUnauthorized:!1},secure:"0"!=process.env.MAIL_SECURE,auth:{user:process.env.EMAIL_USERNAME,pass:process.env.EMAIL_PASSWORD}})},2275:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createRequest=t.createPool=t.pool=void 0;const s=a(i(9424));t.createPool=function(e){return n(this,void 0,void 0,(function*(){t.pool=yield new s.default.ConnectionPool(Object.assign({},e)).connect()}))},t.createRequest=function(e=null){return null==e?t.pool.request():new s.default.Request(e)}},1443:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.module=void 0,t.module={messageRegisterSuccess:function(e){return{type:"flex",altText:`ยินดีต้อนรับ คุณ ${e.display_name}`,contents:{type:"bubble",size:"mega",body:{type:"box",layout:"vertical",contents:[{type:"box",layout:"horizontal",contents:[{type:"box",layout:"vertical",contents:[{type:"image",url:e.picture_url,aspectMode:"cover",size:"full"}],cornerRadius:"100px",width:"60px",height:"60px",margin:"sm"},{type:"box",layout:"vertical",contents:[{type:"text",contents:[{type:"span",text:"ยินดีต้อนรับ",color:"#000000",size:"14px"}],size:"sm",wrap:!0},{type:"separator",color:"#5A6980",margin:"md"},{type:"box",layout:"baseline",contents:[{type:"text",text:`" คุณ ${e.display_name} "`,size:"14px",color:"#000000"}],spacing:"sm",margin:"md"}],spacing:"xs",paddingAll:"sm"}],paddingAll:"20px",spacing:"xl"}],paddingAll:"0px"}}}},messageWelcome:function(e){return{type:"flex",altText:"บัญชีของท่านได้ลงทะเบียนสำเร็จแล้ว",contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:e,aspectMode:"cover",aspectRatio:"20:10",size:"full"},{type:"box",layout:"vertical",contents:[{type:"text",text:"บัญชีของท่านได้ลงทะเบียน",wrap:!0,color:"#0FFF73",size:"20px",weight:"bold"},{type:"text",text:"สำเร็จแล้ว",wrap:!0,color:"#0FFF73",size:"20px",weight:"bold"},{type:"text",text:"ท่านสามารถเริ่มใช้งานระบบ",color:"#0FFF73",size:"20px",weight:"bold",wrap:!0,offsetTop:"md"},{type:"text",text:"ขอสินเชื่อที่อยู่อาศัยได้ทันที",color:"#0FFF73",size:"20px",weight:"bold",wrap:!0,offsetTop:"md"}],position:"absolute",spacing:"xs",paddingStart:"10%",paddingAll:"10%"}],paddingAll:"0px"}}}},messagePaymentSuccess:function(e){return{type:"flex",altText:"ท่านได้ชำระเงินเรียบร้อยแล้ว",contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:e,aspectMode:"cover",aspectRatio:"20:10",size:"full"},{type:"box",layout:"vertical",contents:[{type:"text",text:"ท่านได้ชำระเงินเรียบร้อยแล้ว",wrap:!0,color:"#0FFF73",size:"20px"},{type:"text",text:'" คลิกเพื่อยืนยันตัวตน "',color:"#ffffff",size:"20px",align:"start"}],position:"absolute",spacing:"xs",offsetTop:"20%",width:"100%",paddingStart:"20%"},{type:"box",layout:"vertical",contents:[{type:"box",layout:"vertical",contents:[{type:"text",text:"N",color:"#ffffff",size:"12px",weight:"bold",align:"center",margin:"sm"}],width:"25px",height:"25px",position:"absolute",backgroundColor:"#EC3D44",cornerRadius:"xxl",offsetStart:"90%",offsetTop:"15px"}],width:"100%",position:"absolute",height:"50px"},{type:"box",layout:"vertical",contents:[{type:"button",action:{type:"uri",label:"ยืนยันตัวตน",uri:"http://linecorp.com/"},style:"link",color:"#ffffff",gravity:"center",height:"sm"}],position:"absolute",offsetStart:"20%",backgroundColor:"#27AE60",cornerRadius:"md",width:"40%",height:"40px",background:{type:"linearGradient",startColor:"#00FF2D",endColor:"#006A2A",centerColor:"#00C42C",angle:"111.3deg"},offsetBottom:"20%"}],paddingAll:"0px"}}}},messageNcbSuccess:function(e,t,i){return{type:"flex",altText:"ท่านดำเนินการยืนยันตัวตนสำเร็จแล้ว",contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:e,aspectMode:"cover",aspectRatio:"20:10",size:"full"},{type:"box",layout:"vertical",contents:[{type:"text",text:"ท่านดำเนินการยืนยันตัวตนสำเร็จแล้ว",wrap:!0,color:"#0FFF73",size:"17px"},{type:"text",text:"ระบบจะทำการส่งรายงานเครดิตบูโร",wrap:!0,color:"#0FFF73",size:"17px"},{type:"text",text:"(E-Credit Report)",wrap:!0,color:"#0FFF73",size:"17px"},{type:"text",text:"ไปยัง Email ที่ท่านได้ลงทะเบียนไว้",wrap:!0,color:"#0FFF73",size:"17px"}],position:"absolute",spacing:"xs",width:"80%",offsetStart:"10%",offsetEnd:"10%",offsetTop:"10%"},{type:"box",layout:"vertical",contents:[{type:"box",layout:"vertical",contents:[{type:"text",text:"N",color:"#ffffff",size:"12px",weight:"bold",align:"center",margin:"sm"}],width:"25px",height:"25px",position:"absolute",backgroundColor:"#EC3D44",cornerRadius:"xxl",offsetStart:"90%",offsetTop:"15px"}],width:"100%",position:"absolute",height:"50px"},{type:"box",layout:"vertical",contents:[{type:"button",action:{type:"uri",label:"รายละเอียดคำขอ",uri:`${i}?ncb_id=${t.ncb_id}`},style:"link",color:"#000000",gravity:"center",height:"sm"}],position:"absolute",offsetStart:"20%",backgroundColor:"#27AE60",cornerRadius:"md",width:"50%",height:"40px",background:{type:"linearGradient",startColor:"#D0D2D4",endColor:"#BFBEBF",centerColor:"#EEEEEE",angle:"180.69deg"},offsetBottom:"5%"}],paddingAll:"0px"}}}},messageNcbTimeout:function(e,t){return{type:"flex",altText:"ทำรายการไม่สำเร็จ",contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:e,aspectMode:"cover",aspectRatio:"20:10",size:"full"},{type:"box",layout:"vertical",contents:[{type:"text",text:"ทำรายการไม่สำเร็จ",wrap:!0,color:"#0FFF73",size:"18px"},{type:"text",text:"เนื่องจากหมดเวลาทำรายการ",wrap:!0,color:"#0FFF73",size:"18px"},{type:"text",text:`รหัส ${t.ncb_id}`,color:"#ffffff",size:"18px"}],position:"absolute",spacing:"xs",paddingStart:"20%",width:"100%",offsetTop:"15%"},{type:"box",layout:"vertical",contents:[{type:"box",layout:"vertical",contents:[{type:"text",text:"N",color:"#ffffff",size:"12px",weight:"bold",align:"center",margin:"sm"}],width:"25px",height:"25px",position:"absolute",backgroundColor:"#EC3D44",cornerRadius:"xxl",offsetStart:"90%",offsetTop:"15px"}],width:"100%",position:"absolute",height:"50px"},{type:"box",layout:"vertical",contents:[{type:"button",action:{type:"uri",label:"รายละเอียดคำขอ",uri:`https://api-dev.icondigitalgateway.com?line_id=${t.line_id}&nac_id=${t.ncb_id}`},style:"link",color:"#000000",gravity:"center",height:"sm"}],position:"absolute",offsetStart:"20%",backgroundColor:"#27AE60",cornerRadius:"md",width:"50%",height:"40px",background:{type:"linearGradient",startColor:"#D0D2D4",endColor:"#BFBEBF",centerColor:"#EEEEEE",angle:"180.69deg"},offsetBottom:"15%"}],paddingAll:"0px"}}}},messageNcbRejected:function(e,t){return{type:"flex",altText:"ทำรายการไม่สำเร็จ",contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:e,aspectMode:"cover",aspectRatio:"20:10",size:"full"},{type:"box",layout:"vertical",contents:[{type:"text",text:"ทำรายการไม่สำเร็จ",wrap:!0,color:"#0FFF73",size:"18px"},{type:"text",text:"เนื่องจากถูกปฏิเสธการทำรายการ",wrap:!0,color:"#0FFF73",size:"18px"},{type:"text",text:`รหัส ${t.ncb_id}`,color:"#ffffff",size:"18px"}],position:"absolute",spacing:"xs",paddingStart:"20%",width:"100%",offsetTop:"15%"},{type:"box",layout:"vertical",contents:[{type:"box",layout:"vertical",contents:[{type:"text",text:"N",color:"#ffffff",size:"12px",weight:"bold",align:"center",margin:"sm"}],width:"25px",height:"25px",position:"absolute",backgroundColor:"#EC3D44",cornerRadius:"xxl",offsetStart:"90%",offsetTop:"15px"}],width:"100%",position:"absolute",height:"50px"},{type:"box",layout:"vertical",contents:[{type:"button",action:{type:"uri",label:"รายละเอียดคำขอ",uri:`https://api-dev.icondigitalgateway.com?line_id=${t.line_id}&nac_id=${t.ncb_id}`},style:"link",color:"#000000",gravity:"center",height:"sm"}],position:"absolute",offsetStart:"20%",backgroundColor:"#27AE60",cornerRadius:"md",width:"50%",height:"40px",background:{type:"linearGradient",startColor:"#D0D2D4",endColor:"#BFBEBF",centerColor:"#EEEEEE",angle:"180.69deg"},offsetBottom:"15%"}],paddingAll:"0px"}}}},messageNcbError:function(e){return{type:"flex",altText:`${e.ncb_message}`,contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:`${e.image}`,aspectRatio:"1:1",aspectMode:"fit",gravity:"center",align:"center",size:"full"},{type:"box",layout:"horizontal",contents:[{type:"text",text:`ReferenceID : ${e.ncb_id}`,align:"center",weight:"bold",color:"#000000",size:"14px"}],width:"100%",position:"absolute",spacing:"none",offsetBottom:"25%"}],backgroundColor:"#424F6C",paddingAll:"0px"}}}},messageNcbTimeOutAndReject:function(e){return{type:"flex",altText:`${e.ncb_message}`,contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:`${e.image}`,aspectRatio:"1:1",aspectMode:"fit",gravity:"center",align:"center",size:"full"},{type:"box",layout:"horizontal",contents:[{type:"text",text:`ReferenceID : ${e.ncb_id}`,align:"center",weight:"bold",color:"#000000",size:"14px"}],width:"100%",position:"absolute",spacing:"none",offsetBottom:"20%"}],backgroundColor:"#424F6C",paddingAll:"0px"}}}},messageNcbErrorฺBank:function(e,t){return{type:"flex",altText:"รอยืนยันตัวตน",contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:e,aspectMode:"cover",aspectRatio:"20:10",size:"full"},{type:"box",layout:"vertical",contents:[{type:"text",text:"รอยืนยันตัวตน",wrap:!0,color:"#0FFF73",size:"18px"},{type:"text",text:"กรุณาลงทะเบียน NDID กับธนาคาร",wrap:!0,color:"#0FFF73",size:"18px"},{type:"text",text:`รหัส ${t.ncb_id}`,color:"#ffffff",size:"18px"}],position:"absolute",spacing:"xs",paddingStart:"20%",width:"100%",offsetTop:"15%"},{type:"box",layout:"vertical",contents:[{type:"box",layout:"vertical",contents:[{type:"text",text:"N",color:"#ffffff",size:"12px",weight:"bold",align:"center",margin:"sm"}],width:"25px",height:"25px",position:"absolute",backgroundColor:"#EC3D44",cornerRadius:"xxl",offsetStart:"90%",offsetTop:"15px"}],width:"100%",position:"absolute",height:"50px"},{type:"box",layout:"vertical",contents:[{type:"button",action:{type:"uri",label:"รายละเอียดคำขอ",uri:`https://api-dev.icondigitalgateway.com?line_id=${t.line_id}&nac_id=${t.ncb_id}`},style:"link",color:"#000000",gravity:"center",height:"sm"}],position:"absolute",offsetStart:"20%",backgroundColor:"#27AE60",cornerRadius:"md",width:"50%",height:"40px",background:{type:"linearGradient",startColor:"#D0D2D4",endColor:"#BFBEBF",centerColor:"#EEEEEE",angle:"180.69deg"},offsetBottom:"15%"}],paddingAll:"0px"}}}},messageNcbRequestedError:function(e,t){return{type:"flex",altText:"ขออภัยไม่สามารถดำเนินการต่อได้ กรุณาทำรายการใหม่อีกครั้ง",contents:{type:"bubble",size:"giga",body:{type:"box",layout:"vertical",contents:[{type:"image",url:e,aspectMode:"cover",aspectRatio:"20:10",size:"full"},{type:"box",layout:"vertical",contents:[{type:"text",text:"ขออภัยไม่สามารถดำเนินการต่อได้",wrap:!0,color:"#0FFF73",size:"20px",weight:"bold"},{type:"text",text:"กรุณาทำรายการใหม่อีกครั้ง",color:"#0FFF73",size:"20px",weight:"bold",wrap:!0,offsetTop:"md"},{type:"text",text:`ReferenceID: ${t.ncb_id}`,color:"#FFFFFF",size:"17px",weight:"bold",wrap:!0,offsetTop:"xxl"}],position:"absolute",spacing:"xs",paddingAll:"10%",offsetTop:"md"},{type:"box",layout:"vertical",contents:[{type:"box",layout:"vertical",contents:[{type:"text",text:"N",color:"#ffffff",size:"12px",weight:"bold",align:"center",margin:"sm"}],width:"25px",height:"25px",position:"absolute",backgroundColor:"#EC3D44",cornerRadius:"xxl",offsetStart:"90%",offsetTop:"15px"}],width:"100%",position:"absolute",height:"50px"}],paddingAll:"0px"}}}}}},2742:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.verifyIdCard=t.verifyChipCardApi=t.verifyIdCardApi=void 0;const s=a(i(7147)),r=a(i(1017)),o=a(i(6113)),d=a(i(2167)),u=i(2275),_=i(7287),c=a(i(2245)),l=s.default.readFileSync(r.default.join("src/controllers/externals","../..","keys/dopa","private_key_dopa.pem"),"utf8");function p(){var e;return n(this,void 0,void 0,(function*(){let t={};try{let e=(0,c.default)().format("YYYY-MM-DDTHH:mm:ss"),a=process.env.DOPA_CLIENT_ID+"|"+e;var i=o.default.createSign("SHA256");i.update(a);var n=i.sign(l,"base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return console.log("signature",n),t={client_code:process.env.DOPA_CLIENT_ID,key_name:process.env.DOPA_KEY_NAME,request_time:e.toString(),signature:n},yield(0,d.default)({method:"POST",url:`${process.env.DOPA_API_URL}/api/auth/token`,headers:{"Content-Type":"application/json"},data:t})}catch(i){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/api/auth/token",body:JSON.stringify(t),error_message:JSON.stringify((null===(e=null==i?void 0:i.response)||void 0===e?void 0:e.data)||i)}),(null==i?void 0:i.response)||i}}))}function m(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return n=t,yield(0,d.default)({method:"POST",url:`${process.env.DOPA_API_URL}/dopa/api/verify-id-card`,headers:{"Content-Type":"application/json","X-Auth-Token":e},data:n})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/dopa/api/verify-id-card",body:JSON.stringify(n),error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}t.verifyIdCardApi=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{let i=yield p();if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});let n=e.body;const a=yield m(i.data.token,n);t.status(a.status).send(a.data)}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/dopa/verify-id-card",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.verifyChipCardApi=(e,t,i)=>n(void 0,void 0,void 0,(function*(){var i,n,a;try{let i=yield p();if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});let n=e.body;const a=yield(0,d.default)({method:"POST",url:`${process.env.DOPA_API_URL}/dopa/api/verify-chip-card`,headers:{"Content-Type":"application/json","X-Auth-Token":i.data.token},data:n});t.status(a.status).send(a.data)}catch(s){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/dopa/api/verify-chip-card",body:JSON.stringify(e.body),error_message:JSON.stringify((null===(i=null==s?void 0:s.response)||void 0===i?void 0:i.data)||"")}),t.status((null===(n=null==s?void 0:s.response)||void 0===n?void 0:n.status)||500).send(null===(a=null==s?void 0:s.response)||void 0===a?void 0:a.data)}})),t.verifyIdCard=e=>n(void 0,void 0,void 0,(function*(){try{let t=yield p();if(201!=t.status&&200!=t.status)return{status:t.status,message:t.data.message,data:{error:t.data.errors}};const i=yield m(t.data.token,e);return 200!=i.status?{status:i.status,message:i.data.message,data:{error:i.data.errors}}:200==i.status&&"N"===i.data.status?{status:400,message:i.data.message,data:{}}:{status:200,message:"success",data:i.data}}catch(e){return{status:500,message:(null==e?void 0:e.message)||e}}}))},7059:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(i(6860)),d=s(i(5313)),u=s(i(5884)),_=s(i(2742)),c=s(i(5918)),l=i(2821),p=o.default.Router();p.post("/dopa/verify-id-card",_.verifyIdCardApi),p.post("/dopa/verify-chip-card",_.verifyChipCardApi),p.post("/ncb/idps/check-status",l.withAuthen,d.checkIdPs),p.post("/ncb/idps/close-request",l.withAuthen,d.closeRequestIdPs),p.post("/ncb/services",l.withAuthen,d.services),p.post("/ncb/as-services",l.withAuthen,d.asService),p.post("/ncb-test/token",u.getToken),p.post("/ncb-test/token/error",u.getTokenError),p.post("/ncb-test/idps",u.listIdPs),p.post("/ncb-test/idps/verify",u.verifyIdPs),p.post("/ncb-test/idps/check-status",u.checkIdPs),p.post("/ncb-test/idps/close-request",u.closeRequestIdPs),p.post("/ncb-test/services",u.services),p.post("/ncb-test/as-services",u.asService),p.post("/ncb-test/verify-request-data",u.verifyRequestData),p.post("/ncb-test/verify-request-data/detail",u.getVerifyRequestData),p.post("/matching-service/ncb/report",c.ncbReportApi),t.default=p},4680:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.interestRateAll=void 0;const s=i(7287),r=i(2275),o=a(i(2167));t.interestRateAll=()=>n(void 0,void 0,void 0,(function*(){var e,t,i,a;try{const e=yield function(){var e;return n(this,void 0,void 0,(function*(){try{let e={client_id:process.env.BANK_PORTAL_CLIENT_ID,client_secret:process.env.BANK_PORTAL_CLIENT_SECRET,grant_type:"client_credentials",scope:"loan"};return yield(0,o.default)({method:"POST",url:`${process.env.BANK_PORTAL_API_URL}/auth/lineoauth2/token`,headers:{"Content-Type":"application/json"},data:e})}catch(t){return yield s.Log_Api.insert((0,r.createRequest)(),{type:"outbound",method:"POST",origin:"bankportal: /auth/lineoauth2/token",error_message:JSON.stringify((null===(e=null==t?void 0:t.response)||void 0===e?void 0:e.data)||"")}),(null==t?void 0:t.response)||t}}))}();if(200!=e.status)return{status:e.status,message:e.data.message};const t=yield(0,o.default)({method:"GET",url:`${process.env.BANK_PORTAL_API_URL}/lineoa/interestrateall`,headers:{authorization:"Bearer "+e.data.access_token}});return 200!=t.status?{status:t.status,message:t.data.message}:{status:200,message:"success",data:t.data.data||[]}}catch(n){return yield s.Log_Api.insert((0,r.createRequest)(),{type:"outbound",method:"GET",origin:`${process.env.BANK_PORTAL_API_URL}/lineoa/interestrateall`,error_message:JSON.stringify(null===(e=null==n?void 0:n.response)||void 0===e?void 0:e.data)||n.message}),{status:(null===(t=null==n?void 0:n.response)||void 0===t?void 0:t.status)||500,message:(null===(a=null===(i=null==n?void 0:n.response)||void 0===i?void 0:i.data)||void 0===a?void 0:a.error)||n.message}}}))},9099:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.addNewLoanToRem=t.loanUnselectBank=t.loanBankSelect=t.loanBankDetail=t.loanDetail=t.loanAll=t.sendDocument=void 0;const s=i(3833),r=a(i(2167)),o=i(2275),d=i(7287),u=a(i(9424)),_=i(5107);function c(){var e;return n(this,void 0,void 0,(function*(){try{let e={client_id:process.env.BANK_PORTAL_CLIENT_ID,client_secret:process.env.BANK_PORTAL_CLIENT_SECRET,grant_type:"client_credentials",scope:"loan"};return yield(0,r.default)({method:"POST",url:`${process.env.BANK_PORTAL_API_URL}/auth/lineoauth2/token`,data:e})}catch(t){return yield d.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.BANK_PORTAL_API_URL}/auth/lineoauth2/token`,error_message:JSON.stringify((null===(e=null==t?void 0:t.response)||void 0===e?void 0:e.data)||"")}),(null==t?void 0:t.response)||t}}))}t.sendDocument=e=>n(void 0,void 0,void 0,(function*(){var t,i,n,a;try{const{developer_code:t,data:i}=e,n=yield d.Master_Developer.findOne((0,o.createRequest)(),{developer_code:t});(yield d.Master_Loan.findOne((0,o.createRequest)(),{loan_id:i.refNo})).booking_no;let a=yield(0,r.default)({method:"POST",url:`${n.url_api}/loan/UpLoadFileMortgage`,headers:JSON.parse(n.header_api),data:i});return{status:200,message:"success",data:(0,s.snakeCaseKeys)(a.data.Data)}}catch(s){return yield d.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:"/loan/UpLoadFileMortgage",body:JSON.stringify(e),error_message:JSON.stringify(null===(t=null==s?void 0:s.response)||void 0===t?void 0:t.data)||s.message}),{status:(null===(i=null==s?void 0:s.response)||void 0===i?void 0:i.status)||500,message:(null===(a=null===(n=null==s?void 0:s.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.error)||s.message}}})),t.loanAll=e=>n(void 0,void 0,void 0,(function*(){var t,i,n,a,s,u;try{const t=yield c();if(200!=t.status)return{status:t.status,message:t.data.message};const i=yield(0,r.default)({method:"POST",url:`${process.env.BANK_PORTAL_API_URL}/lineoa/loanall`,headers:{authorization:"Bearer "+t.data.access_token},data:{citizen_id:e.citizen_id}});return 200!=i.status?{status:i.status,message:i.data.message}:{status:200,message:"success",data:i.data.data}}catch(r){return yield d.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.BANK_PORTAL_API_URL}/lineoa/loanall`,body:JSON.stringify(e),error_message:JSON.stringify(null===(t=null==r?void 0:r.response)||void 0===t?void 0:t.data)||r.message}),{status:(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||500,message:(null===(a=null===(n=null==r?void 0:r.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.message)||(null===(u=null===(s=null==r?void 0:r.response)||void 0===s?void 0:s.data)||void 0===u?void 0:u.error)||r.message}}})),t.loanDetail=e=>n(void 0,void 0,void 0,(function*(){var t,i,n,a,s,u;try{const{citizen_id:t,unit_id:i,unit_no:n,booking_no:a}=e,s=yield c();if(200!=s.status)return{status:s.status,message:s.data.message};const o=yield(0,r.default)({method:"POST",url:`${process.env.BANK_PORTAL_API_URL}/lineoa/loandetail`,headers:{authorization:"Bearer "+s.data.access_token},data:{citizen_id:t,unit_id:i,unit_no:n,booking_no:a}});return 200!=o.status?{status:o.status,message:o.data.message}:{status:200,message:"success",data:o.data.data}}catch(r){return yield d.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.BANK_PORTAL_API_URL}/lineoa/loandetail`,body:JSON.stringify(e),error_message:JSON.stringify(null===(t=null==r?void 0:r.response)||void 0===t?void 0:t.data)||r.message}),{status:(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||500,message:(null===(a=null===(n=null==r?void 0:r.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.message)||(null===(u=null===(s=null==r?void 0:r.response)||void 0===s?void 0:s.data)||void 0===u?void 0:u.error)||r.message}}})),t.loanBankDetail=e=>n(void 0,void 0,void 0,(function*(){var t,i,n,a,s,u;try{const t=yield c();if(200!=t.status)return{status:t.status,message:t.data.message};const i=yield(0,r.default)({method:"POST",url:`${process.env.BANK_PORTAL_API_URL}/lineoa/loanbankdetail`,headers:{authorization:"Bearer "+t.data.access_token},data:{document_no:e.document_no}});return 200!=i.status?{status:i.status,message:i.data.message}:{status:200,message:"success",data:i.data.data}}catch(r){return yield d.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.BANK_PORTAL_API_URL}/lineoa/loanbankdetail`,body:JSON.stringify(e),error_message:JSON.stringify(null===(t=null==r?void 0:r.response)||void 0===t?void 0:t.data)||r.message}),{status:(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||500,message:(null===(a=null===(n=null==r?void 0:r.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.message)||(null===(u=null===(s=null==r?void 0:r.response)||void 0===s?void 0:s.data)||void 0===u?void 0:u.error)||r.message}}})),t.loanBankSelect=e=>n(void 0,void 0,void 0,(function*(){var t,i,n,a,s,u;try{const t=yield c();if(200!=t.status)return{status:t.status,message:t.data.message};const i=yield(0,r.default)({method:"POST",url:`${process.env.BANK_PORTAL_API_URL}/lineoa/loanbankselect`,headers:{authorization:"Bearer "+t.data.access_token},data:{document_no:e.document_no}});return 200!=i.status?{status:i.status,message:i.data.message}:{status:200,message:"success",data:i.data.data}}catch(r){return yield d.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.BANK_PORTAL_API_URL}/lineoa/loanbankselect`,body:JSON.stringify(e),error_message:JSON.stringify(null===(t=null==r?void 0:r.response)||void 0===t?void 0:t.data)||r.message}),{status:(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||500,message:(null===(a=null===(n=null==r?void 0:r.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.message)||(null===(u=null===(s=null==r?void 0:r.response)||void 0===s?void 0:s.data)||void 0===u?void 0:u.error)||r.message}}})),t.loanUnselectBank=e=>n(void 0,void 0,void 0,(function*(){var t,i,n,a,s,u;try{const t=yield c();if(200!=t.status)return{status:t.status,message:t.data.message};const i=yield(0,r.default)({method:"POST",url:`${process.env.BANK_PORTAL_API_URL}/lineoa/loanbankunselect`,headers:{authorization:"Bearer "+t.data.access_token},data:{document_no:e.document_no}});return 200!=i.status?{status:i.status,message:i.data.message}:{status:200,message:"success",data:i.data.data}}catch(r){return yield d.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.BANK_PORTAL_API_URL}/lineoa/loanbankunselect`,body:JSON.stringify(e),error_message:JSON.stringify(null===(t=null==r?void 0:r.response)||void 0===t?void 0:t.data)||r.message}),{status:(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||500,message:(null===(a=null===(n=null==r?void 0:r.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.message)||(null===(u=null===(s=null==r?void 0:r.response)||void 0===s?void 0:s.data)||void 0===u?void 0:u.error)||r.message}}})),t.addNewLoanToRem=(e,t,i)=>n(void 0,void 0,void 0,(function*(){var n,a,c,l,p,m,y,f,h;try{const p=process.env.AZURE_STORAGE_ACCOUNT_NAME||"";if(!p)throw Error("Azure Storage accountName not found");const m=process.env.AZURE_STORAGE_KEY||"",y=new _.StorageSharedKeyCredential(p,m);let f=new _.BlobServiceClient(`https://${p}.blob.core.windows.net`,y).url,h=[];const v=yield(0,o.createRequest)().input("loan_id",u.default.NVarChar,e).query("\n    SELECT DISTINCT t1.ContractId, t1.LoanId, t2.CustomerId, t3.CitizenId, t2.TypeOfBorrower, \n    ISNULL(t4.Income, 0) as Incomes, ISNULL(t4.Ot, 0) as Ot, ISNULL(t4.Commission, 0) as Commission, \n    ISNULL(t4.Bonus, 0) as Bonus, ISNULL(t4.ServiceCharge, 0) as ServiceCharge, ISNULL(t4.Perdiem, 0) as Perdiem, \n    ISNULL(t4.IncomeOtherFix, 0) as IncomeOtherFix, ISNULL(t4.IncomeOtherNotFix, 0) as IncomeOtherNotFix, \n    ISNULL(t4.IncomeExtra, 0) as IncomeExtra, ISNULL(t4.IncomeRental, 0) as IncomeRental, ISNULL(t4.TotalIncome, 0) as TotalIncome,\n    ISNULL(t4.PaySocialInsurance, 0) as PaySocialInsurance, ISNULL(t4.PaySlipTax, 0) as PaySlipTax, ISNULL(t4.PaySlipCooperative, 0) as PaySlipCooperative,\n    ISNULL(t4.PaySlipOther, 0) as PaySlipOther, ISNULL(t4.PayProvidentfund, 0) as PayProvidentfund, ISNULL(t4.PayHomeLoan, 0) as PayHomeLoan,\n    ISNULL(t4.PayCarLoan, 0) as PayCarLoan, ISNULL(t4.DebtTotalCreditCard, 0) as DebtTotalCreditCard, ISNULL(t4.DebtCreditCardPerMonth, 0) as DebtCreditCardPerMonth,\n    ISNULL(t4.DebtOther, 0) as DebtOther, ISNULL(t4.TotalDebt, 0) as TotalDebt, t4.DebtCashCard,\n    ISNULL(t4.CompanyBusinessTypeId, '') as CompanyBusinessType, ISNULL(t4.CompanyBusinessTypeName, '') as CompanyBusinessTypeName,\n    ISNULL(t4.WelfareId, '') as Welfare, ISNULL(t4.WelfareName, '') as WelfareName, ISNULL(t4.NumberOfDebtHouse, 0) as NumberOfDebtHouse, ISNULL(t4.WelfareBankType, '[]') as WelfareBankType,\n    ISNULL(t4.NumberOfHouse, '') as HouseNo\n    FROM Master_Loan t1\n    INNER JOIN Mapping_Loan t2 ON t1.LoanId = t2.LoanId\n    INNER JOIN Master_Customer t3 ON t2.CustomerId = t3.CustomerId\n    LEFT JOIN Master_Customer_Loan t4 ON t2.CustomerId = t4.CustomerId AND t1.LoanId = t4.LoanId\n    WHERE t1.LoanId =  @loan_id\n    ");let g=(0,s.snakeCaseKeys)(v.recordset),O=g[0].contract_id;for(var b in g){let t,i=JSON.parse(null===(n=g[b])||void 0===n?void 0:n.welfare_bank_type)||[];t=(yield(0,o.createRequest)().input("welfare_bank",u.default.NVarChar,i.join(",")).query("DECLARE @TempTable TABLE (Bank NVARCHAR(50))\n        INSERT INTO @TempTable (Bank) SELECT value FROM STRING_SPLIT(@welfare_bank, ',')\n        SELECT BankCode as bankId, Name as bankName\n        FROM Master_Bank\n          WHERE BankCode IN( SELECT Bank FROM @TempTable)")).recordset||[];let s=yield(0,o.createRequest)().input("loan_id",u.default.NVarChar,e).input("customer_id",u.default.NVarChar,null===(a=g[b])||void 0===a?void 0:a.customer_id).input("blob_url",u.default.NVarChar,f).query("\n        DECLARE @Url AS VARCHAR(50) = @blob_url\n      SELECT FileName as fileName, FileType as fileType,\n      (CASE WHEN FileExtension = 'jpeg' THEN '1'\n           WHEN FileExtension = 'jpg' THEN '1'\n         WHEN FileExtension = 'png' THEN '2'\n           WHEN FileExtension = 'pdf' THEN '3'\n         ELSE '' END) AS 'FileType' , \n      FileExtension as 'fileTypeName', \n      GroupType as 'docType',\n      (CASE WHEN GroupType = '2' THEN 'เอกสารส่วนตัว'\n           WHEN GroupType = '3' THEN 'NCB'\n         WHEN GroupType = '4' THEN 'เอกสารรายได้'\n           WHEN GroupType = '5' THEN 'Statement'\n         END) AS 'docTypeName',\n         CONCAT( @Url , FilePath) as fileUrl\n      FROM Master_File \n      WHERE  CustomerId = @customer_id AND RefId = @loan_id AND (GroupType IN('2','3','4','5')) AND Status = 'active'\n      "),d=yield(0,r.default)({method:"POST",url:`${process.env.SERVICE_MATCHING_API_URL}/ncb/password`,data:{loan_id:e,user_id:g[b].citizen_id}}),_={citizenId:g[b].citizen_id,income:{incomes:g[b].incomes||0,ot:g[b].ot||0,commission:g[b].commission||0,bonus:g[b].bonus||0,serviceCharge:g[b].service_charge||0,perdiem:g[b].perdiem||0,incomeOtherFix:g[b].income_other_fix||0,incomeOtherNotFix:g[b].income_other_not_fix||0,incomeExtra:g[b].income_extra||0,incomeRental:g[b].income_rental||0,salesAmount:0,netIncome:0,shareholder:0,totalIncome:g[b].total_income||0},pay:{paySocialInsurance:g[b].pay_social_insurance||0,paySlipTax:g[b].pay_slip_tax||0,paySlipCooperative:g[b].pay_slip_cooperative||0,paySlipOther:g[b].pay_slip_other||0,payProvidentfund:g[b].pay_providentfund||0,payHomeLoan:g[b].pay_homeLoan||0,payCarLoan:g[b].pay_carLoan||0,personalLoan:0,debtTotalCreditCard:g[b].debt_total_credit_card||0,debtCreditCardPerMonth:g[b].debt_credit_card_per_month||0,debtOther:g[b].debt_other||0,totalDebt:g[b].total_debt||0},companyBusinessType:g[b].company_business_type||"",companyBusinessTypeName:g[b].company_business_type_name||"",welfare:"1"===g[b].welfare?"yes":"no",welfareName:g[b].welfare_name||"",numberOfDebtHouse:g[b].number_of_debt_house||0,welfareBankType:t||[],houseNo:g[b].house_no||"",files:(null==s?void 0:s.recordset)||[],filePassword:(null===(c=null==d?void 0:d.data)||void 0===c?void 0:c.password)||"",gradeBureau:(null===(l=null==d?void 0:d.data)||void 0===l?void 0:l.grade_bureau)||""};h.push(_)}const w=yield(0,o.createRequest)().input("select_bank",u.default.NVarChar,t.join(",")).query("DECLARE @TempTable TABLE (Bank NVARCHAR(50))\n        INSERT INTO @TempTable (Bank) SELECT value FROM STRING_SPLIT(@select_bank, ',')\n        SELECT BankCode as bankId, Name as bankName\n        FROM Master_Bank\n          WHERE BankCode IN( SELECT Bank FROM @TempTable)"),N=yield d.Master_Developer.findOne((0,o.createRequest)(),{developer_code:i});if(!N)return{status:400,message:"ไม่พบข้อมูลบริษัท"};let C=JSON.parse(N.header_api),S=N.url_api;const D=yield(0,r.default)({method:"POST",url:`${S}/loan/addNewLoan`,headers:C,data:{contractId:O,loanCustomer:h,bank:w.recordset||[]}});return 200!=D.data.statusCode?{status:D.data.statusCode,message:D.data.statusDesc}:{status:200,message:"success",data:(0,s.snakeCaseKeys)(D.data.data)}}catch(t){return yield d.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:"/loan/addNewLoan",body:JSON.stringify({loan_id:e}),error_message:(null===(m=null===(p=null==t?void 0:t.response)||void 0===p?void 0:p.data)||void 0===m?void 0:m.message)||t.message}),{status:(null===(y=null==t?void 0:t.response)||void 0===y?void 0:y.status)||500,message:(null===(h=null===(f=null==t?void 0:t.response)||void 0===f?void 0:f.data)||void 0===h?void 0:h.message)||t.message}}}))},5918:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.bankMatching=t.ncbReport=t.ncbReportApi=void 0;const s=a(i(2167)),r=i(2275),o=i(7287),d=a(i(6113)),u=i(3833),_=a(i(6517));function c(e){var t,i,a,u;return n(this,void 0,void 0,(function*(){try{const t="aes-256-cbc",i=process.env.SERVICE_MATCHING_PLUBIC_KEY,n=process.env.SERVICE_MATCHING_SECRET_KEY,a=d.default.createCipheriv(t,n,i);let r=a.update(e.password,"utf-8","hex");return r+=a.final("hex"),yield(0,s.default)({method:"POST",url:`${process.env.SERVICE_MATCHING_API_URL}/ncb/report`,data:{files:[Object.assign({},e.file)],password:r,plubic_key:i,loan_id:e.loan_id,user_id:e.citizen_id,developer_code:e.developer_code}})}catch(n){return yield o.Log_Api.insert((0,r.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.SERVICE_MATCHING_API_URL}/ncb/report`,body:JSON.stringify(e),error_message:JSON.stringify((null===(i=null===(t=null==n?void 0:n.response)||void 0===t?void 0:t.data)||void 0===i?void 0:i.message)||(null==n?void 0:n.message))}),{status:(null==n?void 0:n.status)||500,message:(null===(u=null===(a=null==n?void 0:n.response)||void 0===a?void 0:a.data)||void 0===u?void 0:u.message)||(null==n?void 0:n.message)||"ขออภัย เกิดข้อผิดพลาดกรุณาลองใหม่อีกครั้ง"}}}))}t.ncbReportApi=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const i=yield c(e.body);if(console.log("check_ncb_report:",i),200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message});t.status(200).send({status:200,message:"success",data:i.data})}catch(i){yield o.Log_Api.insert((0,r.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/matching-service/ncb/repot",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.ncbReport=e=>n(void 0,void 0,void 0,(function*(){try{const t=yield o.Master_Customer.findOne((0,r.createRequest)(),{customer_id:e.customer_id});if(!t||""===t.citizen_id)return{status:400,message:"ไม่พบข้อมูลลูกค้า"};e.citizen_id=t.citizen_id;const i=yield c(e);return 200!=i.status?(console.log("Check Ncb Report ===>",i),{status:i.status,message:null==i?void 0:i.message}):{status:200,message:(null==i?void 0:i.message)||"success",data:i.data}}catch(e){return console.log("Error: Check Ncb Report ===>",e),{status:500,message:(null==e?void 0:e.message)||e}}})),t.bankMatching=e=>n(void 0,void 0,void 0,(function*(){try{const t=yield function(e){return n(this,void 0,void 0,(function*(){try{const t=yield o.Master_Developer.findOne((0,r.createRequest)(),{developer_code:e});if(!t)return{status:400,message:"ไม่พบข้อมูลบริษัท"};let i=JSON.parse(t.header_api),n=t.url_api;const a=yield(0,s.default)({method:"POST",url:`${n}/loan/loadListBankOpen`,headers:i});return 200!=a.data.statusCode?{status:a.data.statusCode,message:a.data.statusDesc}:{status:200,message:"success",data:(0,u.snakeCaseKeys)(a.data.data)}}catch(t){return yield o.Log_Api.insert((0,r.createRequest)(),{type:"outbound",method:"POST",origin:"/loan/loadListBankOpen",body:JSON.stringify(e),error_message:JSON.stringify(null==t?void 0:t.message)}),{status:(null==t?void 0:t.status)||500,message:t.message}}}))}(e.developer_code);if(200!=t.status)return{status:t.status,message:t.message};let i=_.default.map(t.data.bank,(e=>{let{bank_id:t}=e;return t}));e.bank=i||[];const a=yield(0,s.default)({method:"POST",url:`${process.env.SERVICE_MATCHING_API_URL}/bank-matching`,data:e});return 200!=a.status?{status:a.status,message:a.data.message}:{status:200,message:"success",data:a.data}}catch(t){return yield o.Log_Api.insert((0,r.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.SERVICE_MATCHING_API_URL}/bank-matching`,body:JSON.stringify(e),error_message:JSON.stringify(null==t?void 0:t.message)}),{status:500,message:"ขออภัย เกิดข้อผิดพลาดกรุณาลองใหม่อีกครั้ง"}}}))},5884:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getVerifyRequestData=t.verifyRequestData=t.asService=t.services=t.closeRequestIdPs=t.checkIdPs=t.verifyIdPs=t.listIdPs=t.getTokenError=t.getToken=void 0;const s=a(i(7147)),r=a(i(1017)),o=a(i(6113)),d=a(i(2167)),u=i(2275),_=i(7287),c=a(i(2245)),l=s.default.readFileSync(r.default.join("src/controllers/externals","../..","keys","private_key.pem"),"utf8");function p(){var e;return n(this,void 0,void 0,(function*(){let t={};try{let e=(0,c.default)().format("YYYY-MM-DDTHH:mm:ss"),a=process.env.NDID_CLIENT_CODE+"|"+e;var i=o.default.createSign("SHA256");i.update(a);var n=i.sign(l,"base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return t={client_code:process.env.NDID_CLIENT_CODE,key_name:process.env.NDID_KEY_NAME,request_time:e.toString(),signature:n},yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/api/auth/token`,headers:{"Content-Type":"application/json"},data:t})}catch(i){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/api/auth/token",body:JSON.stringify(t),error_message:JSON.stringify((null===(e=null==i?void 0:i.response)||void 0===e?void 0:e.data)||i)}),(null==i?void 0:i.response)||i}}))}t.getToken=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{let e=yield p();if(201!=e.status&&200!=e.status)return t.status(e.status).send({status:e.status,message:e.data.message,data:{error:e.data.errors}});t.status(e.status).send(e.data)}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb-test/token",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.getTokenError=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{let i=yield function(e){var t;return n(this,void 0,void 0,(function*(){try{return yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/api/auth/token`,headers:{"Content-Type":"application/json"},data:e})}catch(i){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/api/auth/token",body:JSON.stringify(e),error_message:JSON.stringify((null===(t=null==i?void 0:i.response)||void 0===t?void 0:t.data)||i)}),(null==i?void 0:i.response)||i}}))}(e.body);if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});t.status(i.status).send(i.data)}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb-test/token/error",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.listIdPs=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{let i=yield p();if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});const a=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return n=t,yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/providers`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:n})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:"/ndidproxy/api/identity/providers",body:JSON.stringify(n),error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(i.data.token,e.body);if(200!=a.status)return t.status(i.status).send({status:a.status,message:a.data.message,data:{error:a.data.errors}});t.status(200).send({status:200,message:"success",data:a.data})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb-test/idps",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.verifyIdPs=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const i=yield p();if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});let a=e.body;const s=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return n=t,yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:n})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/ndidproxy/api/identity/verify",body:JSON.stringify(n),error_message:JSON.stringify((null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)||"")}),(null==e?void 0:e.response)||e}}))}(i.data.token,a);if(200!==s.status&&202!==s.status)return t.status(s.status).send({status:s.status,message:s.data.message,data:{error:s.data.errors}});t.status((null==s?void 0:s.status)||200).send({status:(null==s?void 0:s.status)||200,message:"success",data:s.data})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/idps-test/verify",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.checkIdPs=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const{reference_id:i}=e.body,a=yield p();if(201!=a.status&&200!=a.status)return t.status(a.status).send({status:a.status,message:a.data.message,data:{error:a.data.errors}});const s=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){try{return yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify/${t}`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e}})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/identity/verify/${t}`,error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(a.data.token,i);if(200!==s.status&&202!==s.status)return t.status(a.status).send({status:s.status,message:s.data.message,data:{error:s.data.errors}});t.status((null==s?void 0:s.status)||200).send({status:(null==s?void 0:s.status)||200,message:"success",data:s.data})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/idps/check-status",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.closeRequestIdPs=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const{reference_id:i,callback_url:a}=e.body,s=yield p();if(201!=s.status&&200!=s.status)return t.status(s.status).send({status:s.status,message:s.data.message,data:{error:s.data.errors}});const r=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return n={callback_url:process.env.NDID_API_CALLBACk},yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify/${t}/close`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:n})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/identity/verify/${t}/close`,body:JSON.stringify(n),error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(s.data.token,i);if(200!==r.status&&201!==r.status&&202!==r.status)return t.status(s.status).send({status:r.status,message:r.data.message,data:{error:r.data.errors}});t.status((null==r?void 0:r.status)||200).send({status:(null==r?void 0:r.status)||200,message:"success",data:(null==r?void 0:r.data)||{}})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/idps/close-request",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.services=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const e=yield p();if(201!=e.status&&200!=e.status)return t.status(e.status).send({status:e.status,message:e.data.message,data:{error:e.data.errors}});const i=yield function(e){var t;return n(this,void 0,void 0,(function*(){let i={};try{return yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/services`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e}})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:"/ndidproxy/api/services",body:JSON.stringify(i),error_message:JSON.stringify(null===(t=null==e?void 0:e.response)||void 0===t?void 0:t.data)}),(null==e?void 0:e.response)||e}}))}(e.data.token);if(200!==i.status&&201!==i.status&&202!==i.status)return t.status(e.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});t.status((null==i?void 0:i.status)||200).send({status:(null==i?void 0:i.status)||200,message:"success",data:(null==i?void 0:i.data)||{}})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/services",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.asService=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const i=yield p();if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});const a=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/as/${t}`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e}})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/as/${t}`,body:JSON.stringify(n),error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(i.data.token,e.body.service_id);if(200!==a.status&&201!==a.status&&202!==a.status)return t.status(i.status).send({status:a.status,message:a.data.message,data:{error:a.data.errors}});t.status((null==a?void 0:a.status)||200).send({status:(null==a?void 0:a.status)||200,message:"success",data:(null==a?void 0:a.data)||{}})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/as-services",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.verifyRequestData=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const i=yield p();if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});let a=e.body;const s=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){try{const i=yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify-and-request-data`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:t});return yield _.Log_Ncb.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/ndidproxy/api/identity/verify-and-request-data",header:JSON.stringify({"Content-Type":"application/json","X-Auth-Token":e}),body:JSON.stringify(t),response:JSON.stringify(i.data)}),i}catch(n){return yield _.Log_Ncb.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/ndidproxy/api/identity/verify-and-request-data",header:JSON.stringify({"Content-Type":"application/json","X-Auth-Token":e}),body:JSON.stringify(t),error_message:JSON.stringify(null===(i=null==n?void 0:n.response)||void 0===i?void 0:i.data)}),(null==n?void 0:n.response)||n}}))}(i.data.token,a);if(200!==s.status&&201!==s.status&&202!==s.status)return t.status(i.status).send({status:s.status,message:s.data.message,data:{error:s.data.errors}});t.status((null==s?void 0:s.status)||200).send({status:(null==s?void 0:s.status)||200,message:"success",data:(null==s?void 0:s.data)||{}})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/verify-request-data",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.getVerifyRequestData=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const i=yield p();if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});const a=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){try{return yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify-and-request-data/data/${t}`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e}})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/identity/verify-and-request-data/data/${t}`,body:t,error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(i.data.token,e.body.reference_id);if(200!==a.status&&201!==a.status&&202!==a.status)return t.status(i.status).send({status:a.status,message:a.data.message,data:{error:a.data.errors}});t.status((null==a?void 0:a.status)||200).send({status:(null==a?void 0:a.status)||200,message:"success",data:(null==a?void 0:a.data)||{}})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/verify-request-data/detail",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}}))},5313:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getVerifyRequestData=t.verifyRequestData=t.asService=t.services=t.closeRequestIdPs=t.checkIdPs=t.verifyIdPs=t.listIdPs=void 0;const s=a(i(7147)),r=a(i(1017)),o=a(i(6113)),d=a(i(2167)),u=i(2275),_=i(7287),c=a(i(2245)),l=s.default.readFileSync(r.default.join("src/controllers/externals","../..","keys","private_key.pem"),"utf8");function p(){var e;return n(this,void 0,void 0,(function*(){let t={};try{let e=(0,c.default)().format("YYYY-MM-DDTHH:mm:ss"),a=process.env.NDID_CLIENT_CODE+"|"+e;var i=o.default.createSign("SHA256");i.update(a);var n=i.sign(l,"base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return t={client_code:process.env.NDID_CLIENT_CODE,key_name:process.env.NDID_KEY_NAME,request_time:e.toString(),signature:n},yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/api/auth/token`,headers:{"Content-Type":"application/json"},data:t})}catch(i){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/api/auth/token",body:JSON.stringify(t),error_message:JSON.stringify((null===(e=null==i?void 0:i.response)||void 0===e?void 0:e.data)||i)}),(null==i?void 0:i.response)||i}}))}t.listIdPs=e=>n(void 0,void 0,void 0,(function*(){var t,i;try{let a=yield p();if(201!=a.status&&200!=a.status)return{status:a.status,message:a.data.message,data:{error:a.data.errors}};const s=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return n={namespace:"citizen_id",identifier:t,min_ial:2.3,min_aal:2.2},yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/providers`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:n})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:"/ndidproxy/api/identity/providers",body:JSON.stringify(n),error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(a.data.token,e);if(200!=s.status)return{status:s.status,message:s.data.message,data:{error:s.data.errors}};const r=yield function(e){var t;return n(this,void 0,void 0,(function*(){let i={};try{return i={min_ial:2.3,min_aal:2.2,on_the_fly_support:!0},yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/providers`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:i})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:"/ndidproxy/api/identity/providers",body:JSON.stringify(i),error_message:JSON.stringify(null===(t=null==e?void 0:e.response)||void 0===t?void 0:t.data)}),(null==e?void 0:e.response)||e}}))}(a.data.token);return 200!=r.status?{status:r.status,message:r.data.message,data:{error:r.data.errors}}:{status:200,message:"success",data:{id_providers:(null===(t=null==s?void 0:s.data)||void 0===t?void 0:t.id_providers)||[],id_on_the_fly:(null===(i=null==r?void 0:r.data)||void 0===i?void 0:i.id_providers)||[]}}}catch(e){return{status:500,message:(null==e?void 0:e.message)||e}}})),t.verifyIdPs=e=>n(void 0,void 0,void 0,(function*(){try{const{citizen_id:t,bank_code:i,bank_mode:a}=e,s=yield p();if(201!=s.status&&200!=s.status)return{status:s.status,message:s.data.message,data:{error:s.data.errors}};let r={namespace:"citizen_id",identifier:t,request_message:"Consent to open an account of a broker",idp_id_list:[i],min_ial:2.3,min_aal:2.2,min_idp:1,callback_url:process.env.NDID_API_CALLBACK,mode:a,bypass_identity_check:!0,request_timeout:3600};const o=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return n=t,yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:n})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/ndidproxy/api/identity/verify",body:JSON.stringify(n),error_message:JSON.stringify((null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)||"")}),(null==e?void 0:e.response)||e}}))}(s.data.token,r);return 200!==o.status&&202!==o.status?{status:o.status,message:o.data.message,data:{error:o.data.errors}}:{status:(null==o?void 0:o.status)||200,message:"success",data:o.data}}catch(e){return{status:500,message:(null==e?void 0:e.message)||e}}})),t.checkIdPs=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const{reference_id:i}=e.body,a=yield p();if(201!=a.status&&200!=a.status)return t.status(a.status).send({status:a.status,message:a.data.message,data:{error:a.data.errors}});const s=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){try{return yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify/${t}`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e}})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/identity/verify/${t}`,error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(a.data.token,i);if(200!==s.status&&202!==s.status)return t.status(a.status).send({status:s.status,message:s.data.message,data:{error:s.data.errors}});t.status((null==s?void 0:s.status)||200).send({status:(null==s?void 0:s.status)||200,message:"success",data:s.data})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/idps/check-status",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.closeRequestIdPs=e=>n(void 0,void 0,void 0,(function*(){try{const t=yield p();if(201!=t.status&&200!=t.status)return{status:t.status,message:t.data.message,data:{error:t.data.errors}};const i=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return n={callback_url:process.env.NDID_API_CALLBACk},yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify/${t}/close`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:n})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/identity/verify/${t}/close`,body:JSON.stringify(n),error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(t.data.token,e);return 200!==i.status&&201!==i.status&&202!==i.status?{status:i.status,message:i.data.message,data:{error:i.data.errors}}:{status:(null==i?void 0:i.status)||200,message:"success",data:(null==i?void 0:i.data)||{}}}catch(t){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/idps/close-request",body:JSON.stringify({reference_id:e}),error_message:JSON.stringify((null==t?void 0:t.message)||"")}),{status:500,message:(null==t?void 0:t.message)||t}}})),t.services=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const e=yield p();if(201!=e.status&&200!=e.status)return t.status(e.status).send({status:e.status,message:e.data.message,data:{error:e.data.errors}});const i=yield function(e){var t;return n(this,void 0,void 0,(function*(){let i={};try{return yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/services`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e}})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:"/ndidproxy/api/services",body:JSON.stringify(i),error_message:JSON.stringify(null===(t=null==e?void 0:e.response)||void 0===t?void 0:t.data)}),(null==e?void 0:e.response)||e}}))}(e.data.token);if(200!==i.status&&201!==i.status&&202!==i.status)return t.status(e.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});t.status((null==i?void 0:i.status)||200).send({status:(null==i?void 0:i.status)||200,message:"success",data:(null==i?void 0:i.data)||{}})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/services",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.asService=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const i=yield p();if(201!=i.status&&200!=i.status)return t.status(i.status).send({status:i.status,message:i.data.message,data:{error:i.data.errors}});const a=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){let n={};try{return yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/as/${t}`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e}})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/as/${t}`,body:JSON.stringify(n),error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(i.data.token,e.body.service_id);if(200!==a.status&&201!==a.status&&202!==a.status)return t.status(i.status).send({status:a.status,message:a.data.message,data:{error:a.data.errors}});t.status((null==a?void 0:a.status)||200).send({status:(null==a?void 0:a.status)||200,message:"success",data:(null==a?void 0:a.data)||{}})}catch(i){yield _.Log_Api.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/ncb/as-services",body:JSON.stringify(e.body),error_message:JSON.stringify((null==i?void 0:i.message)||"")}),t.status(500).send({status:500,message:(null==i?void 0:i.message)||i})}})),t.verifyRequestData=e=>n(void 0,void 0,void 0,(function*(){try{const{citizen_id:t,service_id:i,as_id_list:a,bank_code:s,bank_mode:r,ndid_reference:o}=e;let c=JSON.stringify(e.request_params);const l=yield p();if(201!=l.status&&200!=l.status)return{status:l.status,message:l.data.message,data:{error:l.data.errors}};let m={namespace:"citizen_id",identifier:t,request_message:process.env.NDID_REQUEST_MESSAGE+o,idp_id_list:[s],min_ial:2.3,min_aal:2.2,min_idp:1,callback_url:process.env.NDID_API_CALLBACK,mode:r,bypass_identity_check:!0,request_timeout:3600,data_request_list:[{service_id:i,as_id_list:a,min_as:1,request_params:c}]};const y=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){try{const i=yield(0,d.default)({method:"POST",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify-and-request-data`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e},data:t});return yield _.Log_Ncb.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/ndidproxy/api/identity/verify-and-request-data",header:JSON.stringify({"Content-Type":"application/json","X-Auth-Token":e}),body:JSON.stringify(t),response:JSON.stringify(i.data)}),i}catch(n){return yield _.Log_Ncb.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/ndidproxy/api/identity/verify-and-request-data",header:JSON.stringify({"Content-Type":"application/json","X-Auth-Token":e}),body:JSON.stringify(t),error_message:JSON.stringify(null===(i=null==n?void 0:n.response)||void 0===i?void 0:i.data)}),(null==n?void 0:n.response)||n}}))}(l.data.token,m);return 200!==y.status&&201!==y.status&&202!==y.status?{status:y.status,message:y.data.message,data:{error:y.data.errors}}:{status:(null==y?void 0:y.status)||200,message:"success",data:(null==y?void 0:y.data)||{}}}catch(e){return{status:500,message:(null==e?void 0:e.message)||e}}})),t.getVerifyRequestData=e=>n(void 0,void 0,void 0,(function*(){var t,i,a,s,r;try{const o=yield p();if(201!=o.status&&200!=o.status)return{status:o.status,message:o.data.message,data:{error:o.data.errors}};const c=yield function(e,t){var i;return n(this,void 0,void 0,(function*(){try{return yield(0,d.default)({method:"GET",url:`${process.env.NDID_API_URL}/ndidproxy/api/identity/verify-and-request-data/data/${t}`,headers:{"Content-Type":"application/json","X-Auth-Token":e},params:{token:e}})}catch(e){return yield _.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/identity/verify-and-request-data/data/${t}`,body:t,error_message:JSON.stringify(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)}),(null==e?void 0:e.response)||e}}))}(o.data.token,e);return 200!==c.status&&201!==c.status&&202!==c.status?{status:c.status,message:null===(t=null==c?void 0:c.data)||void 0===t?void 0:t.message,data:{error:null===(i=null==c?void 0:c.data)||void 0===i?void 0:i.errors}}:{status:(null==c?void 0:c.status)||200,message:"success",data:(null===(s=null===(a=null==c?void 0:c.data)||void 0===a?void 0:a.data_items[0])||void 0===s?void 0:s.data)||(null===(r=null==c?void 0:c.data)||void 0===r?void 0:r.data_items)||{}}}catch(e){return{status:500,message:(null==e?void 0:e.message)||e}}}))},7672:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.quotationFromRem=void 0;const s=i(2275),r=a(i(2167)),o=i(3833),d=a(i(6517)),u=i(7287);t.quotationFromRem=e=>n(void 0,void 0,void 0,(function*(){try{const{customer_id:t,data:i}=e,n=yield u.Master_Customer.findOne((0,s.createRequest)(),{customer_id:t});if(!n)return{status:400,message:"ไม่พบข้อมูลของท่าน กรุณาลงทะเบียนเข้าใช้งาน"};const a=i.split("|");a[0];let _=a[1],c=a[2];const l=yield u.Master_Developer.findOne((0,s.createRequest)(),{developer_code:_});if(!l)return{status:400,message:"ไม่พบข้อมูลบริษัท"};let p=JSON.parse(l.header_api),m=l.url_api;const y=yield(0,r.default)({method:"POST",url:`${m}/loan/loadLoanContract`,headers:p,data:{contractId:c}});let f="";if(y.data){if(200!=y.data.statusCode)return{status:y.data.statusCode,message:y.data.statusDesc};let e=(0,o.snakeCaseKeys)(y.data.data),i=d.default.find(e.loan_customer,(function(e){if(e.citizen_id===n.citizen_id)return!0}));if(!i)return{status:400,message:"ไม่พบข้อมูลของท่านในใบจอง กรุณาติดต่อฝ่ายขายของโครงการ เพื่อทำการตรวจสอบข้อมูล"};let a=i;if(f=a.type_of_borrower,yield u.Master_Customer.update((0,s.createRequest)(),{customer_id_rem:null==a?void 0:a.customer_id,prefix_id:null==a?void 0:a.title_th_id,middle_name:null==a?void 0:a.middlename_th,prefix_id_eng:(null==a?void 0:a.title_en_id)||0,first_name_eng:null==a?void 0:a.firstname_en,last_name_eng:null==a?void 0:a.lastname_en,middle_name_eng:null==a?void 0:a.middlename_en,date_of_birth:null==a?void 0:a.date_of_birth,nick_name:(null==a?void 0:a.nick_name)||"",gender_code:""!=(null==a?void 0:a.gender_code)?null==a?void 0:a.gender_code:"หญิง"===(null==a?void 0:a.gender_name)?"F":"ชาย"===(null==a?void 0:a.gender_name)?"M":"",married_status_id:null==a?void 0:a.marriage_status_id,age:String(null==a?void 0:a.age),customer_type:null==a?void 0:a.customer_type,nationality_id:null==a?void 0:a.nationality_id,race_id:null==a?void 0:a.race_id,ref_code:null==a?void 0:a.ref_code,authority:(null==a?void 0:a.authority)||"",citizen_date_of_issue:(null==a?void 0:a.doc_reference_effective_date)||"",citizen_date_of_expiry:(null==a?void 0:a.doc_reference_expiry_date)||"",passport_no:(null==a?void 0:a.passport_no)||"",passport_country:(null==a?void 0:a.passport_country)||"",phone_number:(null==a?void 0:a.phone_no)||"",inter_number:(null==a?void 0:a.inter_no)||"",facebook:(null==a?void 0:a.facebook)||"",customer_line_id:(null==a?void 0:a.line_id)||"",we_chat:(null==a?void 0:a.we_chat)||"",whats_app:(null==a?void 0:a.whats_app)||"",occupation_id:null==a?void 0:a.occupation_id,company_name:(null==a?void 0:a.company_name)||"",position:(null==a?void 0:a.position)||"",work_number:(null==a?void 0:a.company_phone)||(null==a?void 0:a.company_mobile)||"",education_id:null==a?void 0:a.education_id,first_job_start_date:null==a?void 0:a.first_job_start_date,current_job_start_date:null==a?void 0:a.current_job_start_date,update_date:new Date},{customer_id:t,citizen_id:a.citizen_id}),!(yield u.Master_Customer_Address.findOne((0,s.createRequest)(),{customer_id:t,address_type_name:"ที่อยู่ในการจัดส่งเอกสาร"}))){let e=d.default.find(a.address,(function(e){if("ที่อยู่ในการจัดส่งเอกสาร"===e.address_type_name)return!0}));if(e){const i=yield u.Master_SubDistrict.findOne((0,s.createRequest)(),{name_th:null==e?void 0:e.sub_district_name,post_code:(null==e?void 0:e.zipcode)||(null==e?void 0:e.zip_code)});yield u.Master_Customer_Address.insert((0,s.createRequest)(),{address:(null==e?void 0:e.address)||"",village:(null==e?void 0:e.village)||"",moo:(null==e?void 0:e.moo)||"",soi:(null==e?void 0:e.soi)||"",floor:(null==e?void 0:e.floor)||"",road:(null==e?void 0:e.road)||"",sub_district_id:(null==i?void 0:i.sub_district_id)||(null==e?void 0:e.sub_district)||"",sub_district_name:(null==e?void 0:e.sub_district_name)||"",district_id:(null==i?void 0:i.district_id)||(null==e?void 0:e.district)||"",district_name:(null==e?void 0:e.district_name)||"",province_id:(null==i?void 0:i.province_id)||(null==e?void 0:e.province)||"",province_name:(null==e?void 0:e.province_name)||"",post_code:(null==e?void 0:e.zipcode)||(null==e?void 0:e.zip_code)||"",customer_id:t,address_type:(null==e?void 0:e.address_type)||"",address_type_name:(null==e?void 0:e.address_type_name)||""})}}(yield u.Master_Project.findOne((0,s.createRequest)(),{project_code:e.project_code,developer_code:e.developer}))||(yield u.Master_Project.insert((0,s.createRequest)(),{project_code:e.project_code,project_name:e.project_name,project_type:e.project_type,project_type_name:e.project_type_name,developer_code:e.developer,developer_name:e.developer_name})),yield u.Master_Developer.update((0,s.createRequest)(),{developer_name:null==e?void 0:e.developer_name,developer_image_url:(null==e?void 0:e.developer_image_url)||process.env.URL+"/images/noimage.jpg",update_date:new Date},{developer_code:_});let r=e.collateral_info[0],c="";r&&(c=r.unit_id,(yield u.Master_Unit.findOne((0,s.createRequest)(),{unit_id:c,project_code:e.project_code}))?yield u.Master_Unit.update((0,s.createRequest)(),{unit_no:r.unit_no,unit_type:String(null==r?void 0:r.unit_type),unit_type_name:r.unit_type_name,collateral_price:e.total_collateral_price,title_deed_no:r.title_deed_no,floor_no:r.floor_no,zone_no:r.zone_no,building_no:r.building_no,model_name:r.model_name,update_date:new Date},{unit_id:c,project_code:e.project_code}):yield u.Master_Unit.insert((0,s.createRequest)(),{unit_id:c,unit_no:r.unit_no,unit_type:String(r.unit_type),unit_type_name:r.unit_type_name,collateral_price:e.total_collateral_price,title_deed_no:r.title_deed_no,floor_no:r.floor_no,zone_no:r.zone_no,building_no:r.building_no,model_name:r.model_name,project_code:e.project_code,project_name:e.project_name}),(yield u.Mapping_Customer_Unit.findOne((0,s.createRequest)(),{customer_id:t,unit_id:c}))||(yield u.Mapping_Customer_Unit.insert((0,s.createRequest)(),{customer_id:t,unit_id:c})))}return{status:200,message:"success",data:{rem_booking:y.data.data,type_of_borrower:f}}}catch(t){return yield u.Log_Api.insert((0,s.createRequest)(),{type:"inbound",method:"POST",origin:"/externals/rem-quotation",body:JSON.stringify(e),error_message:t.message}),{status:500,message:t.message}}}))},210:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ncbStamps=t.loanCreditOut=t.ncbCreditOut=void 0;const s=a(i(2167)),r=i(7287),o=i(2275),d=a(i(9424)),u=i(3833);function _(e,t){var i,a,d,u;return n(this,void 0,void 0,(function*(){let n="";try{const i=yield c();if(200!=i.status)return{status:i.status,message:i.data.message};"ncb"===t&&(n=`${process.env.WALLET_API_URL}/externals/credit/ncb/out`),"loan"===t&&(n=`${process.env.WALLET_API_URL}/externals/credit/loan/out`);const a=yield(0,s.default)({method:"POST",url:n,headers:{authorization:"Bearer "+i.data.access_token},data:e});return 200!=a.status?{status:a.status,message:a.data.message}:{status:200,message:"success"}}catch(t){return yield r.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:n,body:JSON.stringify(e),error_message:JSON.stringify(null===(i=null==t?void 0:t.response)||void 0===i?void 0:i.data)||t.message}),{status:(null===(a=null==t?void 0:t.response)||void 0===a?void 0:a.status)||500,message:(null===(u=null===(d=null==t?void 0:t.response)||void 0===d?void 0:d.data)||void 0===u?void 0:u.message)||t.message}}}))}function c(){var e;return n(this,void 0,void 0,(function*(){try{let e={client_id:process.env.WALLET_CLIENT_ID,client_secret:process.env.WALLET_CLIENT_SECRET,grant_type:"client_credentials",scope:"wallet"};return yield(0,s.default)({method:"POST",url:`${process.env.WALLET_API_URL}/externals/oauth/token`,data:e})}catch(t){return yield r.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.WALLET_API_URL}/externals/oauth/token`,error_message:JSON.stringify((null===(e=null==t?void 0:t.response)||void 0===e?void 0:e.data)||"")}),(null==t?void 0:t.response)||t}}))}t.ncbCreditOut=e=>n(void 0,void 0,void 0,(function*(){try{const t=yield _(e,"ncb");return 200!=t.status?{status:t.status,message:t.message}:{status:200,message:"success"}}catch(e){return{status:(null==e?void 0:e.status)||500,message:e.message}}})),t.loanCreditOut=e=>n(void 0,void 0,void 0,(function*(){try{const t=yield(0,o.createRequest)().input("loan_id",d.default.NVarChar,e.loan_id).input("developer_code",d.default.NVarChar,e.developer_code).query("SELECT TOP 1 t1.LoanId, t1.DeveloperCode, (CASE WHEN t4.NcbId IS NOT NULL THEN 1 ELSE 0 END) as IsCredit ,t1.IsCreditOut, t3.CustomerId, t3.TypeOfBorrower\n        FROM Master_loan t1 \n        INNER JOIN Master_Project t2 ON t1.DeveloperCode = t2.DeveloperCode\n\t\tINNER JOIN Mapping_Loan t3 ON t1.LoanId = t3.LoanId AND t3.TypeOfBorrower = 'Borrower'\n        LEFT JOIN Master_ncb t4 ON t2.ProjectCode = t4.ProjectCode AND getDate() <= t4.NcbDateOfExpiry AND t4.NcbStatusCode = 'NCB05' AND t3.CustomerId = t4.CustomerId\n        WHERE t1.LoanId = @loan_id AND t1.DeveloperCode = @developer_code");let i=(0,u.snakeCaseKeys)(t.recordset[0]);if(!i)return{status:400,message:"ไม่พบข้อมูลของรายการขอสินเชื่อนี้"};if(!i.is_credit_out){i.is_credit&&(e.is_credit=!1);const t=yield _(e,"loan");if(200!=t.status)return{status:t.status,message:t.message};yield r.Master_Loan.update((0,o.createRequest)(),{is_credit_out:!0},{loan_id:e.loan_id,developer_code:e.developer_code})}return{status:200,message:"success"}}catch(e){return{status:(null==e?void 0:e.status)||500,message:e.message}}})),t.ncbStamps=e=>n(void 0,void 0,void 0,(function*(){var t,i,n,a;try{const t=yield c();if(200!=t.status)return{status:t.status,message:t.data.message};const i=yield(0,s.default)({method:"POST",url:`${process.env.WALLET_API_URL}/externals/credit/ncb/stamp`,headers:{authorization:"Bearer "+t.data.access_token},data:e});return 200!=i.status?{status:i.status,message:i.data.message}:{status:200,message:"success"}}catch(s){return yield r.Log_Api.insert((0,o.createRequest)(),{type:"outbound",method:"POST",origin:`${process.env.WALLET_API_URL}/externals/credit/ncb/stamp`,body:JSON.stringify(e),error_message:JSON.stringify(null===(t=null==s?void 0:s.response)||void 0===t?void 0:t.data)||s.message}),{status:(null===(i=null==s?void 0:s.response)||void 0===i?void 0:i.status)||500,message:(null===(a=null===(n=null==s?void 0:s.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.message)||s.message}}}))},2512:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.removeFileInBlobs=t.removeFile=t.getFile=t.uploadFile=void 0;const s=a(i(2245)),r=i(7287),o=i(2275),d=a(i(9424)),u=i(5107),_=a(i(2167)),c=a(i(7441)),l=i(5918),p=i(210),m=i(2900),y=process.env.AZURE_STORAGE_ACCOUNT_NAME||"";if(!y)throw Error("Azure Storage accountName not found");const f=process.env.AZURE_STORAGE_KEY||"",h=new u.StorageSharedKeyCredential(y,f),b=new u.BlobServiceClient(`https://${y}.blob.core.windows.net`,h),v=process.env.AZURE_STORAGE_CONTAINER_NAME;function g(e){return n(this,void 0,void 0,(function*(){try{const t={deleteSnapshots:"include"},i=yield b.getContainerClient(v);let n=e.replace(`${v}/`,"");const a=yield i.getBlockBlobClient(n);return yield a.delete(t),!0}catch(e){return!1}}))}t.uploadFile=(e,t,i)=>n(void 0,void 0,void 0,(function*(){var i,a,u,_,y,f;try{const O=e.files;if(0==O.length)return t.status(400).send({status:400,message:"parameter files is empty"});let w=String(e.body.type),N=JSON.parse(w).subject,C=process.env.AZURE_STORAGE_PRODUCT_NAME,S=(null===(i=JSON.parse(w))||void 0===i?void 0:i.developer_code)||"",D=(null===(a=JSON.parse(w))||void 0===a?void 0:a.loan_id)||"",P=(null===(u=JSON.parse(w))||void 0===u?void 0:u.document_type)||"",M=(null===(_=JSON.parse(w))||void 0===_?void 0:_.ref_document_name)||"";var h=O[0];let k=(null===(y=JSON.parse(w))||void 0===y?void 0:y.file_name)||h.originalname,q=h.buffer,R=h.mimetype.split("/"),T=h.mimetype;const j=h.originalname.split(".");if(1==j.length)return t.status(400).send({status:400,message:"file extension is required"});let I,L=j[j.length-1];if("ncb"===M){let i=(null===(f=JSON.parse(w))||void 0===f?void 0:f.ncb_password)||"";if(""===i)return t.status(400).send({status:400,message:"กรุณาใส่รหัสสำหรับเปิดรายงานเครดิตบูโร"});let n={file:h,password:i,loan_id:D,customer_id:e.customer_id,developer_code:S};const a=yield(0,l.ncbReport)(n);if(200!=a.status)throw a;I=a.data;let s={loan_id:D,developer_code:S,amount:process.env.WALLET_LOAN,is_credit:!0};const r=yield(0,p.loanCreditOut)(s);if(200!=r.status)throw r}const x=yield(0,o.createRequest)().input("RunKey",d.default.NVarChar,"File").input("KeyCode",d.default.NVarChar,"DOC").input("CreateDate",d.default.Date,new Date).execute("sp_CreateRunning");let E=String(x.recordset[0].RunKey);if("image"===R[0]){let e,t=yield(0,c.default)(h.buffer),i=1920,a=0;"loan"===N?(yield t.metadata().then((function(s){return n(this,void 0,void 0,(function*(){let n=s.height,r=s.width;s.width>i&&(a=i/s.width,n=Math.round(s.height*a),r=i);let o=`<svg width="${r}" height="${n}">          \n        <defs><pattern id="textstripe" patternUnits="userSpaceOnUse" width="400" height="200" patternTransform="rotate(-45)">                \n        <text y="30" fill="#ffffff" style="fill-opacity: .25; stroke: #000000; stroke-opacity: .25;" font-size="24" stroke-width="0.5" paint-order="stroke">${process.env.WATERMARK_TEXT}</text>            \n        </pattern></defs><rect width="100%" height="100%" fill="url(#textstripe)" /> </svg> `,d=Buffer.from(o);e=yield t.composite([{input:d,top:0,left:0}]).resize({width:r,height:n}).toFormat("jpeg",{mozjpeg:!0}).toBuffer()}))})),q=e):(yield t.metadata().then((function(s){return n(this,void 0,void 0,(function*(){let n=s.height,r=s.width;s.width>i&&(a=i/s.width,n=Math.round(s.height*a),r=i),e=yield t.resize({width:r,height:n}).toFormat("jpeg",{mozjpeg:!0}).toBuffer()}))})),q=e),k=E+"-"+k+".jpeg",L="jpeg",T="image/jpeg"}else k=E+"-"+k+"."+L;if(0==["jpg","jpeg","png","pdf"].includes(L.toLowerCase()))throw new Error(`ระบบไม่รองรับไฟล์ .${L}`);const A=yield b.getContainerClient(v);let B=`${C}/${N}/${(0,s.default)().format("YYYY/MM/DD")}/${k}`;"loan"===N&&(B=`${C}/${N}/${S}/${(0,s.default)().format("YYYY/MM/DD")}/${k}`);const U=yield A.getBlockBlobClient(B);yield U.uploadData(q);const V=decodeURIComponent(U.url);var g=yield r.Master_File.insert((0,o.createRequest)(),{file_path:V.replace(b.url,""),file_name:k,file_size:h.size,file_extension:L,file_type:T,customer_id:e.customer_id,create_date:new Date,update_date:new Date,ref_id:D,ref_type:M,group_type:P,status:"temp"});let F=yield(0,m.encryptionFileIdentifier)(String(g));t.status(200).json({id:F,name:k,file_size:h.size,content_type:T,file_extension:L,document_type:P,ref_document_name:M,developer_code:S,url:process.env.URL+`/files/${F}`})}catch(e){t.status(e.status||500).send({status:e.status||500,message:e.message})}})),t.getFile=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{let n=yield(0,m.decryptionFileIdentifier)(String(e.params.id));if(""===n)return t.status(404).send({status:404,message:"file not found"});const a=yield r.Master_File.findOne((0,o.createRequest)(),{id:parseInt(n),customer_id:e.customer_id});if(!a)return t.status(404).send({status:404,message:"file not found"});var i=b.url+a.file_path;const s=yield _.default.get(i,{responseType:"arraybuffer"}),d=Buffer.from(s.data,"binary");t.set({"Content-Type":a.file_type,"Content-Length":s.data.length}),t.end(d,"binary")}catch(e){t.status(500).send({status:500,message:e.message})}})),t.removeFile=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{let i=yield(0,m.decryptionFileIdentifier)(String(e.params.id));if(""===i)return t.status(404).send({status:404,message:"file not found"});const n=yield r.Master_File.findOne((0,o.createRequest)(),{id:parseInt(i),customer_id:e.customer_id});if(!n)return t.status(404).send({status:404,message:"file not found"});if("LOAN"===n.ref_id.substring(0,4)&&"active"===n.status&&"active"!==(yield r.Master_Loan.findOne((0,o.createRequest)(),{loan_id:n.ref_id})).status)return t.status(400).send({status:400,message:"ไม่สามารถลบไฟล์เอกสารนี้ได้ เนื่องจากท่านได้ทำการใช้เอกสารนี้ในการยื่นขอสินเชื่อแล้ว"});g(n.file_path)&&(yield r.Master_File.delete((0,o.createRequest)(),{id:parseInt(i),customer_id:e.customer_id})),t.status(200).send({status:200,message:"ลบไฟล์สำเร็จ"})}catch(e){t.status(500).send({status:500,message:e.message})}})),t.removeFileInBlobs=(e,t)=>n(void 0,void 0,void 0,(function*(){try{const e=yield(0,o.createRequest)().query("  SELECT Id, FilePath \n    FROM Master_File\n    WHERE Status <> 'active' AND  CONVERT(VARCHAR(10), CreateDate, 103) < CONVERT(VARCHAR(10), getdate(), 103);");let i=0;for(let t=0;t<e.recordset.length;t++)try{let n=e.recordset[t].FilePath;(yield g(n))&&(yield r.Master_File.delete((0,o.createRequest)(),{id:parseInt(e.recordset[t].Id)}),i+=1)}catch(e){console.log(e.message)}t.status(200).send({status:200,message:"ลบไฟล์ที่ไม่ถูกใช้สำเร็จ ทั้งหมด "+i+"ไฟล์"})}catch(e){t.status(500).send({status:500,message:e.message})}}))},5045:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.storage=void 0;const o=r(i(6860)),d=r(i(7059)),u=r(i(298)),_=s(i(2512)),c=i(2821),l=r(i(1738)),p=i(568),m=o.default.Router();m.use("/externals",d.default),m.use("/internals",u.default),t.storage=l.default.memoryStorage();const y=(0,l.default)({storage:t.storage,limits:{fileSize:26214400}});m.post("/files",c.withAuthenForToken,y.any(),_.uploadFile),m.get("/files/:id",c.withAuthenForToken,_.getFile),m.post("/files/:id/remove",c.withAuthenForToken,_.removeFile),m.post("/ndid/callback",p.callback),t.default=m},8563:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkBlockedPin=t.checkPin=t.forgotPin=t.changePin=t.logout=t.getToken=t.login=t.register=t.checkCitizenId=t.consent=void 0;const d=i(2275),u=o(i(9424)),_=i(7287),c=o(i(7096)),l=o(i(5960)),p=s(i(8577)),m=s(i(6497)),y=s(i(1650)),f=o(i(2245)),h=i(2742),b=i(3833);function v(e,t,i,n,a){return r(this,void 0,void 0,(function*(){let s,r,o=n||0,u=!1;return(e=t+1)<3&&(s="ท่านระบุรหัสผ่านไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง (ท่านสามารถระบุรหัสผ่านได้ 3 ครั้ง)",r=i||new Date),e>=3&&(u=!0,o+=30,r=new Date((0,f.default)().add(o,"minutes").toString()),s="ขออภัย ท่านใส่รหัสผ่านผิดเกินกำหนด กรุณารอ "+o+"นาที หรือกดลืมรหัสผ่าน"),yield _.Mapping_Customer_Register.update((0,d.createRequest)(),{count_wrong_pin:e,expied_date_blocked_pin:r,blocked_minutes:o,update_date:new Date},{line_id:a,status:"active"}),{message:s,count_wrong_pin:e,expied_date_blocked_pin:(0,f.default)(r).format("YYYY-MM-DD HH:mm:ss"),blocked_minutes:o,blocked_pin:u}}))}function g(e,t,i){return r(this,void 0,void 0,(function*(){const n=(0,f.default)().format("YYYY-MM-DD HH:mm:ss"),a=(0,f.default)(t||n).format("YYYY-MM-DD HH:mm:ss");let s={status:200,message:"PIN ไม่ถูกระงับการใช้งาน",data:{count_wrong_pin:e,blocked_minutes:i,expied_date_blocked_pin:a,blocked_pin:!1}};return e>=3&&(0,f.default)(n).unix()<(0,f.default)(a).unix()&&(s={status:401,message:"ขออภัย PIN ถูกระงับการใช้งาน",data:{count_wrong_pin:e,blocked_minutes:i,expied_date_blocked_pin:a,blocked_pin:!0}}),s}))}t.consent=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!p.compareKeys(["line_id","is_accept"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield p.consentSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{line_id:i,is_accept:n}=e.body,a=yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{line_id:i});let s=yield m.getUserLineProfile(e.body.line_id);a?yield _.Mapping_Customer_Register.update((0,d.createRequest)(),{line_name:(null==s?void 0:s.displayName)||"",is_accept:n,update_date:new Date},{line_id:i}):yield _.Mapping_Customer_Register.insert((0,d.createRequest)(),{line_id:i,line_name:(null==s?void 0:s.displayName)||"",is_accept:n}),t.status(200).send({status:200,message:"success"})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/auth/consent",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.checkCitizenId=(e,t,i)=>r(void 0,void 0,void 0,(function*(){var i,n,a,s,r,o;try{if(!p.compareKeys(["citizen_id","laser_code","first_name","last_name","date_of_birth"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield p.checkCitizenSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{citizen_id:i,laser_code:n,first_name:a,last_name:s,date_of_birth:r}=e.body;if((0,f.default)().diff(r,"years",!1)<20)return t.status(400).send({status:400,message:"ขออภัยท่านไม่สามารถลงทะเบียนเข้าใช้งานระบบได้ เนื่องจากอายุของท่านยังไม่ถึงเกณฑ์ที่กำหนด"});if((yield(0,d.createRequest)().input("citizen_id",u.default.NVarChar,i).query("\n      SELECT t1.CitizenId\n      FROM Master_Customer t1\n      INNER JOIN Mapping_Customer_Register t2 ON t1.CustomerId = t2.CustomerId\n      WHERE t2.Status = 'active' AND t1.CitizenId =  @citizen_id\n      ")).recordset[0])return t.status(400).send({status:400,message:"ไม่สามารถลงทะเบียนเข้าใช้งานได้เนื่องจากหมายเลขบัตรประชาชนนี้มีผู้ลงทะเบียนไปแล้ว กรุณาติดต่อผู้ให้บริการ"});let o={cid:i,laser_code:n,birth_date:(0,f.default)(r).format("yyyyMMDD"),first_name:a,last_name:s};const _=yield(0,h.verifyIdCard)(o);if(200!=_.status)return t.status((null==_?void 0:_.status)||400).send({status:(null==_?void 0:_.status)||400,message:(null==_?void 0:_.message)||"หมายเลขบัตรประชาชนนี้ไม่สามารถลงทะเบียนเข้าใช้งานระบบได้",data:(null==_?void 0:_.data)||{}});t.status(200).send({status:200,message:"หมายเลขบัตรประชาชนนี้สามารถลงทะเบียนเข้าใช้งานระบบได้"})}catch(u){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/auth/check-citizen",body:JSON.stringify(e.body),error_message:(null===(n=null===(i=null==u?void 0:u.response)||void 0===i?void 0:i.data)||void 0===n?void 0:n.message)||(null==u?void 0:u.message)||""}),t.status((null===(a=null==u?void 0:u.response)||void 0===a?void 0:a.status)||(null==u?void 0:u.status)||500).send({status:(null===(s=null==u?void 0:u.response)||void 0===s?void 0:s.status)||(null==u?void 0:u.status)||500,message:(null===(o=null===(r=null==u?void 0:u.response)||void 0===r?void 0:r.data)||void 0===o?void 0:o.message)||(null==u?void 0:u.message)||"เกิดข้อผิดพลาด"})}})),t.register=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new u.default.Transaction(d.pool);try{if(yield i.begin(),!p.compareKeys(["line_id","citizen_id","first_name","last_name","date_of_birth","mobile_number","email","pin","pin_confirm"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield p.registerSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{line_id:n,citizen_id:a,first_name:s,last_name:r,date_of_birth:o,mobile_number:h,email:b,pin:v,pin_confirm:g}=e.body,O=yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{line_id:n});if(1!=(null==O?void 0:O.is_accept))return t.status(400).send({status:400,message:"ขออภัยท่านยังไม่กดยอมรับข้อตกลง กรุณากดยอมรับข้อตกลงเงื่อนไขการใช้งาน"});if(v!==g)return t.status(400).send({status:400,message:"ท่านระบุรหัสไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง"});const w=yield _.Master_Customer.findOne((0,d.createRequest)(),{citizen_id:a});let N="+66"+h.replace("-","").substring(1);if(!(yield _.Transaction_Sms_Otp.findOne((0,d.createRequest)(),{line_id:n,mobile_number:N,status:"success"})))return t.status(400).send({status:400,message:"เบอร์โทรศัพท์นี้ยังไม่ถูกยืนยันตัวตน"});if(!(yield _.Transaction_Email_Otp.findOne((0,d.createRequest)(),{line_id:n,email:b,status:"success"})))return t.status(400).send({status:400,message:"อีเมลนี้ยังไม่ถูกยืนยันตัวตน"});let C="";if(w){if(C=w.customer_id,yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{customer_id:C,status:"active"}))return t.status(400).send({status:400,message:"ไม่สามารถลงทะเบียนเข้าใช้งานได้เนื่องจากหมายเลขบัตรประชาชนนี้มีผู้ลงทะเบียนไปแล้ว กรุณาติดต่อผู้ให้บริการ"});yield _.Master_Customer.update((0,d.createRequest)(i),{first_name:s,last_name:r,date_of_birth:(0,f.default)(o).format("DD/MM/YYYY"),mobile_number:h,email:b,update_date:new Date},{customer_id:String(C),citizen_id:a})}else{const e=yield(0,d.createRequest)().input("RunKey",u.default.NVarChar,"Customer").input("KeyCode",u.default.NVarChar,"CUS").input("CreateDate",u.default.Date,new Date).execute("sp_CreateRunning");C=String(e.recordset[0].RunKey),yield _.Master_Customer.insert((0,d.createRequest)(i),{customer_id:String(C),citizen_id:a,first_name:s,last_name:r,date_of_birth:(0,f.default)(o).format("DD/MM/YYYY"),mobile_number:h,email:b})}yield _.Mapping_Customer_Register.update((0,d.createRequest)(i),{customer_id:String(C),pin:c.default.hashSync(g,10),status:"active",count_wrong_pin:0,update_date:new Date},{line_id:n});let S=l.default.sign({line_id:n,customer_id:C},{expiresIn:"2h",algorithm:"RS256"});yield _.Transaction_Customer_Login.delete((0,d.createRequest)(i),{line_id:n}),yield _.Transaction_Customer_Login.insert((0,d.createRequest)(i),{line_id:n,token_id:S,status:"active"});let D=yield m.getUserLineProfile(n);const P={display_name:s||D.displayName,picture_url:D.pictureUrl,line_id:n};m.lineOaLinkMenuToUser(n),y.registerSuccessMessage(P),yield i.commit(),t.status(200).send({status:200,message:"ลงทะเบียนสำเร็จ",data:{token:S}})}catch(n){i&&(yield i.rollback()),yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/auth/Register",body:JSON.stringify(e.body),error_message:n.message}),t.status(n.status||500).send({status:n.status||500,message:n.message})}})),t.login=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!e.body)return t.status(400).send({status:400,message:"Body can not be empty!"});const{line_id:i,pin:n}=e.body;let a=0;const s=yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{line_id:i,status:"active"});if(!s)return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน กรุณาลงทะเบียนเข้าใช้งาน"});const r=yield g(s.count_wrong_pin,s.expied_date_blocked_pin,s.blocked_minutes);if(200!==r.status)return t.status(r.status).send({status:r.status,message:r.message,data:r.data});if(!s||!c.default.compareSync(n,s.pin)){const e=yield v(a,s.count_wrong_pin,s.expied_date_blocked_pin,s.blocked_minutes,i);return t.status(401).send({status:401,message:e.message,data:{count_wrong_pin:e.count_wrong_pin,blocked_minutes:e.blocked_minutes,expied_date_blocked_pin:e.expied_date_blocked_pin,blocked_pin:e.blocked_pin}})}{let e=s.customer_id;if(!(yield _.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน กรุณาลงทะเบียนเข้าใช้งาน"});let n=l.default.sign({line_id:i,customer_id:e},{expiresIn:"2h",algorithm:"RS256"});yield _.Mapping_Customer_Register.update((0,d.createRequest)(),{count_wrong_pin:0,expied_date_blocked_pin:null,blocked_minutes:0,update_date:new Date},{line_id:i,status:"active"}),yield _.Transaction_Customer_Login.delete((0,d.createRequest)(),{line_id:i}),yield _.Transaction_Customer_Login.insert((0,d.createRequest)(),{line_id:i,token_id:n,status:"active"}),t.status(200).send({status:200,message:"เข้าสู่ระบบสำเร็จ",data:{token:n,blocked_pin:!1}})}}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/auth/login",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.getToken=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!e.body)return t.status(400).send({status:400,message:"Body can not be empty!"});const{line_id:i}=e.body;console.log(e.body);const n=yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{line_id:i,status:"active"});if(!n)return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน กรุณาลงทะเบียนเข้าใช้งาน"});let a=n.customer_id;if(!(yield _.Master_Customer.findOne((0,d.createRequest)(),{customer_id:a})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน กรุณาลงทะเบียนเข้าใช้งาน"});let s=l.default.sign({line_id:i},{expiresIn:"2h",algorithm:"RS256"});yield _.Mapping_Customer_Register.update((0,d.createRequest)(),{count_wrong_pin:0,expied_date_blocked_pin:null,blocked_minutes:0,update_date:new Date},{line_id:i,status:"active"}),yield _.Transaction_Customer_Login.delete((0,d.createRequest)(),{line_id:i}),yield _.Transaction_Customer_Login.insert((0,d.createRequest)(),{line_id:i,token_id:s,status:"active"}),t.status(200).send({status:200,message:"สำเร็จ",data:{token:s,blocked_pin:!1}})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/auth/token",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.logout=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!e.body)return t.status(400).send({status:400,message:"Body can not be empty!"});const{line_id:i,pin:n}=e.body,a=yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{line_id:i,customer_id:e.customer_id,status:"active"});if(!a)return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน"});if(!a||!c.default.compareSync(n,a.pin))throw new Error("PIN ไม่ถูกต้อง");{let e=a.customer_id;yield _.Mapping_Customer_Register.update((0,d.createRequest)(),{status:"deactive",update_date:new Date},{line_id:i,customer_id:e}),yield _.Transaction_Customer_Login.delete((0,d.createRequest)(),{line_id:i}),yield m.lineOaUnLinkMenuToUser(i),yield _.Transaction_Sms_Otp.update((0,d.createRequest)(),{status:"deactive"},{line_id:i}),yield _.Transaction_Email_Otp.update((0,d.createRequest)(),{status:"deactive"},{line_id:i}),t.status(200).send({status:200,message:"ออกจากระบบสำเร็จ"})}}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/auth/logout",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.changePin=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!p.compareKeys(["line_id","pin","new_pin","new_pin_confirm"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield p.pinSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{line_id:i,pin:n,new_pin:a,new_pin_confirm:s}=e.body;if(!(yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{line_id:i,customer_id:e.customer_id,status:"active"})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน"});if(n===a)return t.status(400).send({status:400,message:"ขออภัย รหัสนี้ถูกใช้งานแล้ว กรุณาตั้งรหัสใหม่",type:"duplicate-pin"});if(a!==s)return t.status(400).send({status:400,message:"ท่านระบุรหัสไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง"});yield _.Mapping_Customer_Register.update((0,d.createRequest)(),{count_wrong_pin:0,expied_date_blocked_pin:null,blocked_minutes:0,pin:c.default.hashSync(a,10),update_date:new Date},{line_id:i,status:"active"});let r=e.customer_id,o=l.default.sign({line_id:i,customer_id:r},{expiresIn:"2h",algorithm:"RS256"});yield _.Transaction_Customer_Login.delete((0,d.createRequest)(),{line_id:i}),yield _.Transaction_Customer_Login.insert((0,d.createRequest)(),{line_id:i,token_id:o,status:"active"}),t.status(200).send({status:200,message:"เปลี่ยน PIN สำเร็จ",data:{token:o}})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/auth/change-pin",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.forgotPin=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!p.compareKeys(["line_id","pin","new_pin","new_pin_confirm"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield p.pinSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{line_id:i,pin:n,new_pin:a,new_pin_confirm:s}=e.body,r=yield(0,d.createRequest)().input("line_id",u.default.NVarChar,i).query("\n          SELECT TOP 1 t1.Email, t1.FirstName, t1.LastName, t2.*\n          FROM Master_Customer t1 \n            INNER JOIN Mapping_Customer_Register t2 ON t1.CustomerId = t2.CustomerId\n          WHERE t2.LineId = @line_id AND t2.Status = 'active'\n        ");let o=(0,b.snakeCaseKeys)(r.recordset[0]);if(!o)return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน"});if(o&&c.default.compareSync(a,o.pin))return t.status(400).send({status:400,message:"ขออภัย รหัสนี้ถูกใช้งานแล้ว กรุณาตั้งรหัสใหม่",type:"duplicate-pin"});if(a!==s)return t.status(400).send({status:400,message:"ท่านระบุรหัสไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง"});if(!(yield _.Transaction_Email_Otp.findOne((0,d.createRequest)(),{line_id:i,email:o.email,pin_code:n,status:"success"})))return t.status(400).send({status:400,message:"ท่านระบุรหัสไม่ถูกต้อง กรุณาตรวจสอบรหัสผ่านจากอีเมลของท่านหรือกดลืมรหัสผ่าน"});yield _.Mapping_Customer_Register.update((0,d.createRequest)(),{count_wrong_pin:0,expied_date_blocked_pin:null,blocked_minutes:0,pin:c.default.hashSync(a,10),update_date:new Date},{line_id:i,status:"active"});let m=e.customer_id,y=l.default.sign({line_id:i,customer_id:m},{expiresIn:"2h",algorithm:"RS256"});yield _.Transaction_Customer_Login.delete((0,d.createRequest)(),{line_id:i}),yield _.Transaction_Customer_Login.insert((0,d.createRequest)(),{line_id:i,token_id:y,status:"active"}),yield _.Transaction_Email_Otp.update((0,d.createRequest)(),{status:"deactive"},{line_id:i,pin_code:n,status:"success"}),t.status(200).send({status:200,message:"รีเซ็ต PIN สำเร็จ",data:{token:y}})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/auth/forgot-pin",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.checkPin=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{line_id:i,pin:n}=e.body;let a=0;const s=yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{line_id:i,customer_id:e.customer_id,status:"active"});if(!s)return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน"});const r=yield g(s.count_wrong_pin,s.expied_date_blocked_pin,s.blocked_minutes);if(200!==r.status)return t.status(r.status).send({status:r.status,message:r.message,data:r.data});if(!s||!c.default.compareSync(n,s.pin)){const e=yield v(a,s.count_wrong_pin,s.expied_date_blocked_pin,s.blocked_minutes,i);return t.status(401).send({status:401,message:e.message,data:{count_wrong_pin:e.count_wrong_pin,blocked_minutes:e.blocked_minutes,expied_date_blocked_pin:e.expied_date_blocked_pin,blocked_pin:e.blocked_pin}})}yield _.Mapping_Customer_Register.update((0,d.createRequest)(),{count_wrong_pin:0,expied_date_blocked_pin:null,blocked_minutes:0},{line_id:i,status:"active"}),t.status(200).send({status:200,message:"PIN ถูกต้อง",data:{blocked_pin:!1}})}catch(e){t.status(500).send({status:500,message:e.message})}})),t.checkBlockedPin=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{line_id:i}=e.body,n=yield _.Mapping_Customer_Register.findOne((0,d.createRequest)(),{line_id:i,status:"active"});if(!n)return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน"});const a=yield g(n.count_wrong_pin,n.expied_date_blocked_pin,n.blocked_minutes);return t.status(a.status).send({status:a.status,message:a.message,data:a.data})}catch(e){t.status(500).send({status:500,message:e.message})}}))},9667:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateAddressSendDoc=t.addressSendDoc=t.update=t.detail=void 0;const d=i(2275),u=i(7287),_=o(i(9424)),c=s(i(8577)),l=i(3833);t.detail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield u.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});t.status(200).send({status:200,message:"success",data:{customer_id:i.customer_id,first_name:i.first_name||"",last_name:i.last_name||"",email:i.email,citizen_id:i.citizen_id,mobile_number:i.mobile_number}})}catch(i){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/customer/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.update=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new _.default.Transaction(d.pool);try{if(yield i.begin(),!c.compareKeys(["line_id","pin","email"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield c.updateEmailSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{line_id:n,email:a}=e.body;if(!(yield u.Transaction_Email_Otp.findOne((0,d.createRequest)(),{line_id:n,email:a,status:"success"})))return t.status(400).send({status:400,message:"อีเมลนี้ยังไม่ถูกยืนยันตัวตน"});yield u.Master_Customer.update((0,d.createRequest)(i),{email:a,update_date:new Date},{customer_id:e.customer_id}),yield i.commit(),t.status(200).send({status:200,message:"แก้ไขอีเมลสำเร็จ"})}catch(n){i&&(yield i.rollback()),yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/customer/update",body:JSON.stringify(e.body),error_message:n.message}),t.status(n.status||500).send({status:n.status||500,message:n.message})}})),t.addressSendDoc=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield u.Master_Customer_Address.findOne((0,d.createRequest)(),{customer_id:e.customer_id,address_type_name:"ที่อยู่ในการจัดส่งเอกสาร"});t.status(200).send({status:200,message:"success",data:{address:(null==i?void 0:i.address)||"",village:(null==i?void 0:i.village)||"",moo:(null==i?void 0:i.moo)||"",floor:(null==i?void 0:i.floor)||"",soi:(null==i?void 0:i.soi)||"",road:(null==i?void 0:i.road)||"",sub_district_id:(null==i?void 0:i.sub_district_id)||"",sub_district_name:(null==i?void 0:i.sub_district_name)||"",district_id:(null==i?void 0:i.district_id)||"",district_name:(null==i?void 0:i.district_name)||"",province_id:(null==i?void 0:i.province_id)||"",province_name:(null==i?void 0:i.province_name)||"",post_code:(null==i?void 0:i.post_code)||"",address_type:(null==i?void 0:i.address_type_name)||"ที่อยู่ในการจัดส่งเอกสาร"}})}catch(i){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/customer/address-send-doc/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.updateAddressSendDoc=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new _.default.Transaction(d.pool);try{if(yield i.begin(),!c.compareKeys(["line_id","pin","address","village","moo","floor","soi","road","sub_district_id","district_id","province_id","post_code"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield c.addressSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{line_id:n,address:a,village:s,moo:r,floor:o,soi:p,road:m,sub_district_id:y,district_id:f,province_id:h,post_code:b}=e.body,v=yield u.Master_Customer_Address.findOne((0,d.createRequest)(),{customer_id:e.customer_id,address_type_name:"ที่อยู่ในการจัดส่งเอกสาร"}),g=yield(0,d.createRequest)().input("sub_district_id",_.default.NVarChar,y).query("SELECT t1.NameTh as SubDistrictName, t2.NameTh as DistrictName, t3.NameTh as ProvinceName\n      FROM Master_SubDistrict t1\n      INNER JOIN Master_District t2 ON t1.DistrictId = t2.DistrictId\n      INNER JOIN Master_Province t3 ON t1.ProvinceId = t3.ProvinceId\n      where t1.SubDistrictId = @sub_district_id"),O=(0,l.snakeCaseKeys)(g.recordset[0]);v?yield u.Master_Customer_Address.update((0,d.createRequest)(i),{address:a,village:s,moo:r,floor:o,soi:p,road:m,sub_district_id:y,sub_district_name:O.sub_district_name,district_id:f,district_name:O.district_name,province_id:h,province_name:O.province_name,post_code:b,update_date:new Date},{customer_id:e.customer_id,address_type_name:"ที่อยู่ในการจัดส่งเอกสาร"}):yield u.Master_Customer_Address.insert((0,d.createRequest)(i),{address:a,village:s,moo:r,floor:o,soi:p,road:m,sub_district_id:y,sub_district_name:O.sub_district_name,district_id:f,district_name:O.district_name,province_id:h,province_name:O.province_name,post_code:b,customer_id:e.customer_id,address_type:5,address_type_name:"ที่อยู่ในการจัดส่งเอกสาร"}),yield i.commit(),t.status(200).send({status:200,message:"แก้ไขที่อยู่จัดส่งเอกสารสำเร็จ"})}catch(n){i&&(yield i.rollback()),yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/customer/address-send-doc/update",body:JSON.stringify(e.body),error_message:n.message}),t.status(n.status||500).send({status:n.status||500,message:n.message})}}))},7123:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.verifyPin=t.requestPin=t.verifyOtp=t.requestOtp=void 0;const d=i(2275),u=i(7287),_=o(i(2245)),c=i(5828),l=o(i(7325)),p=i(82),m=s(i(8577)),y=o(i(9424)),f=i(3833),h=i(8577);t.requestOtp=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!m.compareKeys(["line_id","email"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield m.emailSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{email:i,line_id:n}=e.body,a=(0,c.v4)(),s=l.default.generate({length:4,charset:"alphabetic"});let r=l.default.generate({length:6,charset:"numeric"}),o=s+"-"+r;yield u.Transaction_Email_Otp.update((0,d.createRequest)(),{status:"deactive",expied_date:new Date},{line_id:n,email:i,status:"pending"}),yield u.Transaction_Email_Otp.insert((0,d.createRequest)(),{line_id:n,email:i,pin_code:o,token:a,status:"pending"});const _={send_to:i,subject:"ICON Digital Gateway: รหัส(OTP) สำหรับยืนยันตัวตน",type:"email_otp",pin_code:r,ref_code:s};(yield(0,p.sendMail)(_))?t.status(200).send({status:200,message:"ส่งรหัส OTP ไปยังอีเมลสำเร็จ",data:{token:a,ref:s}}):t.status(500).send({status:500,message:"ส่งรหัส OTP ไปยังอีเมลไม่สำเร็จ กรุณาลองใหม่อีกครั้ง"})}catch(i){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/email/request-otp",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({message:i.message})}})),t.verifyOtp=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{token:i,ref:n,otp_number:a}=e.body;if(!e.body)return t.status(400).send({status:400,message:"Body can not be empty!"});let s=n+"-"+a;const r=yield u.Transaction_Email_Otp.findOne((0,d.createRequest)(),{token:i,pin_code:s,status:"pending"});if(r){const e=(0,_.default)().format("YYYY-MM-DD HH:mm:ss"),n=(0,_.default)(r.expied_date).format("YYYY-MM-DD HH:mm:ss");(0,_.default)(e).unix()<=(0,_.default)(n).unix()?(yield u.Transaction_Email_Otp.update((0,d.createRequest)(),{status:"success",update_date:new Date},{token:i,status:"pending"}),t.status(200).send({status:200,message:"ยืนยัน OTP สำเร็จ"})):t.status(205).send({status:205,message:"รหัส OTP หมดอายุ"})}else t.status(202).send({status:202,message:"รหัส OTP ไม่ถูกต้อง"})}catch(i){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/email/verify-otp",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.requestPin=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{line_id:i,last_citizen_id:n}=e.body;yield h.requestPinSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const a=yield(0,d.createRequest)().input("line_id",y.default.NVarChar,i).query("\n      SELECT TOP 1 t1.Email, t1.FirstName, t1.LastName, t1.CitizenId\n      FROM Master_Customer t1 \n        INNER JOIN Mapping_Customer_Register t2 ON t1.CustomerId = t2.CustomerId\n      WHERE t2.LineId = @line_id AND t2.Status = 'active'\n    ");let s=(0,f.snakeCaseKeys)(a.recordset[0]);if(!s)return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน"});if(!s.citizen_id||s.citizen_id.slice(-4)!=n)return t.status(400).send({status:400,message:"ข้อมูลไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง"});const r=(0,c.v4)();let o=l.default.generate({length:6,charset:"numeric"}),m=new Date((0,_.default)().add(30,"minutes").toString());yield u.Transaction_Email_Otp.update((0,d.createRequest)(),{status:"deactive",expied_date:new Date},{line_id:i,email:s.email,status:"pending"}),yield u.Transaction_Email_Otp.insert((0,d.createRequest)(),{line_id:i,email:s.email,pin_code:o,token:r,expied_date:m,status:"pending"});const b={send_to:s.email,subject:"ICON Digital Gateway: PIN สำหรับตั้งรหัสผ่านใหม่",type:"email_request_pin",pin_code:o};(yield(0,p.sendMail)(b))?t.status(200).send({status:200,message:"ส่งรหัส PIN ไปยังอีเมลสำเร็จ",data:{token:r}}):t.status(500).send({status:500,message:"ส่งรหัส PIN ไปยังอีเมลไม่สำเร็จ กรุณาลองใหม่อีกครั้ง"})}catch(i){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/email/request-pin",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.verifyPin=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{token:i,pin:n}=e.body;if(!e.body)return t.status(400).send({status:400,message:"Body can not be empty!"});let a=n;const s=yield u.Transaction_Email_Otp.findOne((0,d.createRequest)(),{token:i,pin_code:a,status:"pending"});if(s){const e=(0,_.default)().format("YYYY-MM-DD HH:mm:ss"),n=(0,_.default)(s.expied_date).format("YYYY-MM-DD HH:mm:ss");(0,_.default)(e).unix()<=(0,_.default)(n).unix()?(yield u.Transaction_Email_Otp.update((0,d.createRequest)(),{status:"success",update_date:new Date},{token:i,status:"pending"}),t.status(200).send({status:200,message:"ยืนยัน PIN สำเร็จ"})):t.status(205).send({status:205,message:"ขออภัย รหัสหมดอายุ กรุณากดลืมรหัสผ่านเพื่อขอรหัสใหม่"})}else t.status(202).send({status:202,message:"ท่านระบุรหัสไม่ถูกต้อง กรุณาตรวจสอบรหัสผ่านจากอีเมลของท่าน"})}catch(i){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/email/verify-pin",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}}))},298:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(i(6860)),d=s(i(8563)),u=s(i(3938)),_=s(i(7123)),c=s(i(9667)),l=s(i(5414)),p=s(i(1683)),m=i(2821),y=i(1366),f=s(i(861)),h=s(i(6751)),b=s(i(8812)),v=s(i(8535)),g=o.default.Router();g.post("/auth/consent",d.consent),g.post("/auth/check-citizen",d.checkCitizenId),g.post("/auth/register",d.register),g.post("/auth/login",d.login),g.post("/auth/token",d.getToken),g.post("/auth/logout",m.withAuthenForToken,y.checkPin,d.logout),g.post("/auth/change-pin",m.withAuthenForToken,y.checkPin,d.changePin),g.post("/auth/forgot-pin",d.forgotPin),g.post("/auth/check-pin",m.withAuthenForToken,d.checkPin),g.post("/auth/check-blocked-pin",d.checkBlockedPin),g.post("/sms/request-otp",v.requestSmsOtp,u.requestOtp),g.post("/sms/verify-otp",v.verifySmsOtp,u.verifyOtp),g.post("/email/request-otp",v.requestEmailOtp,_.requestOtp),g.post("/email/verify-otp",v.verifyEmailOtp,_.verifyOtp),g.post("/email/request-pin",v.requestPin,_.requestPin),g.post("/email/verify-pin",v.verifyPin,_.verifyPin),g.post("/customer/detail",m.withAuthenForToken,c.detail),g.post("/customer/update",m.withAuthenForToken,y.checkPin,c.update),g.post("/customer/address-send-doc/detail",m.withAuthenForToken,c.addressSendDoc),g.post("/customer/address-send-doc/update",m.withAuthenForToken,y.checkPin,c.updateAddressSendDoc),g.post("/inquiry",m.withAuthenForToken,p.inquiry),g.post("/inquiry/detail",m.withAuthenForToken,p.inquiryDetail),g.post("/inquiry/create",m.withAuthenForToken,p.createInquiry),g.post("/master/province",l.province),g.post("/master/district",l.district),g.post("/master/sub-district",l.subDistrict),g.post("/master/address",l.masterAddress),g.post("/master/subject-inquiry",l.masterSubjectInquiry),g.post("/ncb/list",m.withAuthen,f.ncbListAll),g.post("/ncb/detail",m.withAuthen,f.ncbDetail),g.post("/ncb/customer",m.withAuthen,f.ncbCustomer),g.post("/ncb/confirm/detail",m.withAuthen,f.ncbConfirmDetail),g.post("/ncb/re-confirm/detail",m.withAuthen,f.ncbReConfirmDetail),g.post("/ncb/create",m.withAuthen,f.ncbCreate),g.post("/ncb/bank-idp/list",m.withAuthen,f.ncbBankIdpList),g.post("/ncb/bank-idp/confirm",m.withAuthen,y.checkPin,f.ncbBankIdpConfirm),g.post("/ncb/scan-qr",m.withAuthen,f.ncbScanQrCode),g.post("/loan/scan-qr",m.withAuthenForToken,h.loanScanQrCode),g.post("/loan/list",m.withAuthenForToken,h.loanlist),g.post("/loan/detail",m.withAuthenForToken,h.loanDetail),g.post("/loan/document-ncb/list",m.withAuthenForToken,h.loanDocNcb),g.post("/loan/document-ncb/upload",m.withAuthenForToken,h.loanDocNcbUpload),g.post("/loan/customer/detail",m.withAuthenForToken,h.loanCustomerDetail),g.post("/loan/address/detail",m.withAuthenForToken,h.loanAddress),g.post("/loan/customer-loan/detail",m.withAuthenForToken,h.loanCustomerLoanDetail),g.post("/loan/customer-loan/save",m.withAuthenForToken,h.loanCustomerLoanSave),g.post("/loan/customer-loan/income/detail",m.withAuthenForToken,h.loanCustomerIncomeDetail),g.post("/loan/customer-loan/income/save",m.withAuthenForToken,h.loanCustomerIncomeSave),g.post("/loan/customer-loan/pay/detail",m.withAuthenForToken,h.loanCustomerPayDetail),g.post("/loan/customer-loan/pay/save",m.withAuthenForToken,h.loanCustomerPaySave),g.post("/loan/document/list",m.withAuthenForToken,h.loanDocList),g.post("/loan/document/upload",m.withAuthenForToken,h.loanDocUpload),g.post("/loan/select-bank/list",m.withAuthenForToken,h.loanSelectBankList),g.post("/loan/select-bank/save",m.withAuthenForToken,y.checkPin,h.loanSelectBankSave),g.post("/loan/history/select-bank/list",m.withAuthenForToken,h.loanHistoryIsSelectBank),g.post("/loan/history/list",m.withAuthenForToken,h.loanHistorylist),g.post("/loan/history/detail",m.withAuthenForToken,h.loanHistoryDetail),g.post("/loan/history/unit/detail",m.withAuthenForToken,h.loanHistoryUnit),g.post("/loan/history/loan-customer/detail",m.withAuthenForToken,h.loanHistoryLoanCustomer),g.post("/loan/loan-status/list",m.withAuthenForToken,h.loanStatusList),g.post("/loan/loan-status/detail",m.withAuthenForToken,h.loanStatusDetail),g.post("/loan/loan-status/bank/detail",m.withAuthenForToken,h.loanStatusBankDetail),g.post("/loan/loan-status/select-bank/list",m.withAuthenForToken,h.loanStatusSelectBanklist),g.post("/loan/loan-status/select-bank",m.withAuthenForToken,y.checkPin,h.loanStatusSelectBank),g.post("/loan/loan-status/unselect-bank",m.withAuthenForToken,y.checkPin,h.loanStatusUnselectBank),g.post("/interest/detail",m.withAuthenForToken,b.interestDetail),t.default=g},1683:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createInquiry=t.inquiryDetail=t.inquiry=void 0;const d=i(2275),u=i(7287),_=o(i(9424)),c=o(i(6517)),l=i(8604),p=s(i(8577)),m=i(2900),y=i(82),f=i(5107),h=o(i(2167));t.inquiry=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield u.Transaction_Inquiry.find((0,d.createRequest)(),{customer_id:e.customer_id});let n=c.default.map(i,(e=>{let{id:t,subject_name:i,detail:n,create_date:a}=e;return{id:t,subject_name:i,detail:n,date:a}}));t.status(200).send({status:200,message:"success",data:n})}catch(e){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/inquiry",body:"",error_message:e.message}),t.status(500).send({status:500,message:e.message})}})),t.inquiryDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const n=yield u.Transaction_Inquiry.findOne((0,d.createRequest)(),{id:e.body.id,customer_id:e.customer_id});let a={};if(n){const t=yield u.Master_File.find((0,d.createRequest)(),{ref_id:String(n.id),group_type:"inquiry",customer_id:e.customer_id,status:"active"});for(var i in t){let e=yield(0,m.encryptionFileIdentifier)(String(t[i].id));t[i].id=e}let s=c.default.map(t,(e=>new l.fileResponse(e)));a={id:n.id,subject_id:(null==n?void 0:n.subject_id)||0,subject_name:(null==n?void 0:n.subject_name)||"",detail:(null==n?void 0:n.detail)||"",date:(null==n?void 0:n.create_date)||"",file_document:s[0]||{}}}t.status(200).send({status:200,message:"success",data:a})}catch(e){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/inquiry/detail",body:"",error_message:e.message}),t.status(500).send({status:500,message:e.message})}})),t.createInquiry=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new _.default.Transaction(d.pool);try{if(yield i.begin(),!p.compareKeys(["subject_id","detail","date","file_document"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield p.inquirySchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{subject_id:n,detail:a,date:s,file_document:r}=e.body,o=yield u.Master_Subject_Inquiry.findOne((0,d.createRequest)(),{id:n}),_=yield u.Transaction_Inquiry.insert((0,d.createRequest)(i),{customer_id:e.customer_id,subject_id:String(n),subject_name:(null==o?void 0:o.subject)||"",detail:a,create_date:s});let c=yield(0,m.decryptionFileIdentifier)(String(r.id));yield u.Master_File.update((0,d.createRequest)(),{ref_id:String(_),status:"active"},{id:parseInt(c),customer_id:e.customer_id});const l=yield u.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});if(l){let i=[];const n=yield u.Master_File.findOne((0,d.createRequest)(),{id:parseInt(c),customer_id:e.customer_id,ref_id:String(_)});if(n){const e=process.env.AZURE_STORAGE_ACCOUNT_NAME||"";if(!e)throw Error("Azure Storage accountName not found");const t=process.env.AZURE_STORAGE_KEY||"",a=new f.StorageSharedKeyCredential(e,t),s=new f.BlobServiceClient(`https://${e}.blob.core.windows.net`,a),r=yield h.default.get(s.url+n.file_path,{responseType:"arraybuffer"}),d=Buffer.from(r.data,"binary");i=[{filename:(null==n?void 0:n.file_name)||(null==o?void 0:o.subject)||"",content:d}]}let s={send_to:process.env.INQUIRY_SUPPORT_EMAIL,subject:`ICON Digital Gateway : แจ้งเรื่องร้องเรียน : ${null==o?void 0:o.subject}`,type:"email_inquiry",subject_name:null==o?void 0:o.subject,detail:a,customer_name:`${null==l?void 0:l.first_name} ${null==l?void 0:l.last_name}`,mobile_number:(null==l?void 0:l.mobile_number)||(null==l?void 0:l.phone_number)||"",email:(null==l?void 0:l.email)||"",file_document:i};if(!(yield(0,y.sendMail)(s)))return t.status(400).send({status:400,message:"แจ้งปัญหาไม่สำเร็จ กรุณาลองใหม่อีกครั้ง"})}yield i.commit(),t.status(200).send({status:200,message:"แจ้งปัญหาสำเร็จ"})}catch(n){i&&(yield i.rollback()),yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/inquiry/create",body:JSON.stringify(e.body),error_message:n.message}),t.status(n.status||500).send({status:n.status||500,message:n.message})}}))},8812:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.interestCalculate=t.interestDetail=void 0;const s=a(i(6517)),r=i(7287),o=i(2275),d=i(4680);t.interestDetail=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const i=yield(0,d.interestRateAll)();if(200!=i.status)throw i;let n=(null==i?void 0:i.data)||[];const a=yield r.Master_Bank.find((0,o.createRequest)(),{});let u=[];for(var e in n){let t=s.default.find(a,(t=>{if(t.bank_code===n[e].bank_code)return!0}));u.push(Object.assign(Object.assign({},n[e]),{bank_logo:""!=t.bank_logo&&null!=t.bank_logo?process.env.URL+t.bank_logo:process.env.URL+"/images/noimage.jpg"}))}let _=s.default.map(u,(e=>{const{bank_code:t,bank_name:i,interest_rate:n,bank_logo:a}=e;return{bank_code:t,bank_name:i,bank_logo:a,interest_rate:n}}));t.status(200).send({status:200,message:"success",data:{interest:u,master:{bank:_}}})}catch(e){yield r.Log_Api.insert((0,o.createRequest)(),{type:"inbound",method:"POST",origin:"/interest/detail",error_message:(null==e?void 0:e.message)||""}),t.status((null==e?void 0:e.status)||500).send({status:(null==e?void 0:e.status)||500,message:null==e?void 0:e.message})}})),t.interestCalculate=(e,t,i)=>n(void 0,void 0,void 0,(function*(){}))},6751:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.loanStatusUnselectBank=t.loanStatusSelectBank=t.loanStatusSelectBanklist=t.loanStatusBankDetail=t.loanStatusDetail=t.loanStatusList=t.loanHistoryLoanCustomer=t.loanHistoryUnit=t.loanHistoryDetail=t.loanHistorylist=t.loanHistoryIsSelectBank=t.loanSelectBankSave=t.loanSelectBankList=t.loanDocUpload=t.loanDocList=t.loanCustomerPaySave=t.loanCustomerPayDetail=t.loanCustomerIncomeSave=t.loanCustomerIncomeDetail=t.loanCustomerLoanSave=t.loanCustomerLoanDetail=t.loanAddressSave=t.loanAddress=t.loanCustomerSave=t.loanCustomerDetail=t.loanDocNcbUpload=t.loanDocNcb=t.loanDetail=t.loanlist=t.loanScanQrCode=void 0;const d=i(2275),u=o(i(9424)),_=i(3833),c=i(7287),l=o(i(6517)),p=i(5107),m=i(8604),y=s(i(8577)),f=i(7672),h=s(i(9099)),b=i(5918),v=i(2900),g=process.env.AZURE_STORAGE_ACCOUNT_NAME||"";if(!g)throw Error("Azure Storage accountName not found");const O=process.env.AZURE_STORAGE_KEY||"",w=new p.StorageSharedKeyCredential(g,O);function N(e,t){return r(this,void 0,void 0,(function*(){return yield(0,d.createRequest)().input("loan_id",u.default.NVarChar,e).input("customer_id",u.default.NVarChar,t).query("\n  SELECT TOP(1) t1.LoanId, t1.BookingNo, t1.ContractId,(case when ISNULL(t1.ContractNo,'') != '' then t1.ContractNo else '-' end) as ContractNo,\n  t4.DeveloperName, t5.DeveloperImageUrl,t3.ProjectName, t3.UnitNo, t3.ModelName, t1.TotalCollateralPrice, FORMAT (t1.CreateDate, 'MM/dd/yyyy') as CreateDate\n  FROM Master_Loan t1 \n    INNER JOIN Mapping_Loan t2 ON t1.LoanId = t2.LoanId\n    INNER JOIN Master_Unit t3 ON t1.UnitId = t3.UnitId\n    INNER JOIN Master_Project t4 ON t3.ProjectCode = t4.ProjectCode\n    INNER JOIN Master_Developer t5 ON t4.DeveloperCode = t5.DeveloperCode\n  WHERE t1.LoanId = @loan_id AND t2.CustomerId = @customer_id\n\n  SELECT t2.CustomerId, JSON_VALUE(t2.CustomerData, '$.customer.first_name') as FirstName, JSON_VALUE(t2.CustomerData, '$.customer.last_name') as LastName, t2.RelationWithBorrower, t2.TypeOfBorrower\n  FROM Master_Loan t1 \n    INNER JOIN Mapping_Loan t2 ON t1.LoanId = t2.LoanId AND t2.TypeOfBorrower = 'Co-Borrower'\n  WHERE t1.LoanId = @loan_id\n\n  SELECT t2.CustomerId, JSON_VALUE(t2.CustomerData, '$.customer.first_name') as FirstName, JSON_VALUE(t2.CustomerData, '$.customer.last_name') as LastName, JSON_VALUE(t2.CustomerData, '$.customer.date_of_birth') as DateOfBirth, t2.TypeOfBorrower\n  FROM Master_Loan t1 \n    INNER JOIN Mapping_Loan t2 ON t1.LoanId = t2.LoanId AND t2.TypeOfBorrower = 'Borrower'\n  WHERE t1.LoanId = @loan_id\n")}))}function C(e,t){return r(this,void 0,void 0,(function*(){const i=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,t).input("loan_id",u.default.NVarChar,e).query("\n      SELECT CustomerData \n      FROM  Mapping_Loan \n      WHERE CustomerId = @customer_id AND LoanId = @loan_id\n      ");let n,a=(0,_.snakeCaseKeys)(i.recordset[0]);return a&&(n=JSON.parse(a.customer_data)),n}))}function S(e,t){return r(this,void 0,void 0,(function*(){const i=yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:e,customer_id:t}),n=(0,_.snakeCaseKeys)(JSON.parse(i.customer_address));let a=l.default.map(n,(e=>{let{address:t,floor:i,soi:n,moo:a,village:s,road:r,sub_district:o,sub_district_name:d,district:u,district_name:_,province:c,province_name:l,zipcode:p,address_type:m,address_type_name:y}=e;return{address:t,floor:i,soi:n,moo:a,village:s,road:r,sub_district_id:o,sub_district_name:d,district_id:u,district_name:_,province_id:c,province_name:l,post_code:p,address_type:m,address_type_name:y}}));return a}))}function D(e,t){return r(this,void 0,void 0,(function*(){const i=yield c.Master_Customer_Loan.findOne((0,d.createRequest)(),{loan_id:e,customer_id:t});let n=[];return(null==i?void 0:i.welfare_bank_type)&&(n=JSON.parse(null==i?void 0:i.welfare_bank_type)),{id:(null==i?void 0:i.id)||"",number_of_house:(null==i?void 0:i.number_of_house)||"",number_of_debt_house:(null==i?void 0:i.number_of_debt_house)||"",company_business_type_id:(null==i?void 0:i.company_business_type_id)||"",company_business_type_name:(null==i?void 0:i.company_business_type_name)||"",grade_bureau_id:(null==i?void 0:i.grade_bureau_id)||"",grade_bureau_name:(null==i?void 0:i.grade_bureau_name)||"",welfare_id:(null==i?void 0:i.welfare_id)||"",welfare_name:(null==i?void 0:i.welfare_name)||"",welfare_bank_type:n}}))}function P(e,t){return r(this,void 0,void 0,(function*(){const i=yield c.Master_Customer_Loan.findOne((0,d.createRequest)(),{loan_id:e,customer_id:t});return{id:(null==i?void 0:i.id)||0,income:i.income,ot:i.ot,commission:i.commission,bonus:i.bonus,service_charge:i.service_charge,perdiem:i.perdiem,income_other_fix:i.income_other_fix,income_other_not_fix:i.income_other_not_fix,income_extra:i.income_extra,income_rental:i.income_rental,total_income:i.total_income}}))}function M(e,t){return r(this,void 0,void 0,(function*(){const i=yield c.Master_Customer_Loan.findOne((0,d.createRequest)(),{loan_id:e,customer_id:t});return{id:(null==i?void 0:i.id)||0,pay_social_insurance:i.pay_social_insurance,pay_slip_tax:i.pay_slip_tax,pay_slip_cooperative:i.pay_slip_cooperative,pay_slip_other:i.pay_slip_other,pay_providentfund:i.pay_providentfund,pay_home_loan:i.pay_home_loan,pay_car_loan:i.pay_car_loan,debt_total_credit_card:null==i?void 0:i.debt_total_credit_card,debt_credit_card_per_month:i.debt_credit_card_per_month,debt_cash_card:null==i?void 0:i.debt_cash_card,debt_other:null==i?void 0:i.debt_other,total_debt:null==i?void 0:i.total_debt}}))}function k(e,t){return r(this,void 0,void 0,(function*(){const i=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,t).input("loan_id",u.default.NVarChar,e).query("\n    SELECT t1.Id, t1.FileName, t1.FileSize, t1.FileType , t1.FileExtension, t1.GroupType, t1.RefType, t2.DeveloperCode\n    FROM Master_File t1 \n    INNER JOIN Master_Loan t2 ON t1.RefId = t2.LoanId \n    WHERE t1.RefId = @loan_id AND t1.CustomerId = @customer_id AND (t1.GroupType IN('2','4','5','6'))\n    ");let n=(0,_.snakeCaseKeys)(i.recordset);for(var a in n){let e=yield(0,v.encryptionFileIdentifier)(String(n[a].id));n[a].id=e}return l.default.map(n,(e=>new m.fileResponse(e)))}))}function q(e,t){return r(this,void 0,void 0,(function*(){const i=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,t).input("loan_id",u.default.NVarChar,e).query("\nSELECT t2.BankCode , t2.Name as BankName, t2.BankLogo , t1.IsSelectBank\nFROM Mapping_Loan_Bank t1 \nINNER JOIN Master_bank t2 ON t1.BankCode = t2.BankCode\nWHERE t1.LoanId = @loan_id AND CustomerId = @customer_id AND t1.IsSelectBank = 1\n");return(yield l.default.map((0,_.snakeCaseKeys)(i.recordset),(e=>{let{bank_code:t,bank_name:i,bank_logo:n,is_select_bank:a}=e;return{bank_code:t,bank_name:i,bank_logo:""!=n&&null!=n?process.env.URL+n:process.env.URL+"/images/noimage.jpg",is_select_bank:a}})))||[]}))}new p.BlobServiceClient(`https://${g}.blob.core.windows.net`,w),t.loanScanQrCode=(e,t,i)=>r(void 0,void 0,void 0,(function*(){var i,n,a,s,r,o,p,m,h,b,v,g,O,w,N,C,S,D,P,M,k,q,R,T,j,I,L,x,E,A,B,U,V,F,J,z,$,K,Y,H,G,W,Q,X,Z,ee,te,ie,ne,ae,se,re,oe,de,ue,_e;let ce=new u.default.Transaction(d.pool);try{if(!y.compareKeys(["line_id","data"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.scanQrSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{line_id:re,data:oe}=e.body;let de=oe.split("|")[2];if(yield c.Master_Loan.findOne((0,d.createRequest)(),{contract_id:de,status:"inprogress"}))return t.status(400).send({status:400,message:"ขออภัย รายการขอสินเชื่อของท่านได้ยื่นขอสินเชื่อไปแล้ว กรุณาตรวจสอบประวัติการทำรายการ"});let ue={customer_id:e.customer_id,data:oe};const _e=yield(0,f.quotationFromRem)(ue);if(200!=_e.status)throw _e;const pe=(0,_.snakeCaseKeys)(_e.data),me=(0,_.snakeCaseKeys)(pe.rem_booking),ye=yield c.Master_Loan.findOne((0,d.createRequest)(),{booking_no:me.booking_no,contract_id:me.contract_id});let fe="",he="",be=me.loan_customer.length;if(ye)fe=ye.loan_id,he=ye.status,yield c.Master_Loan.update((0,d.createRequest)(),{booking_no:me.booking_no,contract_id:me.contract_id,contract_no:(null==me?void 0:me.contract_no)||"",unit_id:null===(s=null==me?void 0:me.collateral_info[0])||void 0===s?void 0:s.unit_id,project_code:me.project_code,developer_code:me.developer,total_collateral_price:me.total_collateral_price,request_amt:me.request_amt,down_payment:me.down_payment,book_amount:me.book_amount,approve_date:me.approve_date,book_date:me.book_date,sale_name:(null===(r=null==me?void 0:me.sale_manager_list[0])||void 0===r?void 0:r.sale_name)||"",sale_email:(null===(o=null==me?void 0:me.sale_manager_list[0])||void 0===o?void 0:o.sale_email)||"",count_borrowers:be},{loan_id:ye.loan_id});else{const e=yield(0,d.createRequest)().input("RunKey",u.default.NVarChar,"Loan").input("KeyCode",u.default.NVarChar,"LOAN").input("CreateDate",u.default.Date,new Date).execute("sp_CreateRunning");fe=String(e.recordset[0].RunKey),yield c.Master_Loan.insert((0,d.createRequest)(),{loan_id:fe,booking_no:me.booking_no,contract_id:me.contract_id,contract_no:(null==me?void 0:me.contract_no)||"",unit_id:null===(i=null==me?void 0:me.collateral_info[0])||void 0===i?void 0:i.unit_id,project_code:me.project_code,developer_code:me.developer,total_collateral_price:me.total_collateral_price,request_amt:me.request_amt,down_payment:me.down_payment,book_amount:me.book_amount,approve_date:me.approve_date,book_date:me.book_date,status:"active",sale_name:(null===(n=null==me?void 0:me.sale_manager_list[0])||void 0===n?void 0:n.sale_name)||"",sale_email:(null===(a=null==me?void 0:me.sale_manager_list[0])||void 0===a?void 0:a.sale_email)||"",count_borrowers:be}),he="active"}if("active"===he){let e=(null===(p=null==me?void 0:me.collateral_info[0])||void 0===p?void 0:p.unit_id)||"";for(var le in me.loan_customer){yield ce.begin();try{let t=me.loan_customer[le],i=0;const n=yield c.Master_Customer.findOne((0,d.createRequest)(),{citizen_id:t.citizen_id});let a="";if(n)a=n.customer_id,yield c.Master_Customer.update((0,d.createRequest)(ce),{customer_id_rem:null==t?void 0:t.customer_id,member_id:null==t?void 0:t.member_id,prefix_id:null==t?void 0:t.title_th_id,middle_name:null==t?void 0:t.middlename_th,prefix_id_eng:(null==t?void 0:t.title_en_id)||0,first_name_eng:null==t?void 0:t.firstname_en,last_name_eng:null==t?void 0:t.lastname_en,middle_name_eng:null==t?void 0:t.middlename_en,date_of_birth:null==t?void 0:t.date_of_birth,nick_name:(null==t?void 0:t.nick_name)||"",gender_code:""!=(null==t?void 0:t.gender_code)?null==t?void 0:t.gender_code:"หญิง"===(null==t?void 0:t.gender_name)?"F":"ชาย"===(null==t?void 0:t.gender_name)?"M":"",married_status_id:null==t?void 0:t.marriage_status_id,age:String(null==t?void 0:t.age),customer_type:null==t?void 0:t.customer_type,nationality_id:null==t?void 0:t.nationality_id,race_id:null==t?void 0:t.race_id,ref_code:null==t?void 0:t.ref_code,authority:(null==t?void 0:t.authority)||"",citizen_date_of_issue:(null==t?void 0:t.doc_reference_effective_date)||"",citizen_date_of_expiry:(null==t?void 0:t.doc_reference_expiry_date)||"",passport_no:(null==t?void 0:t.passport_no)||"",passport_country:(null==t?void 0:t.passport_country)||"",phone_number:(null==t?void 0:t.phone_no)||"",inter_number:(null==t?void 0:t.inter_no)||"",facebook:(null==t?void 0:t.facebook)||"",customer_line_id:(null==t?void 0:t.line_id)||"",we_chat:(null==t?void 0:t.we_chat)||"",whats_app:(null==t?void 0:t.whats_app)||"",occupation_id:null==t?void 0:t.occupation_id,company_name:(null==t?void 0:t.company_name)||"",position:(null==t?void 0:t.position)||"",work_number:(null==t?void 0:t.company_phone)||(null==t?void 0:t.company_mobile)||"",education_id:null==t?void 0:t.education_id,first_job_start_date:null==t?void 0:t.first_job_start_date,current_job_start_date:null==t?void 0:t.current_job_start_date,update_date:new Date},{customer_id:a,citizen_id:t.citizen_id});else{const e=yield(0,d.createRequest)().input("RunKey",u.default.NVarChar,"Customer").input("KeyCode",u.default.NVarChar,"CUS").input("CreateDate",u.default.Date,new Date).execute("sp_CreateRunning");a=String(e.recordset[0].RunKey),yield c.Master_Customer.insert((0,d.createRequest)(ce),{customer_id:a,customer_id_rem:null==t?void 0:t.customer_id,member_id:null==t?void 0:t.member_id,citizen_id:t.citizen_id,prefix_id:null==t?void 0:t.title_th_id,first_name:null==t?void 0:t.firstname_th,last_name:null==t?void 0:t.lastname_th,middle_name:null==t?void 0:t.middlename_th,prefix_id_eng:(null==t?void 0:t.title_en_id)||0,first_name_eng:null==t?void 0:t.firstname_en,last_name_eng:null==t?void 0:t.lastname_en,middle_name_eng:null==t?void 0:t.middlename_en,date_of_birth:null==t?void 0:t.date_of_birth,nick_name:(null==t?void 0:t.nick_name)||"",gender_code:""!=(null==t?void 0:t.gender_code)?null==t?void 0:t.gender_code:"หญิง"===(null==t?void 0:t.gender_name)?"F":"ชาย"===(null==t?void 0:t.gender_name)?"M":"",married_status_id:null==t?void 0:t.marriage_status_id,age:String(null==t?void 0:t.age),customer_type:null==t?void 0:t.customer_type,nationality_id:null==t?void 0:t.nationality_id,race_id:null==t?void 0:t.race_id,ref_code:null==t?void 0:t.ref_code,authority:(null==t?void 0:t.authority)||"",citizen_date_of_issue:(null==t?void 0:t.doc_reference_effective_date)||"",citizen_date_of_expiry:(null==t?void 0:t.doc_reference_expiry_date)||"",passport_no:(null==t?void 0:t.passport_no)||"",passport_country:(null==t?void 0:t.passport_country)||"",phone_number:(null==t?void 0:t.phone_no)||"",inter_number:(null==t?void 0:t.inter_no)||"",facebook:(null==t?void 0:t.facebook)||"",customer_line_id:(null==t?void 0:t.line_id)||"",we_chat:(null==t?void 0:t.we_chat)||"",whats_app:(null==t?void 0:t.whats_app)||"",occupation_id:null==t?void 0:t.occupation_id,company_name:(null==t?void 0:t.company_name)||"",position:(null==t?void 0:t.position)||"",work_number:(null==t?void 0:t.company_phone)||(null==t?void 0:t.company_mobile)||"",education_id:null==t?void 0:t.education_id,first_job_start_date:null==t?void 0:t.first_job_start_date,current_job_start_date:null==t?void 0:t.current_job_start_date})}const s=yield c.Master_Customer_Loan.findOne((0,d.createRequest)(),{customer_id:a,loan_id:fe}),r=yield c.Master_Bareau.findOne((0,d.createRequest)(),{name_th:t.grade_bureau}),o=yield c.Master_Business.findOne((0,d.createRequest)(),{rem_code:t.company_business_type});let _=[];if(t.welfare_bank_type){let e=t.welfare_bank_type;_=l.default.map(e,(e=>{const{bank_id:t}=e;return t}))}s?yield c.Master_Customer_Loan.update((0,d.createRequest)(),{number_of_house:String(null==t?void 0:t.house_no)||"0",number_of_debt_house:String(null==t?void 0:t.number_of_debt_house)||"0",company_business_type_id:null!=(null==o?void 0:o.id)?String(null==o?void 0:o.id):null,company_business_type_name:null==t?void 0:t.company_business_type_name,grade_bureau_id:null!=(null==r?void 0:r.id)?String(null==r?void 0:r.id):null,grade_bureau_name:null==t?void 0:t.grade_bureau,welfare_id:"Yes"===(null==t?void 0:t.welfare)?"1":"2",welfare_name:null==t?void 0:t.welfare_name,welfare_bank_type:JSON.stringify(_),income:(null===(A=null==t?void 0:t.income)||void 0===A?void 0:A.incomes)||0,ot:(null===(B=null==t?void 0:t.income)||void 0===B?void 0:B.ot)||0,commission:(null===(U=null==t?void 0:t.income)||void 0===U?void 0:U.commission)||0,bonus:(null===(V=null==t?void 0:t.income)||void 0===V?void 0:V.bonus)||0,service_charge:(null===(F=null==t?void 0:t.income)||void 0===F?void 0:F.service_charge)||0,perdiem:(null===(J=null==t?void 0:t.income)||void 0===J?void 0:J.perdiem)||0,income_other_fix:(null===(z=null==t?void 0:t.income)||void 0===z?void 0:z.income_other_fix)||0,income_other_not_fix:(null===($=null==t?void 0:t.income)||void 0===$?void 0:$.income_other_not_fix)||0,income_extra:(null===(K=null==t?void 0:t.income)||void 0===K?void 0:K.income_extra)||0,income_rental:(null===(Y=null==t?void 0:t.income)||void 0===Y?void 0:Y.income_rental)||0,total_income:(null===(H=null==t?void 0:t.income)||void 0===H?void 0:H.total_income)||0,pay_social_insurance:(null===(G=null==t?void 0:t.pay)||void 0===G?void 0:G.pay_social_insurance)||0,pay_slip_tax:(null===(W=null==t?void 0:t.pay)||void 0===W?void 0:W.pay_slip_tax)||0,pay_slip_cooperative:(null===(Q=null==t?void 0:t.pay)||void 0===Q?void 0:Q.pay_slip_cooperative)||0,pay_slip_other:(null===(X=null==t?void 0:t.pay)||void 0===X?void 0:X.pay_slip_other)||0,pay_providentfund:(null===(Z=null==t?void 0:t.pay)||void 0===Z?void 0:Z.pay_providentfund)||0,pay_home_loan:(null===(ee=null==t?void 0:t.pay)||void 0===ee?void 0:ee.pay_home_loan)||0,pay_car_loan:(null===(te=null==t?void 0:t.pay)||void 0===te?void 0:te.pay_car_loan)||0,debt_total_credit_card:(null===(ie=null==t?void 0:t.pay)||void 0===ie?void 0:ie.debt_total_credit_card)||0,debt_credit_card_per_month:(null===(ne=null==t?void 0:t.pay)||void 0===ne?void 0:ne.debt_credit_card_per_month)||0,debt_cash_card:0,debt_other:(null===(ae=null==t?void 0:t.pay)||void 0===ae?void 0:ae.debt_other)||0,total_debt:(null===(se=null==t?void 0:t.pay)||void 0===se?void 0:se.total_debt)||0,update_date:new Date},{id:s.id,customer_id:a,loan_id:fe}):yield c.Master_Customer_Loan.insert((0,d.createRequest)(),{number_of_house:String(null==t?void 0:t.house_no)||"0",number_of_debt_house:String(null==t?void 0:t.number_of_debt_house)||"0",company_business_type_id:null!=(null==o?void 0:o.id)?String(null==o?void 0:o.id):null,company_business_type_name:null==t?void 0:t.company_business_type_name,grade_bureau_id:null!=(null==r?void 0:r.id)?String(null==r?void 0:r.id):null,grade_bureau_name:null==t?void 0:t.grade_bureau,welfare_id:"Yes"===(null==t?void 0:t.welfare)?"1":"2",welfare_name:null==t?void 0:t.welfare_name,welfare_bank_type:JSON.stringify(_),income:(null===(m=null==t?void 0:t.income)||void 0===m?void 0:m.incomes)||0,ot:(null===(h=null==t?void 0:t.income)||void 0===h?void 0:h.ot)||0,commission:(null===(b=null==t?void 0:t.income)||void 0===b?void 0:b.commission)||0,bonus:(null===(v=null==t?void 0:t.income)||void 0===v?void 0:v.bonus)||0,service_charge:(null===(g=null==t?void 0:t.income)||void 0===g?void 0:g.service_charge)||0,perdiem:(null===(O=null==t?void 0:t.income)||void 0===O?void 0:O.perdiem)||0,income_other_fix:(null===(w=null==t?void 0:t.income)||void 0===w?void 0:w.income_other_fix)||0,income_other_not_fix:(null===(N=null==t?void 0:t.income)||void 0===N?void 0:N.income_other_not_fix)||0,income_extra:(null===(C=null==t?void 0:t.income)||void 0===C?void 0:C.income_extra)||0,income_rental:(null===(S=null==t?void 0:t.income)||void 0===S?void 0:S.income_rental)||0,total_income:(null===(D=null==t?void 0:t.income)||void 0===D?void 0:D.total_income)||0,pay_social_insurance:(null===(P=null==t?void 0:t.pay)||void 0===P?void 0:P.pay_social_insurance)||0,pay_slip_tax:(null===(M=null==t?void 0:t.pay)||void 0===M?void 0:M.pay_slip_tax)||0,pay_slip_cooperative:(null===(k=null==t?void 0:t.pay)||void 0===k?void 0:k.pay_slip_cooperative)||0,pay_slip_other:(null===(q=null==t?void 0:t.pay)||void 0===q?void 0:q.pay_slip_other)||0,pay_providentfund:(null===(R=null==t?void 0:t.pay)||void 0===R?void 0:R.pay_providentfund)||0,pay_home_loan:(null===(T=null==t?void 0:t.pay)||void 0===T?void 0:T.pay_home_loan)||0,pay_car_loan:(null===(j=null==t?void 0:t.pay)||void 0===j?void 0:j.pay_car_loan)||0,debt_total_credit_card:(null===(I=null==t?void 0:t.pay)||void 0===I?void 0:I.debt_total_credit_card)||0,debt_credit_card_per_month:(null===(L=null==t?void 0:t.pay)||void 0===L?void 0:L.debt_credit_card_per_month)||0,debt_cash_card:0,debt_other:(null===(x=null==t?void 0:t.pay)||void 0===x?void 0:x.debt_other)||0,total_debt:(null===(E=null==t?void 0:t.pay)||void 0===E?void 0:E.total_debt)||0,customer_id:a,loan_id:fe}),(yield c.Mapping_Customer_Unit.findOne((0,d.createRequest)(),{customer_id:a,unit_id:e}))||(yield c.Mapping_Customer_Unit.insert((0,d.createRequest)(ce),{customer_id:a,unit_id:e}));const p=yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:fe,customer_id:a});let y=[];""!=t.other_contact[0].first_name&&(y=l.default.map(t.other_contact,(e=>{const{title_id:t,title_name:i,first_name:n,middle_name:s,last_name:r,relation_ship:o,relation_ship_other:d,mobile_no:u,email:_}=e;return{reserve_prefix_id:t||"",reserve_prefix_name:i||"",reserve_first_name:n||"",reserve_middle_name:s||"",reserve_last_name:r||"",reserve_relation_ship:""!=o?o:d||"",reserve_mobile_number:u||"",reserve_email:_||"",reserve_ref_customer_id:a||""}})));let f={customer:{customer_id:a,citizen_id:(null==t?void 0:t.citizen_id)||"",prefix_id:null==t?void 0:t.title_th_id,prefix_Name:(null==t?void 0:t.title_th)||"",first_name:(null==t?void 0:t.firstname_th)||"",last_name:(null==t?void 0:t.lastname_th)||"",middle_name:(null==t?void 0:t.middlename_th)||"",prefix_id_eng:null==t?void 0:t.title_en_id,prefix_name_eng:(null==t?void 0:t.title_en)||"",first_name_eng:(null==t?void 0:t.firstname_en)||"",last_name_eng:(null==t?void 0:t.lastname_en)||"",middle_name_eng:(null==t?void 0:t.middlename_en)||"",date_of_birth:(null==t?void 0:t.date_of_birth)||"",nick_name:(null==t?void 0:t.nick_name)||"",gender_code:""!=(null==t?void 0:t.gender_code)?null==t?void 0:t.gender_code:"หญิง"===(null==t?void 0:t.gender_name)?"F":"ชาย"===(null==t?void 0:t.gender_name)?"M":"",gender_name:(null==t?void 0:t.gender_name)||"",married_status_id:null==t?void 0:t.marriage_status_id,married_status_name:(null==t?void 0:t.marriage_status_name)||"",age:(null==t?void 0:t.age)||"",customer_type:(null==t?void 0:t.customer_type)||"",nationality_id:null==t?void 0:t.nationality_id,nationality_name:(null==t?void 0:t.nationality_name)||"",race_id:null==t?void 0:t.race_id,race_name:(null==t?void 0:t.race_name)||"",ref_code:(null==t?void 0:t.ref_code)||"",authority:(null==t?void 0:t.authority)||"",citizen_date_of_issue:(null==t?void 0:t.doc_reference_effective_date)||"",citizen_date_of_expiry:(null==t?void 0:t.doc_reference_expiry_date)||"",passport_no:(null==t?void 0:t.passport_no)||"",passport_country:(null==t?void 0:t.passport_country)||"",mobile_number:(null==t?void 0:t.mobile_no)||"",phone_number:(null==t?void 0:t.phone_no)||"",inter_number:(null==t?void 0:t.inter_no)||"",email:(null==t?void 0:t.email)||"",facebook:(null==t?void 0:t.facebook)||"",customer_line_id:(null==t?void 0:t.line_id)||"",we_chat:(null==t?void 0:t.we_chat)||"",whats_app:(null==t?void 0:t.whats_app)||"",occupation_id:null==t?void 0:t.occupation_id,occupation_name:(null==t?void 0:t.occupation_name)||"",company_name:(null==t?void 0:t.company_name)||"",position:(null==t?void 0:t.position)||"",work_number:(null==t?void 0:t.company_phone)||(null==t?void 0:t.company_mobile)||"",education_id:null==t?void 0:t.education_id,education_name:(null==t?void 0:t.education_name)||"",first_job_start_date:(null==t?void 0:t.first_job_start_date)||"",current_job_start_date:(null==t?void 0:t.current_job_start_date)||""},customer_reserve:y};p?yield c.Mapping_Loan.update((0,d.createRequest)(ce),{customer_address:JSON.stringify(t.address),customer_data:JSON.stringify(f),relation_with_borrower:(null==t?void 0:t.relation_ship)||"",mobile_number:t.mobile_no,email:t.email,status:"active",update_date:new Date},{loan_id:fe,customer_id:a}):yield c.Mapping_Loan.insert((0,d.createRequest)(ce),{loan_id:fe,customer_id:a,type_of_borrower:t.type_of_borrower,seq_of_borrower:"Borrower"===t.type_of_borrower?0:i+1,relation_with_borrower:(null==t?void 0:t.relation_ship)||"",customer_address:JSON.stringify(t.address),customer_data:JSON.stringify(f),mobile_number:t.mobile_no,email:t.email,status:"active"}),yield ce.commit()}catch(e){throw ce&&(yield ce.rollback()),new Error(e)}}}t.status(200).send({status:200,message:"success",data:{loan_id:fe,customer_id:e.customer_id,type_of_borrower:pe.type_of_borrower}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/scan-qr",body:JSON.stringify(e.body),error_message:JSON.stringify(null===(re=null==i?void 0:i.response)||void 0===re?void 0:re.data)||i.message}),t.status((null===(oe=null==i?void 0:i.response)||void 0===oe?void 0:oe.status)||i.status||500).send({status:(null===(de=null==i?void 0:i.response)||void 0===de?void 0:de.status)||i.status||500,message:(null===(_e=null===(ue=null==i?void 0:i.response)||void 0===ue?void 0:ue.data)||void 0===_e?void 0:_e.message)||i.message})}})),t.loanlist=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,e.customer_id).query("\n      SELECT t1.LoanId, t1.BookingNo, t1.ContractId, (case when ISNULL(t1.ContractNo,'') != '' then t1.ContractNo else '-' end) as ContractNo, t4.DeveloperCode, t4.DeveloperName, t5.DeveloperImageUrl, t3.ProjectName, t3.UnitNo, t2.TypeOfBorrower\n      FROM Master_Loan t1 \n        INNER JOIN Mapping_Loan t2 ON t1.LoanId = t2.LoanId\n        INNER JOIN Master_Unit t3 ON t1.UnitId = t3.UnitId\n        INNER JOIN Master_Project t4 ON t3.ProjectCode = t4.ProjectCode\n        INNER JOIN Master_Developer t5 ON t4.DeveloperCode = t5.DeveloperCode\n      WHERE  t2.CustomerId = @customer_id AND t1.Status ='active'\n      ORDER BY t1.CreateDate desc\n    ");t.status(200).send({status:200,message:"success",data:(0,_.snakeCaseKeys)(i.recordset)})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/list",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield N(i,e.customer_id);let a=(0,_.snakeCaseKeys)(n.recordsets[0][0]),s=(0,_.snakeCaseKeys)(n.recordsets[1]);t.status(200).send({status:200,message:"success",data:{unit:a,co_borrower:s||[]}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanDocNcb=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:n}=e.body;if(!(yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:n})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอสินเชื่อ"});if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:n,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const a=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,e.customer_id).input("loan_id",u.default.NVarChar,n).query("\n   SELECT t1.Id, t1.FileName, t1.FileSize, t1.FileType , t1.FileExtension, t1.GroupType, t1.RefType, t2.DeveloperCode,t1.Status\n   FROM Master_File t1 \n   INNER JOIN Master_Loan t2 ON t1.RefId = t2.LoanId \n   WHERE t1.RefId = @loan_id AND t1.CustomerId = @customer_id AND t1.GroupType = '3'\n   order by t1.Status, t1.CreateDate desc\n   ");let s=(0,_.snakeCaseKeys)(a.recordset);for(var i in s){let e=yield(0,v.encryptionFileIdentifier)(String(s[i].id));s[i].id=e}let r=l.default.map(s,(e=>new m.fileResponse(e)));t.status(200).send({status:200,message:"success",data:r[0]||{}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/document-ncb/list",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanDocNcbUpload=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!y.compareKeys(["loan_id","file_document"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.docSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{loan_id:i,file_document:n}=e.body,a=yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:i});if(!a)return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอสินเชื่อ"});if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});if("active"!==a.status)return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากท่านได้ทำการยื่นขอสินเชื่อไปยังธนาคารที่เลือกแล้ว"});let s=n[0],r=yield(0,v.decryptionFileIdentifier)(String(s.id));yield c.Master_File.update((0,d.createRequest)(),{status:"active"},{id:parseInt(r),customer_id:e.customer_id,ref_id:i,group_type:s.document_type||"3"}),t.status(200).send({status:200,message:"อัปโหลดไฟล์เอกสาร ncb สำเร็จ"})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/document-ncb/upload",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.loanCustomerDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield C(i,e.customer_id);t.status(200).send({status:200,message:"success",data:{customer:(null==n?void 0:n.customer)||{},customer_reserve:(null==n?void 0:n.customer_reserve)||[]}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/customer/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanCustomerSave=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new u.default.Transaction(d.pool);try{if(yield i.begin(),"active"!==(yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:e.body.loan_id})).status)return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากท่านได้ทำการยื่นขอสินเชื่อไปยังธนาคารที่เลือกแล้ว"});const{reserve_prefix_id:n,reserve_first_name:a,reserve_last_name:s,reserve_married_status_id:r,reserve_mobile_number:o,reserve_email:u}=e.body.customer_reserve;yield c.Mapping_Customer_Reserve.insert((0,d.createRequest)(i),{prefix_id:n,first_name:a,last_name:s,married_status_id:r,mobile_number:o,email:u,ref_customer_id:e.customer_id}),yield i.commit(),t.status(200).send({status:200,message:"บันทึกข้อมูลผู้กู้สำเร็จ"})}catch(n){i&&(yield i.rollback()),yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/customer/save",body:JSON.stringify(e.body),error_message:n.message}),t.status(500).send({status:500,message:n.message})}})),t.loanAddress=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield S(i,e.customer_id);t.status(200).send({status:200,message:"success",data:n||[]})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/address/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanAddressSave=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new u.default.Transaction(d.pool);try{if(yield i.begin(),"active"!==(yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:e.body.loan_id})).status)return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากท่านได้ทำการยื่นขอสินเชื่อไปยังธนาคารที่เลือกแล้ว"});const a=yield c.Master_Customer_Address.find((0,d.createRequest)(),{customer_id:e.customer_id});for(var n in e.body){let t=e.body[n];a.findIndex((e=>e.address_type_name===t.address_type_name))>=0?yield c.Master_Customer_Address.update((0,d.createRequest)(i),{address:t.address,soi:t.soi,road:t.road,sub_district_id:t.sub_district_id,sub_district_name:t.sub_district_name,district_id:t.district_id,district_name:t.district_name,province_id:t.province_id,province_name:t.province_name,post_code:t.post_code,update_date:new Date},{customer_id:e.customer_id,address_type_name:t.address_type_name}):yield c.Master_Customer_Address.insert((0,d.createRequest)(i),{address:t.address,soi:t.soi,road:t.road,sub_district_id:t.sub_district_id,sub_district_name:t.sub_district_name,district_id:t.district_id,district_name:t.district_name,province_id:t.province_id,province_name:t.province_name,post_code:t.post_code,customer_id:e.customer_id,address_type:t.address_type,address_type_name:t.address_type_name})}yield i.commit(),t.status(200).send({status:200,message:"บันทึกที่อยู่สำเร็จ"})}catch(n){i&&(yield i.rollback()),yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/address/save",body:JSON.stringify(e.body),error_message:n.message}),t.status(500).send({status:500,message:n.message})}})),t.loanCustomerLoanDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield D(i,e.customer_id);let a=yield c.Master_Business.find((0,d.createRequest)(),{}),s=l.default.map(a,(e=>{let{id:t,name_th:i}=e;return{company_business_type_id:t,company_business_type_name:i}})),r=yield c.Master_Bareau.find((0,d.createRequest)(),{}),o=l.default.map(r,(e=>{let{id:t,name_th:i}=e;return{grade_bureau_id:t,grade_bureau_name:i}})),u=yield c.Master_Melfare.find((0,d.createRequest)(),{}),_=l.default.map(u,(e=>{let{id:t,name_th:i}=e;return{melfare_id:t,melfare_name:i}})),p=yield c.Master_Bank.find((0,d.createRequest)(),{status:"active"}),m=l.default.map(p,(e=>{let{bank_code:t,name:i}=e;return{bank_code:t,bank_name:i}}));t.status(200).send({status:200,message:"success",data:{customer_loan:n,master:{company_business_type:s,grade_bureau:o,melfare:_,bank:m}}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/customer-loan/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanCustomerLoanSave=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new u.default.Transaction(d.pool);try{if(yield i.begin(),!y.compareKeys(["loan_id","number_of_house","number_of_debt_house","company_business_type_id","grade_bureau_id","welfare_id","welfare_bank_type"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.customerLoanSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{loan_id:n,number_of_house:a,number_of_debt_house:s,company_business_type_id:r,grade_bureau_id:o,welfare_id:u,welfare_bank_type:_=[]}=e.body,l=yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:n});if(!l)return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอสินเชื่อ"});if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:n,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});if("active"!==l.status)return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากท่านได้ทำการยื่นขอสินเชื่อไปยังธนาคารที่เลือกแล้ว"});const p=yield c.Master_Business.findOne((0,d.createRequest)(),{id:parseInt(r)}),m=yield c.Master_Bareau.findOne((0,d.createRequest)(),{id:parseInt(o)}),f=yield c.Master_Melfare.findOne((0,d.createRequest)(),{id:parseInt(u)});(yield c.Master_Customer_Loan.findOne((0,d.createRequest)(),{customer_id:e.customer_id,loan_id:n}))?yield c.Master_Customer_Loan.update((0,d.createRequest)(i),{number_of_house:a,number_of_debt_house:s,company_business_type_id:r,company_business_type_name:(null==p?void 0:p.name_th)||"",grade_bureau_id:o,grade_bureau_name:(null==m?void 0:m.name_th)||"",welfare_id:u,welfare_name:(null==f?void 0:f.name_th)||"",welfare_bank_type:JSON.stringify(_)},{customer_id:e.customer_id,loan_id:n}):yield c.Master_Customer_Loan.insert((0,d.createRequest)(i),{number_of_house:a,number_of_debt_house:s,company_business_type_id:r,company_business_type_name:(null==p?void 0:p.name_th)||"",grade_bureau_id:o,grade_bureau_name:(null==m?void 0:m.name_th)||"",welfare_id:u,welfare_name:(null==f?void 0:f.name_th)||"",welfare_bank_type:JSON.stringify(_),customer_id:e.customer_id,loan_id:n}),yield i.commit(),t.status(200).send({status:200,message:"บันทึกข้อมูลการขอสินเชื่อสำเร็จ"})}catch(n){i&&(yield i.rollback()),yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/customer-loan/save",body:JSON.stringify(e.body),error_message:n.message}),t.status(n.status||500).send({status:n.status||500,message:n.message})}})),t.loanCustomerIncomeDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield P(i,e.customer_id);t.status(200).send({status:200,message:"success",data:{customer_loan:n}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/customer-loan/income/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanCustomerIncomeSave=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new u.default.Transaction(d.pool);try{if(yield i.begin(),!y.compareKeys(["loan_id","income","ot","commission","bonus","service_charge","perdiem","income_other_fix","income_other_not_fix","income_extra","income_rental","total_income"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.incomeSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{loan_id:n,income:a,ot:s,commission:r,bonus:o,service_charge:u,perdiem:_,income_other_fix:l,income_other_not_fix:p,income_extra:m,income_rental:f,total_income:h}=e.body,b=yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:n});if(!b)return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอสินเชื่อ"});if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:n,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});if("active"!==b.status)return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากท่านได้ทำการยื่นขอสินเชื่อไปยังธนาคารที่เลือกแล้ว"});(yield c.Master_Customer_Loan.findOne((0,d.createRequest)(),{customer_id:e.customer_id,loan_id:n}))?yield c.Master_Customer_Loan.update((0,d.createRequest)(i),{income:a,ot:s,commission:r,bonus:o,service_charge:u,perdiem:_,income_other_fix:l,income_other_not_fix:p,income_extra:m,income_rental:f,total_income:h},{customer_id:e.customer_id,loan_id:n}):yield c.Master_Customer_Loan.insert((0,d.createRequest)(),{income:a,ot:s,commission:r,bonus:o,service_charge:u,perdiem:_,income_other_fix:l,income_other_not_fix:p,income_extra:m,income_rental:f,total_income:h,customer_id:e.customer_id,loan_id:n}),yield i.commit(),t.status(200).send({status:200,message:"บันทึกข้อมูลรายได้สำเร็จ"})}catch(n){i&&(yield i.rollback()),yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/customer-loan/income/save",body:JSON.stringify(e.body),error_message:n.message}),t.status(n.status||500).send({status:n.status||500,message:n.message})}})),t.loanCustomerPayDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield M(i,e.customer_id);t.status(200).send({status:200,message:"success",data:{customer_loan:n}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/customer-loan/pay/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanCustomerPaySave=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!y.compareKeys(["loan_id","pay_social_insurance","pay_slip_tax","pay_slip_cooperative","pay_slip_other","pay_providentfund","pay_home_loan","pay_car_loan","debt_total_credit_card","debt_credit_card_per_month","debt_cash_card","debt_other","total_debt"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.paySchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{loan_id:n,pay_social_insurance:a,pay_slip_tax:s,pay_slip_cooperative:r,pay_slip_other:o,pay_providentfund:l,pay_home_loan:p,pay_car_loan:m,debt_total_credit_card:f,debt_credit_card_per_month:h,debt_cash_card:v,debt_other:g,total_debt:O}=e.body,w=yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:n});if(!w)return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอสินเชื่อ"});if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:n,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});if("active"!==w.status)return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากท่านได้ทำการยื่นขอสินเชื่อไปยังธนาคารที่เลือกแล้ว"});const N=yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:n,customer_id:e.customer_id});(yield c.Master_Customer_Loan.findOne((0,d.createRequest)(),{customer_id:e.customer_id,loan_id:n}))?yield c.Master_Customer_Loan.update((0,d.createRequest)(),{pay_social_insurance:a,pay_slip_tax:s,pay_slip_cooperative:r,pay_slip_other:o,pay_providentfund:l,pay_home_loan:p,pay_car_loan:m,debt_total_credit_card:f,debt_credit_card_per_month:h,debt_cash_card:v,debt_other:g,total_debt:O},{customer_id:e.customer_id,loan_id:n}):yield c.Master_Customer_Loan.insert((0,d.createRequest)(),{pay_social_insurance:a,pay_slip_tax:s,pay_slip_cooperative:r,pay_slip_other:o,pay_providentfund:l,pay_home_loan:p,pay_car_loan:m,debt_total_credit_card:f,debt_credit_card_per_month:h,debt_cash_card:v,debt_other:g,total_debt:O,customer_id:e.customer_id,loan_id:n});let C=[];if("Borrower"===N.type_of_borrower){const t=yield(0,d.createRequest)().input("loan_id",u.default.NVarChar,n).query("\n      SELECT t2.CitizenId as UserId, t2.Age\n      FROM Mapping_Loan t1\n      INNER JOIN Master_Customer t2 ON t1.CustomerId = t2.CustomerId\n      WHERE t1.LoanId = @loan_id");if(0==t.recordset.length)throw{status:400,message:"ขออภัย ไม่พบข้อมูลผู้ขอสินเชื่อ"};let a={loan_id:w.loan_id,developer_code:w.developer_code,project_code:w.project_code,loan_customer:(0,_.snakeCaseKeys)(t.recordset)||[],bank:[]};const s=yield(0,b.bankMatching)(a);if(200!==s.status)throw{status:400,message:"ขออภัย เกิดข้อผิดพลาดในการหาธนาคารที่สามารถกู้ผ่าน กรุณาลองใหม่อีกครั้ง"};let r=s.data.data.bank_for_loan||[];for(var i in yield c.Mapping_Loan_Bank.delete((0,d.createRequest)(),{loan_id:n,customer_id:e.customer_id,is_select_bank:!1}),r){let t=String(r[i]);yield c.Mapping_Loan_Bank.insert((0,d.createRequest)(),{bank_code:t,loan_id:n,customer_id:e.customer_id,is_select_bank:!1});const a=yield c.Master_Bank.findOne((0,d.createRequest)(),{bank_code:t});a&&C.push({bank_code:t,bank_name:a.name,bank_logo:""!=a.bank_logo&&null!=a.bank_logo?process.env.URL+a.bank_logo:process.env.URL+"/images/noimage.jpg",is_select_bank:!1})}}t.status(200).send({status:200,message:"บันทึกข้อมูลรายจ่ายสำเร็จ",data:{bank:C}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/customer-loan/income/save",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.loanDocList=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield k(i,e.customer_id);t.status(200).send({status:200,message:"success",data:n||[]})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/document/list",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanDocUpload=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!y.compareKeys(["loan_id","file_document"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.docSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{loan_id:n,file_document:a}=e.body,s=yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:n});if(!s)return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอสินเชื่อ"});if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:n,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});if("active"!==s.status)return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากท่านได้ทำการยื่นขอสินเชื่อไปยังธนาคารที่เลือกแล้ว"});for(var i in a){let t=a[i],s=yield(0,v.decryptionFileIdentifier)(String(t.id));yield c.Master_File.update((0,d.createRequest)(),{status:"active"},{id:parseInt(s),customer_id:e.customer_id,ref_id:n,group_type:t.document_type})}t.status(200).send({status:200,message:"อัปโหลดไฟล์เอกสารสำเร็จ"})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/document/upload",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.loanSelectBankList=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,e.customer_id).input("loan_id",u.default.NVarChar,i).query("\n    SELECT t2.BankCode , t2.Name as BankName, t2.BankLogo , t1.IsSelectBank\n    FROM Mapping_Loan_Bank t1 \n    INNER JOIN Master_bank t2 ON t1.BankCode = t2.BankCode\n    WHERE t1.LoanId = @loan_id AND CustomerId = @customer_id\n    ");let a=yield l.default.map((0,_.snakeCaseKeys)(n.recordset),(e=>{let{bank_code:t,bank_name:i,bank_logo:n,is_select_bank:a}=e;return{bank_code:t,bank_name:i,bank_logo:""!=n&&null!=n?process.env.URL+n:process.env.URL+"/images/noimage.jpg",is_select_bank:a}}));t.status(200).send({status:200,message:"success",data:{bank:a||[]}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/select-bank/list",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanSelectBankSave=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new u.default.Transaction(d.pool);try{if(yield i.begin(),!y.compareKeys(["loan_id","select_bank","pin"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.selectBankSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{loan_id:n,select_bank:a}=e.body,s=yield c.Master_Loan.findOne((0,d.createRequest)(),{loan_id:n});if(!s)return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอสินเชื่อ"});if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:n,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนี้"});if("active"!==s.status)return t.status(400).send({status:400,message:"ไม่สามารถแก้ไขข้อมูลได้ เนื่องจากท่านได้ทำการยื่นขอสินเชื่อไปยังธนาคารที่เลือกแล้ว"});const r=yield h.addNewLoanToRem(n,a,s.developer_code);if(200!=r.status)throw r;yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,e.customer_id).input("loan_id",u.default.NVarChar,n).input("select_bank",u.default.NVarChar,a.join(",")).query("\n        DECLARE @TempTable TABLE (Bank NVARCHAR(50))\n        \n        INSERT INTO @TempTable (Bank) SELECT value FROM STRING_SPLIT(@select_bank, ',')\n        UPDATE Mapping_Loan_Bank\n        SET IsSelectBank = 1\n        WHERE LoanId = @loan_id AND CustomerId = @customer_id AND BankCode IN( SELECT Bank FROM @TempTable)"),yield c.Master_Loan.update((0,d.createRequest)(i),{status:"inprogress",update_date:new Date},{loan_id:n}),yield i.commit(),t.status(200).send({status:200,message:"เลือกธนาคารสำเร็จ"})}catch(n){i&&(yield i.rollback()),yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/select-bank/save",body:JSON.stringify(e.body),error_message:n.message}),t.status(n.status||500).send({status:n.status||500,message:n.message})}})),t.loanHistoryIsSelectBank=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield q(i,e.customer_id);t.status(200).send({status:200,message:"success",data:{bank:n||[]}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/history/select-bank/list",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.loanHistorylist=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,e.customer_id).query("\n      SELECT t1.LoanId, t1.BookingNo, t1.ContractId, (case when ISNULL(t1.ContractNo,'') != '' then t1.ContractNo else '-' end) as ContractNo, t4.DeveloperCode, t4.DeveloperName, t5.DeveloperImageUrl, t3.ProjectName, t3.UnitNo, t2.TypeOfBorrower\n      FROM Master_Loan t1 \n        INNER JOIN Mapping_Loan t2 ON t1.LoanId = t2.LoanId\n        INNER JOIN Master_Unit t3 ON t1.UnitId = t3.UnitId\n        INNER JOIN Master_Project t4 ON t3.ProjectCode = t4.ProjectCode\n        INNER JOIN Master_Developer t5 ON t4.DeveloperCode = t5.DeveloperCode\n      WHERE  t2.CustomerId = @customer_id AND t1.Status = 'inprogress'\n      ORDER BY t1.UpdateDate desc\n    ");t.status(200).send({status:200,message:"success",data:(0,_.snakeCaseKeys)(i.recordset)})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/history/list",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanHistoryDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield N(i,e.customer_id);let a=(0,_.snakeCaseKeys)(n.recordsets[0][0]),s=(0,_.snakeCaseKeys)(n.recordsets[1]),r=(0,_.snakeCaseKeys)(n.recordsets[2][0]);const o=yield C(i,e.customer_id),u=yield S(i,e.customer_id),l=yield D(i,e.customer_id),p=yield P(i,e.customer_id),m=yield M(i,e.customer_id),y=yield q(i,e.customer_id),f=yield k(i,e.customer_id);t.status(200).send({status:200,message:"success",data:{unit:a,loan_customer:{borrower:r||{},co_borrower:s||[]},customer:o.customer,customer_reserve:o.customer_reserve,customer_address:u,customer_loan_detail:l,customer_loan_income:p,customer_loan_pay:m,bank:y||[],file_document:f||[]}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/history/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanHistoryUnit=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield N(i,e.customer_id);let a=(0,_.snakeCaseKeys)(n.recordsets[0][0]);t.status(200).send({status:200,message:"success",data:{unit:a}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/history/unit/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanHistoryLoanCustomer=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{loan_id:i}=e.body;if(!(yield c.Mapping_Loan.findOne((0,d.createRequest)(),{loan_id:i,customer_id:e.customer_id})))return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่านในหมายเลขสินเชื่อนนี้"});const n=yield N(i,e.customer_id);let a=(0,_.snakeCaseKeys)(n.recordsets[1]),s=(0,_.snakeCaseKeys)(n.recordsets[2][0]);t.status(200).send({status:200,message:"success",data:{borrower:s||{},co_borrower:a||[]}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/history/loan-customer/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.loanStatusList=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const n=yield c.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});if(!n)return t.status(400).send({status:400,message:"ไม่พบข้อมูล"});let a={citizen_id:n.citizen_id};const s=yield h.loanAll(a);if(200!=s.status)throw s;const r=yield c.Master_Developer.find((0,d.createRequest)(),{});let o=[];for(var i in s.data){let e="";l.default.find(r,(function(t){t.developer_code===s.data[i].developer_id&&(e=t.developer_image_url||"")})),o.push(Object.assign(Object.assign({},s.data[i]),{developer_image_url:e}))}t.status(200).send({status:200,message:"success",data:o||[]})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/loan-status/list",body:JSON.stringify(e.body),error_message:(null==i?void 0:i.message)||""}),t.status((null==i?void 0:i.status)||500).send({status:(null==i?void 0:i.status)||500,message:null==i?void 0:i.message})}})),t.loanStatusDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{unit_id:n,unit_no:a,booking_no:s}=e.body,r=yield c.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});if(!r)return t.status(400).send({status:400,message:"ไม่พบข้อมูล"});let o={citizen_id:r.citizen_id,unit_id:n,unit_no:a,booking_no:s};const u=yield h.loanDetail(o);if(200!=u.status)throw u;const _=yield c.Master_Bank.find((0,d.createRequest)(),{});let p=u.data[0],m=[];for(var i in p.bank_loan){let e=l.default.find(_,(e=>{if(e.bank_code===p.bank_loan[i].bank_code)return!0}));m.push(Object.assign(Object.assign({},p.bank_loan[i]),{bank_logo:""!=(null==e?void 0:e.bank_logo)&&null!=(null==e?void 0:e.bank_logo)?process.env.URL+e.bank_logo:process.env.URL+"/images/noimage.jpg"}))}const y=yield c.Master_Developer.findOne((0,d.createRequest)(),{developer_code:p.developer_id});t.status(200).send({status:200,message:"success",data:{booking_no:p.booking_no,contract_no:p.contract_no,developer_id:p.developer_id,developer_name:p.developer_name,project_id:p.project_id,project_name:p.project_name,unit_id:p.unit_id,unit_no:p.unit_no,developer_image_url:(null==y?void 0:y.developer_image_url)||"",bank_loan:m}})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/loan-status/detail",body:JSON.stringify(e.body),error_message:(null==i?void 0:i.message)||""}),t.status((null==i?void 0:i.status)||500).send({status:(null==i?void 0:i.status)||500,message:null==i?void 0:i.message})}})),t.loanStatusBankDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{document_no:i}=e.body;let n={document_no:i};const a=yield h.loanBankDetail(n);if(200!=a.status)throw a;let s=a.data[0];const r=yield c.Master_Developer.findOne((0,d.createRequest)(),{developer_code:s.developer_id}),o=yield c.Master_Bank.findOne((0,d.createRequest)(),{bank_code:s.bank_code});t.status(200).send({status:200,message:"success",data:Object.assign(Object.assign({},s),{developer_image_url:(null==r?void 0:r.developer_image_url)||"",bank_logo:""!=o.bank_logo&&null!=o.bank_logo?process.env.URL+o.bank_logo:process.env.URL+"/images/noimage.jpg"})})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/loan-status/bank/detail",body:JSON.stringify(e.body),error_message:(null==i?void 0:i.message)||""}),t.status((null==i?void 0:i.status)||500).send({status:(null==i?void 0:i.status)||500,message:null==i?void 0:i.message})}})),t.loanStatusSelectBanklist=(e,t,i)=>r(void 0,void 0,void 0,(function*(){var i;try{const{unit_id:a,unit_no:s,booking_no:r}=e.body,o=yield c.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});if(!o)return t.status(400).send({status:400,message:"ไม่พบข้อมูล"});let u={citizen_id:o.citizen_id,unit_id:a,unit_no:s,booking_no:r};const _=yield h.loanDetail(u);if(200!=_.status)throw _;let p=[],m=l.default.filter(null===(i=null==_?void 0:_.data[0])||void 0===i?void 0:i.bank_loan,(e=>"approve-2"===e.status));const y=yield c.Master_Bank.find((0,d.createRequest)(),{});for(var n in m){let e=l.default.find(y,(e=>{if(e.bank_code===m[n].bank_code)return!0}));p.push(Object.assign(Object.assign({},m[n]),{bank_logo:""!=e.bank_logo&&null!=e.bank_logo?process.env.URL+e.bank_logo:process.env.URL+"/images/noimage.jpg"}))}t.status(200).send({status:200,message:"success",data:p})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/loan-status/select-bank/list",body:JSON.stringify(e.body),error_message:(null==i?void 0:i.message)||""}),t.status((null==i?void 0:i.status)||500).send({status:(null==i?void 0:i.status)||500,message:null==i?void 0:i.message})}})),t.loanStatusSelectBank=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{document_no:i}=e.body;let n={document_no:i};const a=yield h.loanBankSelect(n);if(200!=a.status)throw a;t.status(200).send({status:200,message:"success",data:a.data})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/loan-status/select-bank",body:JSON.stringify(e.body),error_message:(null==i?void 0:i.message)||""}),t.status((null==i?void 0:i.status)||500).send({status:(null==i?void 0:i.status)||500,message:null==i?void 0:i.message})}})),t.loanStatusUnselectBank=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{document_no:i}=e.body;let n={document_no:i};const a=yield h.loanUnselectBank(n);if(200!=a.status)throw a;t.status(200).send({status:200,message:"success",data:a.data})}catch(i){yield c.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/loan/loan-status/unselect-bank",body:JSON.stringify(e.body),error_message:(null==i?void 0:i.message)||""}),t.status((null==i?void 0:i.status)||500).send({status:(null==i?void 0:i.status)||500,message:null==i?void 0:i.message})}}))},5414:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.masterSubjectInquiry=t.masterAddress=t.subDistrict=t.district=t.province=void 0;const s=a(i(6517)),r=i(3833),o=i(2275),d=i(7287);t.province=(e,t)=>n(void 0,void 0,void 0,(function*(){try{let e=yield d.Master_Province.find((0,o.createRequest)(),{}),i=s.default.map(e,(e=>{let{province_id:t,name_th:i,name_eng:n}=e;return{province_id:t,province_name:i,province_name_eng:n}}));t.status(200).send({status:200,message:"success",data:i})}catch(e){t.status(500).send({status:500,message:e.message})}})),t.district=(e,t)=>n(void 0,void 0,void 0,(function*(){var i;try{let n=yield d.Master_District.find((0,o.createRequest)(),{province_id:null===(i=e.body.province_id)||void 0===i?void 0:i.toString()}),a=s.default.map(n,(e=>{let{district_id:t,name_th:i,name_eng:n,province_id:a}=e;return{district_id:t,district_name:i,district_name_eng:n,province_id:a}}));t.status(200).send({status:200,message:"success",data:a})}catch(e){t.status(500).send({status:500,message:e.message})}})),t.subDistrict=(e,t)=>n(void 0,void 0,void 0,(function*(){var i;try{let n=yield d.Master_SubDistrict.find((0,o.createRequest)(),{district_id:null===(i=e.body.district_id)||void 0===i?void 0:i.toString()}),a=s.default.map(n,(e=>{let{sub_district_id:t,name_th:i,name_eng:n,district_id:a,province_id:s,post_code:r}=e;return{sub_district_id:t,sub_district_name:i,sub_district_name_eng:n,district_id:a,province_id:s,post_code:r}}));t.status(200).send({status:200,message:"success",data:a})}catch(e){t.status(500).send({status:500,message:e.message})}})),t.masterAddress=(e,t)=>n(void 0,void 0,void 0,(function*(){try{const e=yield(0,o.createRequest)().query("SELECT *\n      FROM vw_ThailPost");t.status(200).send({status:200,message:"success",data:(0,r.snakeCaseKeys)(e.recordset)})}catch(e){t.status(500).send({status:500,message:e.message})}})),t.masterSubjectInquiry=(e,t)=>n(void 0,void 0,void 0,(function*(){try{const e=yield d.Master_Subject_Inquiry.find((0,o.createRequest)(),{}),i=s.default.map(e,(e=>{const{id:t,subject:i}=e;return{subject_id:t,subject_name:i}}));t.status(200).send({status:200,message:"success",data:(0,r.snakeCaseKeys)(i)})}catch(e){t.status(500).send({status:500,message:e.message})}}))},861:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ncbBankIdpConfirm=t.ncbBankIdpList=t.ncbScanQrCode=t.ncbCreate=t.ncbReConfirmDetail=t.ncbConfirmDetail=t.ncbCustomer=t.ncbDetail=t.ncbListAll=void 0;const d=i(2275),u=o(i(9424)),_=i(7287),c=o(i(2245)),l=i(3833),p=o(i(6517)),m=i(5828),y=s(i(8577)),f=i(7672),h=s(i(5313)),b=i(210),v=i(7147),g=o(i(1017));function O(e,t){return r(this,void 0,void 0,(function*(){const i=yield _.Master_Idp.find((0,d.createRequest)(),{status:"active"});let n=p.default.pullAllBy(t,e,"id"),a=[],s=[];for(var r in e)p.default.find(i,(t=>{let{idp_logo:i}=t;t.idp_id===e[r].id&&a.push({bank_code:e[r].id,bank_name:e[r].display_name_th,bank_logo:""!=i&&null!=i?process.env.URL+i:process.env.URL+"/images/noimage.jpg",bank_mode:2})}));for(var r in n)p.default.find(i,(e=>{let{idp_logo:t}=e;e.idp_id===n[r].id&&s.push({bank_code:n[r].id,bank_name:n[r].display_name_th,bank_logo:""!=t&&null!=t?process.env.URL+t:process.env.URL+"/images/noimage.jpg",bank_mode:1})}));return{bank_ndid:a,bank_other:s}}))}t.ncbListAll=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,e.customer_id).query("\n      SELECT   t1.NcbId, FORMAT (t1.CreateDate, 'dd/MM/yyyy') as NcbCreateDate, FORMAT (t1.NcbDateOfExpiry, 'dd/MM/yyyy') as NcbDateOfExpiry, \n        t4.Name as NcbStatus, CONCAT(t2.FirstName , ' ', t2.LastName) as CustomerName, t2.CitizenId\n      FROM Master_Ncb t1\n      INNER JOIN Master_Customer t2 ON t1.CustomerId = t2.CustomerId\n      LEFT JOIN Master_Ncb_Status t4  ON t1.NcbStatusCode = t4.NcbStatusCode\n      WHERE t2.CustomerId = @customer_id\n        AND t1.CreateDate BETWEEN DATEADD(DAY, DATEDIFF(DAY, 0, DATEADD(DAY,-30, GetDate())), 0) AND GETDATE()\n    ");t.status(200).send({status:200,message:"success",data:(0,l.snakeCaseKeys)(i.recordset)})}catch(e){t.status(500).send({status:500,message:e.message})}})),t.ncbDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{ncb_id:i}=e.body,n=yield(0,d.createRequest)().input("ncb_id",u.default.NVarChar,i).input("customer_id",u.default.NVarChar,e.customer_id).query("\n        SELECT ISNULL(t1.ProjectName,'') as ProjectName, t1.NcbId,FORMAT (t1.CreateDate, 'dd/MM/yyyy') as NcbCreateDate, FORMAT (t1.NcbDateOfExpiry, 'dd/MM/yyyy') as NcbDateOfExpiry,\n        t4.Name as NcbStatus, CONCAT('คุณ', t2.FirstName , ' ', t2.LastName) as CustomerName,t2.CitizenId, t2.MobileNumber, t2.Email, t1.RequestParams\n        FROM Master_Ncb t1\n        INNER JOIN Master_Customer t2 ON t1.CustomerId = t2.CustomerId\n        LEFT JOIN Master_Prefix t3 ON t2.PrefixId = t3.id\n        LEFT JOIN Master_Ncb_Status t4  ON t1.NcbStatusCode = t4.NcbStatusCode\n        WHERE t2.CustomerId = @customer_id AND t1.NcbId = @ncb_id\n      ");let a=(0,l.snakeCaseKeys)(n.recordset[0]);if(!a)return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอเครดิตบูโร"});const s=yield _.Master_Customer_Address.findOne((0,d.createRequest)(),{customer_id:e.customer_id,address_type_name:"ที่อยู่ในการจัดส่งเอกสาร"});let r=p.default.omit(s,"customer_id","id","create_date","update_date"),o=JSON.parse(a.request_params);t.status(200).send({status:200,message:"success",data:{ncb_id:a.ncb_id,project_name:"โครงการ "+a.project_name,customer_name:(null==o?void 0:o.customer_name)||a.customer_name,citizen_id:(null==o?void 0:o.citizen_id)||a.citizen_id,mobile_number:(null==o?void 0:o.mobile_number)||a.mobile_number,email:(null==o?void 0:o.email)||a.email,address_send_doc:(null==o?void 0:o.address_send_doc)||r,ncb_create_date:a.ncb_create_date}})}catch(e){t.status(500).send({status:500,message:e.message})}})),t.ncbCustomer=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield _.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});let n=(null==i?void 0:i.first_name)?`${null==i?void 0:i.first_name} `:"",a=(null==i?void 0:i.last_name)?`${null==i?void 0:i.last_name} `:"";t.status(200).send({status:200,message:"success",data:{customer_id:i.customer_id,customer_name:n+a,citizen_id:i.citizen_id}})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/ncb/customer/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.ncbConfirmDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield _.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});if(!i)return t.status(400).send({status:400,message:"ไม่พบข้อมูล"});yield _.Master_Prefix.findOne((0,d.createRequest)(),{id:i.prefix_id});const n=yield _.Master_Customer_Address.findOne((0,d.createRequest)(),{customer_id:e.customer_id,address_type_name:"ที่อยู่ในการจัดส่งเอกสาร"});let a=p.default.omit(n,["customer_id","id","create_date","update_date"]);t.status(200).send({status:200,message:"success",data:{customer_id:i.customer_id,member_id:(null==i?void 0:i.member_id)||"",customer_name:"คุณ"+i.first_name+" "+i.last_name,citizen_id:i.citizen_id,email:i.email,mobile_number:i.mobile_number,address_send_doc:a}})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/ncb/confirm/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.ncbReConfirmDetail=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield _.Master_Ncb.findOne((0,d.createRequest)(),{ncb_id:e.body.ncb_id,customer_id:e.customer_id,ncb_status_code:"NCB03"});if(!i)return t.status(400).send({status:400,message:"ไม่พบข้อมูลการขอเครดิตบูโร ที่รอยืนยันตัวตน"});const n=yield _.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});if(!n)return t.status(400).send({status:400,message:"ไม่พบข้อมูล"});yield _.Master_Prefix.findOne((0,d.createRequest)(),{id:n.prefix_id});const a=yield _.Master_Customer_Address.findOne((0,d.createRequest)(),{customer_id:e.customer_id,address_type_name:"ที่อยู่ในการจัดส่งเอกสาร"});let s=p.default.omit(a,["customer_id","id","create_date","update_date"]);t.status(200).send({status:200,message:"success",data:{ncb_type:i.ncb_type,is_ncb:i.is_ncb,is_ncb_terms:i.is_ncb_terms,project_code:i.project_code,project_name:"โครงการ "+i.project_name,booking_no:i.booking_no,contract_id:i.contract_id,ncb_create_date:(0,c.default)(i.create_date).format("DD/MM/yyyy"),customer_data:{customer_id:n.customer_id,member_id:(null==n?void 0:n.member_id)||"",customer_name:"คุณ"+n.first_name+" "+n.last_name,citizen_id:n.citizen_id,email:n.email,mobile_number:n.mobile_number,address_send_doc:s}}})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/ncb/re-confirm/detail",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}})),t.ncbCreate=(e,t,i)=>r(void 0,void 0,void 0,(function*(){let i=new u.default.Transaction(d.pool);try{if(yield i.begin(),e.body.ncb_create_date||(e.body.ncb_create_date=""),e.body.contract_no||(e.body.contract_no=""),!y.compareKeys(["ncb_type","is_ncb","is_ncb_terms","booking_no","contract_id","contract_no","project_code","project_name","unit_id","ncb_create_date","customer_data"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.ncbSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{ncb_type:n="developer",is_ncb:a,is_ncb_terms:s,booking_no:r,contract_id:o,contract_no:c,project_code:p,project_name:m,unit_id:f,customer_data:b}=e.body;let v=e.customer_id;if(!(yield _.Master_Customer.findOne((0,d.createRequest)(),{customer_id:v,citizen_id:null==b?void 0:b.citizen_id})))return t.status(400).send({status:400,message:"ขออภัย ไม่พบข้อมูลของท่านในระบบ"});const g=yield _.Master_Ncb.findOne((0,d.createRequest)(),{booking_no:r,contract_id:o,customer_id:v});if(g&&"NCB03"!=g.ncb_status_code)return t.status(400).send({status:400,message:"ท่านได้ดำเนินการขอเครดิตบูโรไปแล้ว หรืออยู่ระหว่างขั้นตอนดำเนินการโปรดตรวจสอบสถานะเครดิตบูโร"});const w=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,v).query("\n    SELECT *\n    FROM Master_Ncb\n    WHERE NcbStatusCode IN('NCB01','NCB02','NCB03','NCB04')\n    --AND NcbCount < 2\n    AND getDate() <= NcbDateOfExpiry AND NcbDateOfExpiry IS NOT NULL\n    AND CustomerId = @customer_id\n   ");let N="",C=0;if(0===w.recordset.length){const e=yield(0,d.createRequest)().input("RunKey",u.default.NVarChar,"NCB").input("KeyCode",u.default.NVarChar,"NCB").input("CreateDate",u.default.Date,new Date).execute("sp_CreateRunning");N=String(e.recordset[0].RunKey);const t=yield(0,d.createRequest)().input("RunKey",u.default.NVarChar,"NDID").input("KeyCode",u.default.NVarChar,"NDID").input("CreateDate",u.default.Date,new Date).execute("sp_CreateRunningNdid");C=Number(t.recordset[0].RunKey),console.log("ndid_reference",C),yield _.Master_Ncb.insert((0,d.createRequest)(i),{ncb_id:N,is_ncb:a,is_ncb_terms:s,ncb_type:n,customer_id:v,booking_no:r,contract_id:o,contract_no:c,project_code:p,unit_id:f,project_name:m.replace("โครงการ","").toString(),ncb_status_code:"NCB01",ndid_reference:C,request_params:JSON.stringify(b)})}let S=(0,l.snakeCaseKeys)(w.recordset[0]);if(S){if(N=S.ncb_id,"NCB03"!=S.ncb_status_code&&S.contract_id!=o)return t.status(400).send({status:400,message:"ท่านได้ดำเนินการขอเครดิตบูโรไปแล้ว หรืออยู่ระหว่างขั้นตอนดำเนินการโปรดตรวจสอบสถานะเครดิตบูโร"});yield _.Master_Ncb.update((0,d.createRequest)(i),{ncb_status_code:"NCB01",update_date:new Date},{ncb_id:N,booking_no:r,contract_id:o,customer_id:v})}const D=yield h.listIdPs(b.citizen_id);if(200!=D.status)throw D;let P=yield O(D.data.id_providers,D.data.id_on_the_fly);yield i.commit(),t.status(200).send({status:200,message:"success",data:{ncb_id:N,bank_ndid:(null==P?void 0:P.bank_ndid)||[],bank_other:(null==P?void 0:P.bank_other)||[]}})}catch(n){i&&(yield i.rollback()),yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/ncb/create",body:JSON.stringify(e.body),error_message:(null==n?void 0:n.message)||""}),t.status((null==n?void 0:n.status)||n.status||500).send({status:(null==n?void 0:n.status)||n.status||500,message:null==n?void 0:n.message})}})),t.ncbScanQrCode=(e,t,i)=>r(void 0,void 0,void 0,(function*(){var i,n,a;try{if(!y.compareKeys(["line_id","data"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.scanQrSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{line_id:n,data:a}=e.body;let s=a.split("|")[2];if(yield _.Master_Ncb.findOne((0,d.createRequest)(),{contract_id:s,customer_id:e.customer_id}))return t.status(400).send({status:400,message:"ลูกค้าได้ทำการสแกนใบจองนี้ไปแล้ว กรุณาตรวจสอบรายการเครติดบูโร"});const r=yield _.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});if(!r)return t.status(400).send({status:400,message:"ไม่พบข้อมูลของท่าน กรุณาลงทะเบียนเข้าใช้งาน"});let o={customer_id:r.customer_id,data:a};const u=yield(0,f.quotationFromRem)(o);if(200!=u.status)throw u;const c=(0,l.snakeCaseKeys)(u.data),p=(0,l.snakeCaseKeys)(c.rem_booking),m=yield _.Master_Customer.findOne((0,d.createRequest)(),{customer_id:e.customer_id});t.status(200).send({status:200,message:"success",data:{project_code:(null==p?void 0:p.project_code)||"",project_name:"โครงการ "+(null==p?void 0:p.project_name)||0,unit_id:(null===(i=null==p?void 0:p.collateral_info[0])||void 0===i?void 0:i.unit_id)||"",booking_no:(null==p?void 0:p.booking_no)||"",contract_id:(null==p?void 0:p.contract_id)||"",contract_no:(null==p?void 0:p.contract_no)||"",customer_id:(null==m?void 0:m.customer_id)||"",first_name:(null==m?void 0:m.first_name)||"",last_name:(null==m?void 0:m.last_name)||"",citizen_id:(null==m?void 0:m.citizen_id)||"",member_id:(null==m?void 0:m.member_id)||""}})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/ncb/scan-qr",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:(null===(a=null===(n=null==i?void 0:i.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.message)||i.message})}})),t.ncbBankIdpList=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const i=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,e.customer_id).input("ncb_id",u.default.NVarChar,e.body.ncb_id).query("SELECT TOP 1 t2.CitizenId, t1.NcbStatusCode\n      FROM Master_Ncb t1\n      INNER JOIN Master_Customer t2 ON t1.CustomerId = t2.CustomerId\n      WHERE t1.CustomerId = @customer_id AND t1.NcbId = @ncb_id");let n=(0,l.snakeCaseKeys)(i.recordset[0]);if(n||t.status(400).send({status:400,message:"ขออภัย ไม่พบข้อมูลผู้ใช้งานที่ขอ NCB นี้"}),"NCB02"===n.ncb_status_code||"NCB05"===n.ncb_status_code||"NCB06"===n.ncb_status_code)return t.status(400).send({status:400,message:"ขออภัยท่านได้ทำรายการไปแล้ว กรุณาตรวจสอบสถานะการทำรายการ"});const a=yield h.listIdPs(n.citizen_id);if(200!=a.status)throw a;let s=yield O(a.data.id_providers,a.data.id_on_the_fly);t.status(200).send({status:200,message:"success",data:{ncb_id:e.body.ncb_id,bank_ndid:(null==s?void 0:s.bank_ndid)||[],bank_other:(null==s?void 0:s.bank_other)||[]}})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/ncb/bank-idp/list",body:JSON.stringify(e.body),error_message:(null==i?void 0:i.message)||""}),t.status((null==i?void 0:i.status)||500).send({status:(null==i?void 0:i.status)||500,message:null==i?void 0:i.message})}})),t.ncbBankIdpConfirm=(e,t,i)=>r(void 0,void 0,void 0,(function*(){var i;try{if(!y.compareKeys(["ncb_id","bank_code","bank_mode","pin"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield y.bankIdpSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{ncb_id:n,bank_code:a,bank_mode:s}=e.body,r=process.env.IDP_START_TIME,o=process.env.IDP_END_TIME;let p=(new Date).toTimeString();if(p<=r||p>=o)throw{status:400,message:`ขออภัย ไม่สามารถทำรายได้้เนื่องจากอยู่นอกช่วงเวลาทำการ กรุณาทำรายการอีกครั้งในเวลา ${r.substring(0,5)}-${o.substring(0,5)} น.`};const f=yield(0,d.createRequest)().input("customer_id",u.default.NVarChar,e.customer_id).input("ncb_id",u.default.NVarChar,n).query("SELECT TOP 1 t2.CitizenId, t2.FirstName, t2.LastName, t2.MobileNumber, t2.Email, t1.NcbStatusCode, \n        CONCAT( ISNULL(t3.Address+' ',''),  ISNULL('หมู่'+ NULLIF(t3.Moo,'')+' ',''), ISNULL(t3.Village+' ',''), ISNULL('ชั้น'+ NULLIF(t3.Floor,'')+' ',''), ISNULL('ซอย'+NULLIF(t3.Soi, '')+' ',''), \n        ISNULL('ถนน'+NULLIF(t3.Road,'')+',',''), ISNULL(' '+t3.SubDistrictName+',',''),  ISNULL(' '+t3.DistrictName+',',''),  ISNULL(' '+t3.ProvinceName+',',''), ISNULL(' '+t3.PostCode,'')) as address, t4.DeveloperCode\n        , t1.NdidReference, t1.RequestParams,\n        CONCAT( ISNULL(JSON_VALUE(t1.RequestParams, '$.address_send_doc.address')+' ',''),  ISNULL('หมู่'+ NULLIF(JSON_VALUE(t1.RequestParams, '$.address_send_doc.moo'),'')+' ','')\n        , ISNULL(JSON_VALUE(t1.RequestParams, '$.address_send_doc.village')+' ',''), ISNULL('ชั้น'+ NULLIF(JSON_VALUE(t1.RequestParams, '$.address_send_doc.floor'),'')+' ',''), \n        ISNULL('ซอย'+NULLIF(JSON_VALUE(t1.RequestParams, '$.address_send_doc.soi'), '')+' ',''), ISNULL('ถนน'+NULLIF(JSON_VALUE(t1.RequestParams, '$.address_send_doc.road'),'')+',',''), \n        ISNULL(' '+JSON_VALUE(t1.RequestParams, '$.address_send_doc.sub_district_name')+',',''),  ISNULL(' '+JSON_VALUE(t1.RequestParams, '$.address_send_doc.district_name')+',',''), \n         ISNULL(' '+JSON_VALUE(t1.RequestParams, '$.address_send_doc.province_name')+',',''), ISNULL(' '+JSON_VALUE(t1.RequestParams, '$.address_send_doc.post_code'),'')) as AddressSendDoc\n        FROM Master_Ncb t1\n          INNER JOIN Master_Customer t2 ON t1.CustomerId = t2.CustomerId\n          LEFT JOIN Master_Customer_Address t3 ON t2.CustomerId = t3.CustomerId\n          LEFT JOIN Master_Project t4 ON t1.ProjectCode = t4.ProjectCode\n        WHERE t1.CustomerId = @customer_id AND t1.NcbId = @ncb_id");let O=(0,l.snakeCaseKeys)(f.recordset[0]);if(!O)return t.status(400).send({status:400,message:"ขออภัย ไม่พบข้อมูลผู้ใช้งานที่ขอ NCB นี้"});if("NCB02"===O.ncb_status_code||"NCB05"===O.ncb_status_code||"NCB06"===O.ncb_status_code)return t.status(400).send({status:400,message:"ขออภัยท่านได้ทำรายการไปแล้ว กรุณาตรวจสอบสถานะการทำรายการ"});let w={ncb_id:n,developer_code:O.developer_code,amount:process.env.WALLET_NCB,is_credit:!0};const N=yield(0,b.ncbCreditOut)(w);if(200!=N.status)throw N;let C,S=JSON.parse(O.request_params),D={citizen_id:O.citizen_id,service_id:process.env.NDID_SERVICE_ID,as_id_list:[process.env.NDID_AS_ID_LIST],bank_code:a,bank_mode:s,ndid_reference:O.ndid_reference,request_params:{uuid:(0,m.v4)(),agent_shortname:"ICON",id_type:"01",id_number:O.citizen_id,firstname:O.first_name,lastname:O.last_name,mobile_no:(null==S?void 0:S.mobile_number)||O.mobile_number,email:(null==S?void 0:S.email)||O.email,address:(null==O?void 0:O.address_send_doc)||(null==O?void 0:O.address)||"",pro:"01",report:"NSC",reference:"ICON"+(0,c.default)().format("YYYYMMDDHHmmss"),version:1}},P=g.default.join("src/controllers/internals","../..","","ndid-promotion.json");const M=(0,v.readFileSync)(P);if(console.log(Buffer.byteLength(M)),Buffer.byteLength(M)>0){let e=JSON.parse(M);console.log("promotion คงเหลือก่อนใช้",(null==e?void 0:e.promotion_count)||0,"ครั้ง"),e.promotion_count&&((null==e?void 0:e.promotion_count)>0&&(D.request_params.promotion_code=process.env.NDID_PROMOTION_CODE,e.promotion_count-=1),C=e)}const k=yield h.verifyRequestData(D);if(200!=k.status&&202!=k.status)throw k;if(C){let e=JSON.stringify(C);yield(0,v.writeFileSync)(P,e),console.log("promotion คงเหลือหลังใช้",null==C?void 0:C.promotion_count,"ครั้ง")}yield _.Master_Ncb.update((0,d.createRequest)(),{bank_code:a,bank_mode:s,reference_id:k.data.reference_id,ndid_request_id:k.data.ndid_request_id,icon_reference_ndid:(null===(i=null==D?void 0:D.request_params)||void 0===i?void 0:i.reference)||"",ncb_status_code:"NCB02",update_date:new Date},{ncb_id:n,customer_id:e.customer_id}),t.status((null==k?void 0:k.status)||200).send({status:(null==k?void 0:k.status)||200,message:"success",data:Object.assign(Object.assign({},k.data),{ndid_reference:O.ndid_reference,bank_code:a,promotion_usable:`promotion คงเหลือ ${(null==C?void 0:C.promotion_count)||0} ครั้ง`})})}catch(i){yield _.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/ncb/bank-idp/confirm",body:JSON.stringify(e.body),error_message:(null==i?void 0:i.message)||""}),t.status((null==i?void 0:i.status)||500).send({status:(null==i?void 0:i.status)||500,message:null==i?void 0:i.message})}}))},3938:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.verifyOtp=t.requestOtp=void 0;const d=i(2275),u=i(7287),_=o(i(2245)),c=i(5828),l=o(i(7325)),p=i(9138),m=s(i(8577));t.requestOtp=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{if(!m.compareKeys(["line_id","mobile_number"],e.body))throw{status:400,message:"ขออภัย ข้อมูลที่ส่งมาไม่เป็นไปตามที่กำหนด"};yield m.mobileSchema.validate(e.body,{abortEarly:!1,stripUnknown:!1,strict:!0}).catch((e=>{throw{status:400,message:e.errors[0]||e.message}}));const{mobile_number:i,line_id:n}=e.body,a="+66"+i.replace("-","").substring(1),s=((0,c.v4)(),l.default.generate({length:4,charset:"alphabetic"}));let r=`${l.default.generate({length:6,charset:"numeric"})} (${s})`,o=yield(0,p.sendSms)(r,a);200===o.status?(yield u.Transaction_Sms_Otp.update((0,d.createRequest)(),{status:"deactive",expied_date:new Date},{line_id:n,mobile_number:a,status:"pending"}),yield u.Transaction_Sms_Otp.insert((0,d.createRequest)(),{line_id:n,mobile_number:a,pin_code:r,token:String(o.message.result.transaction_id),status:"pending"}),t.status(200).send({status:200,message:"ส่งรหัส OTP สำเร็จ",data:{token:String(o.message.result.transaction_id),ref:s}})):(yield u.Log_Sms.insert((0,d.createRequest)(),{type:"sms otp",body:JSON.stringify({pin_code:r,mobile:a}),error_message:o.message}),t.status(500).send({status:500,message:"ส่งรหัส OTP ไม่สำเร็จ"}))}catch(i){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/sms/request-otp",body:JSON.stringify(e.body),error_message:i.message}),t.status(i.status||500).send({status:i.status||500,message:i.message})}})),t.verifyOtp=(e,t,i)=>r(void 0,void 0,void 0,(function*(){try{const{token:i,ref:n,otp_number:a}=e.body;if(!e.body)return t.status(400).send({message:"Body can not be empty!"});let s=`${a} (${n})`;const r=yield u.Transaction_Sms_Otp.findOne((0,d.createRequest)(),{token:i,pin_code:s,status:"pending"});if(r){const e=(0,_.default)().format("YYYY-MM-DD HH:mm:ss"),n=(0,_.default)(r.expied_date).format("YYYY-MM-DD HH:mm:ss");(0,_.default)(e).unix()<=(0,_.default)(n).unix()?(yield u.Transaction_Sms_Otp.update((0,d.createRequest)(),{status:"success",update_date:new Date},{token:i,status:"pending"}),t.status(200).send({status:200,message:"ยืนยัน OTP สำเร็จ"})):t.status(202).send({status:205,message:"รหัส OTP หมดอายุ"})}else t.status(202).send({status:202,message:"รหัส OTP ไม่ถูกต้อง"})}catch(i){yield u.Log_Api.insert((0,d.createRequest)(),{type:"inbound",method:"POST",origin:"/sms/verify-otp",body:JSON.stringify(e.body),error_message:i.message}),t.status(500).send({status:500,message:i.message})}}))},1650:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ncbRequestedError=t.ncbErrorBank=t.ncbTimeOutAndReject=t.ncbError=t.ncbSuccess=t.welcomeMessage=t.registerSuccessMessage=void 0;const o=i(7287),d=s(i(1443)),u=s(i(6497)),_=i(2275);t.registerSuccessMessage=e=>r(void 0,void 0,void 0,(function*(){try{let i={};return i=d.module.messageRegisterSuccess(e),yield u.sendMessageToUserByLineMessageAPI(e.line_id,i),yield(0,t.welcomeMessage)(e),!0}catch(e){return!1}})),t.welcomeMessage=e=>r(void 0,void 0,void 0,(function*(){try{let t={};return t=d.module.messageWelcome(String(`${process.env.URL}${process.env.BACKGROUND_MESSAGE_LINE}`)),yield u.sendMessageToUserByLineMessageAPI(e.line_id,t),!0}catch(e){return!1}})),t.ncbSuccess=e=>r(void 0,void 0,void 0,(function*(){try{let t={};t=d.module.messageNcbSuccess(String(`${process.env.URL}${process.env.BACKGROUND_MESSAGE_LINE}`),e,String(process.env.NCB_URL_MESSAGE_LINE));const i=yield o.Transaction_Notification_Line.insert((0,_.createRequest)(),{send_to:e.line_id,customer_id:e.customer_id,subject:"ดำเนินการยืนยันเรียบร้อย",body:JSON.stringify(t),create_date:new Date,effective_date:new Date,status:"pending"});return yield u.sendMessageToUserByLineMessageAPI(e.line_id,t),yield o.Transaction_Notification_Line.update((0,_.createRequest)(),{sent_date:new Date,status:"success"},{id:parseInt(i)}),!0}catch(e){return!1}})),t.ncbError=e=>r(void 0,void 0,void 0,(function*(){try{let t={};t=d.module.messageNcbError(e);const i=yield o.Transaction_Notification_Line.insert((0,_.createRequest)(),{send_to:e.line_id,customer_id:e.customer_id,subject:e.ncb_message,body:JSON.stringify(t),create_date:new Date,effective_date:new Date,status:"pending"});return yield u.sendMessageToUserByLineMessageAPI(e.line_id,t),yield o.Transaction_Notification_Line.update((0,_.createRequest)(),{sent_date:new Date,status:"success"},{id:parseInt(i)}),!0}catch(e){return!1}})),t.ncbTimeOutAndReject=e=>r(void 0,void 0,void 0,(function*(){try{let t={};t=d.module.messageNcbTimeOutAndReject(e);const i=yield o.Transaction_Notification_Line.insert((0,_.createRequest)(),{send_to:e.line_id,customer_id:e.customer_id,subject:e.ncb_message,body:JSON.stringify(t),create_date:new Date,effective_date:new Date,status:"pending"});return yield u.sendMessageToUserByLineMessageAPI(e.line_id,t),yield o.Transaction_Notification_Line.update((0,_.createRequest)(),{sent_date:new Date,status:"success"},{id:parseInt(i)}),!0}catch(e){return!1}})),t.ncbErrorBank=e=>r(void 0,void 0,void 0,(function*(){try{let t={};t=d.module.messageNcbErrorฺBank(String(`${process.env.URL}${process.env.BACKGROUND_MESSAGE_LINE}`),e);const i=yield o.Transaction_Notification_Line.insert((0,_.createRequest)(),{send_to:e.line_id,customer_id:e.customer_id,subject:"รอยืนยันตัวตน",body:JSON.stringify(t),create_date:new Date,effective_date:new Date,status:"pending"});return yield u.sendMessageToUserByLineMessageAPI(e.line_id,t),yield o.Transaction_Notification_Line.update((0,_.createRequest)(),{sent_date:new Date,status:"success"},{id:parseInt(i)}),!0}catch(e){return!1}})),t.ncbRequestedError=e=>r(void 0,void 0,void 0,(function*(){try{let t={};t=d.module.messageNcbRequestedError(String(`${process.env.URL}${process.env.BACKGROUND_MESSAGE_LINE}`),e);const i=yield o.Transaction_Notification_Line.insert((0,_.createRequest)(),{send_to:e.line_id,customer_id:e.customer_id,subject:"ขออภัยไม่สามารถดำเนินการต่อได้ กรุณาทำรายการใหม่อีกครั้ง",body:JSON.stringify(t),create_date:new Date,effective_date:new Date,status:"pending"});return yield u.sendMessageToUserByLineMessageAPI(e.line_id,t),yield o.Transaction_Notification_Line.update((0,_.createRequest)(),{sent_date:new Date,status:"success"},{id:parseInt(i)}),!0}catch(e){return!1}}))},568:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.notitest=t.callback=void 0;const d=i(7287),u=i(2275),_=o(i(6517)),c=s(i(1650)),l=i(9424),p=i(622),m=i(210),y=i(5313);function f(e,t,i){return r(this,void 0,void 0,(function*(){let n=[];if(e.response_list.length>0){let a={order_code:e.ndid_request_id,developer_code:t,type:"IdP Accept",amount:i};if("reject"===e.response_list[0].status&&(a.type="IdP Reject"),e.response_list[0].error_code&&(a.type="IdP Error"),n.push(a),e.data_request_list[0].response_list.length>0){let a={order_code:e.ndid_request_id,developer_code:t,type:"AS1 Send Data",amount:i};e.data_request_list[0].response_list[0].error_code&&(a.type="AS1 Respond Error"),n.push(a)}}return n}))}t.callback=(e,t)=>r(void 0,void 0,void 0,(function*(){var i;try{yield d.Log_Ncb.insert((0,u.createRequest)(),{type:"inbound",method:"POST",origin:"/ndid/callback",body:JSON.stringify(e.body)});const n=yield(0,u.createRequest)().input("reference_id",l.NVarChar,e.body.reference_id).input("ndid_request_id",l.NVarChar,e.body.ndid_request_id).query("\n    SELECT t1.NcbId, t1.CustomerId, t1.BankMode, t1.NcbStatusCode, t1.ProjectCode, t2.DeveloperCode\n    FROM Master_Ncb t1\n    LEFT JOIN Master_Project t2 ON t1.ProjectCode = t2.ProjectCode\n    WHERE t1.ReferenceId = @reference_id AND t1.NdidRequestId = @ndid_request_id");let a=(0,p.snakeCaseKeys)(n.recordset[0]),s=[];if(a){a.bank_mode;let t=parseInt(process.env.WALLET_STAMPS_AMOUNT),n=a.ncb_status_code;const r=yield(0,u.createRequest)().input("customer_id",l.NVarChar,a.customer_id).query("\n        SELECT t2.LineId, t1.Email, t1.CustomerId\n        FROM Master_Customer t1\n        INNER JOIN Mapping_Customer_Register t2 ON t1.CustomerId = t2.CustomerId AND t2.Status = 'active'\n        WHERE t1.CustomerId = @customer_id");let o=(0,p.snakeCaseKeys)(r.recordset[0]);if("PENDING"===e.body.status&&(n="NCB02",s.push({order_code:e.body.ndid_request_id,developer_code:a.developer_code,type:"RP Request",amount:t})),"ACCEPTED"===e.body.status){n="NCB05",s.push({order_code:e.body.ndid_request_id,developer_code:a.developer_code,type:"IDP Accept",amount:t},{order_code:e.body.ndid_request_id,developer_code:a.developer_code,type:"AS1 Send Data",amount:t});const i=yield(0,y.getVerifyRequestData)(e.body.reference_id);if(yield d.Log_Ncb.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/identity/verify-and-request-data/data/${e.body.reference_id}`,body:JSON.stringify({reference_id:e.body.reference_id,ndid_request_id:e.body.ndid_request_id}),response:JSON.stringify(i.data)}),s.push({order_code:e.body.ndid_request_id,developer_code:a.developer_code,type:"RP Receive + Verify",amount:t}),200==i.status||201==i.status||202==i.status){const i=yield(0,y.closeRequestIdPs)(e.body.reference_id);yield d.Log_Ncb.insert((0,u.createRequest)(),{type:"outbound",method:"GET",origin:`/ndidproxy/api/identity/verify/${e.body.reference_id}/close`,body:JSON.stringify({reference_id:e.body.reference_id,ndid_request_id:e.body.ndid_request_id}),response:JSON.stringify(i)}),s.push({order_code:e.body.ndid_request_id,developer_code:a.developer_code,type:"RP Close",amount:t})}if(o){let e={line_id:o.line_id,email:o.email,ncb_id:a.ncb_id,customer_id:o.customer_id};yield c.ncbSuccess(e)}}if("IDP_OR_AS_ERROR"===e.body.status){let r={ncb_message:"",ncb_id:"",image:""};if(n=30800==e.body.response_list[0].error_code?"NCB03":"NCB06",e.body.response_list.length>0&&(s=yield f(e.body,a.developer_code,t)),o)switch((null===(i=e.body.response_list[0])||void 0===i?void 0:i.error_code)||e.body.data_request_list[0].response_list[0].error_code){case 3e4:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ผู้ให้บริการยืนยันตัวตนที่ท่านเลือกไม่สามารถให้บริการได้ในขณะนี้ กรุณาทำรายการใหม่หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30000.png`};break;case 30200:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ไม่สามารถทำรายการได้ในขณะนี้ กรุณาตรวจสอบเลขบัตรประชาชนของท่านและทำรายการใหม่ หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30200.png`};break;case 30300:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ไม่พบข้อมูลของท่านในฐานข้อมูลผู้ใช้บริการของผู้ให้บริการยืนยันตัวตนที่ท่านเลือก กรุณาเลือกผู้ให้บริการยืนยันตัวตนรายอื่นที่ท่านเคยลงทะเบียนและมีโมบายแอปพลิเคชัน",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30300.png`};break;case 30400:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ขออภัย ข้อมูลของท่านไม่เป็นปัจจุบัน กรุณาติดต่อผู้ให้บริการยืนยันตัวตนที่ท่านเลือกเพื่ออัปเดทข้อมูล หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30400.png`};break;case 30500:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"การยืนยันตัวตนไม่สำเร็จเนื่องจากท่านระบุ PIN ผิด, ภาพถ่ายไม่ชัดเจน กรุณาทำรายการใหม่ หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30500.png`};break;case 30510:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"การยืนยันตัวตนไม่สำเร็จเนื่องจากท่านระบุ PIN/Password ไม่ถูกต้องกรุณาทำรายการใหม่ หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30510.png`};break;case 30520:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"การยืนยันตัวตนไม่สำเร็จเนื่องจากท่านยืนยันตัวตนด้วยระบบจดจำใบหน้า (Face Recognition) ไม่ผ่านตามเงื่อนไขที่กำหนด กรุณาทำรายการใหม่ หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30520.png`};break;case 30530:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"การยืนยันตัวตนไม่สำเร็จเนื่องจากท่านระบุรหัส OTP ไม่ถูกต้องกรุณาทำรายการใหม่ หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30530.png`};break;case 30600:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"การยืนยันตัวตนไม่สำเร็จ เนื่องจากท่านได้ยกเลิกรายการยืนยันตัวตนที่โมบายแอปพลิเคชันของผู้ให้บริการยืนยันตัวตน กรุณาเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30600.png`};break;case 30610:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"การยืนยันตัวตนไม่สำเร็จ เนื่องจากท่านไม่ได้ยอมรับเงื่อนไขการให้บริการยืนยันตัวตนของผู้ให้บริการยืนยันตัวตนที่ท่านเลือก กรุณาทำรายการใหม่ หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30610.png`};break;case 30700:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"การยืนยันตัวตนไม่สำเร็จ เนื่องจากผู้ให้บริการยืนยันตัวตนที่ท่านเลือกไม่สามารถให้บริการได้ในขณะนี้ กรุณาทำรายการใหม่ หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30700.png`};break;case 30800:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ท่านยังไม่ได้ลงทะเบียนและยอมรับเงื่อนไขการใช้บริการ NDID ที่โมบายแอปพลิเคชันของผู้ให้บริการยืนยันตัวตน กรุณาดำเนินการก่อนทำรายการ",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30800.png`};break;case 30900:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ไม่สามารถทำรายการได้ในขณะนี้ เนื่องจากอยู่นอกเวลาการให้บริการของ [IdP] กรุณาเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/30900.png`};break;case 4e4:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ขออภัย ท่านไม่สามารถทำรายการได้ในขณะนี้ กรุณาทำรายการใหม่ หรือติดต่อกลับที่ “เมนูแจ้งปัญหา”",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/40000.png`};break;case 40200:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ขออภัย ไม่สามารถดำเนินการต่อได้เนื่องจากท่านใส่เลขบัตรประชาชนไม่ถูกต้อง กรุณาทำรายการใหม่อีกครั้ง",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/40200.png`};break;case 40300:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ขออภัย ไม่สามารถดำเนินการต่อได้ กรุณาติดต่อกลับที่ “เมนูแจ้งปัญหา”",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/40300.png`};break;case 40400:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ขออภัย ไม่สามารถดำเนินการต่อได้เนื่องจากข้อมูลไม่ถูกต้อง กรุณาทำรายการใหม่อีกครั้ง หรือติดต่อกลับที่ “เมนูแจ้งปัญหา”",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/40400.png`};break;case 40500:r={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ขออภัย ไม่สามารถดำเนินการต่อได้ กรุณาติดต่อกลับที่ “เมนูแจ้งปัญหา”",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/40500.png`}}yield c.ncbError(r)}if("TIMEOUT"===e.body.status){n="NCB06",e.body.response_list.length>0&&(s=yield f(e.body,a.developer_code,t)),s.push({order_code:e.body.ndid_request_id,developer_code:a.developer_code,type:"Time Out",amount:t});let i={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"กรุณาไปยืนยันตัวตนที่โมบายแอปพลิเคชั่นของผู้ให้บริการที่ท่านเลือก ภายใน 60 นาทีและกลับมาทำรายการต่อที่นี่",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/timeout.png`};yield c.ncbTimeOutAndReject(i)}if("REJECTED"===e.body.status&&(n="NCB06",e.body.response_list.length>0&&(s=yield f(e.body,a.developer_code,t)),o)){let e={line_id:o.line_id,customer_id:o.customer_id,ncb_message:"ท่านได้ปฏิเสธการยืนยันตัวตนของผู้ให้บริการยืนยันตัวตนที่ท่านเลือก กรุณาทำรายการใหม่หรือเลือกผู้ให้บริการยืนยันตัวตนรายอื่น",ncb_id:a.ncb_id,image:`${process.env.URL}/images/notification/reject.png`};yield c.ncbTimeOutAndReject(e)}"REQUESTED_ERROR"===e.body.status&&(n="NCB06");let m=_.default.omit(e.body,["reference_id","ndid_request_id"]);yield d.Master_Ncb.update((0,u.createRequest)(),{ndid_response:JSON.stringify(m),ncb_status_code:n,update_date:new Date},{reference_id:e.body.reference_id,ndid_request_id:e.body.ndid_request_id})}if(s.length>0){const e=yield(0,m.ncbStamps)(s);200!=e.status&&(yield d.Log_Api.insert((0,u.createRequest)(),{type:"outbound",method:"POST",origin:"/externals/stamps",body:JSON.stringify(s),error_message:(null==e?void 0:e.message)||"ncb stamps ไม่สำเร็จ"}))}t.status(200).send({status:200,message:"success"})}catch(e){t.status(500).send({status:500,message:"error"})}})),t.notitest=(e,t)=>r(void 0,void 0,void 0,(function*(){try{let i={line_id:e.body.line_id,email:"",ncb_id:e.body.ncb_id,customer_id:e.body.customer_id};yield c.ncbSuccess(i),t.status(200).send({status:200,message:"success"})}catch(e){t.status(500).send({status:500,message:"error"})}}))},8577:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.requestPinSchema=t.docSchema=t.selectBankSchema=t.paySchema=t.incomeSchema=t.customerLoanSchema=t.bankIdpSchema=t.ncbSchema=t.scanQrSchema=t.inquirySchema=t.mobileSchema=t.emailSchema=t.addressSchema=t.updateEmailSchema=t.pinSchema=t.registerSchema=t.checkCitizenSchema=t.consentSchema=t.validatorPin=t.compareKeys=void 0;const r=s(i(5609)),o=/([12]\d{3}\/(0[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01]))$/,d=/^[0-9]{6}$/,u=/^(?=.{6}$)(([0-9])\2?(?!\2))+$/,_=/^[0-9]{13}$/,c=/^([0]{1})??[0-9]{9}$/,l=/^[0-9]\d*$/;t.compareKeys=(e,t)=>{var i=e.sort(),n=Object.keys(t).sort();return JSON.stringify(i)===JSON.stringify(n)},t.validatorPin=e=>-1==="0123456789".indexOf(String(e))&&-1==="9876543210".indexOf(String(e)),t.consentSchema=r.object({line_id:r.string().default("").required(),is_accept:r.boolean().required().test("true","กรุณายอมรับข้อตกลง",(e=>0!=e))}).noUnknown(!0),t.checkCitizenSchema=r.object({citizen_id:r.string().matches(_,"กรุณากรอกหมายเลขบัตรประชาชนทั้งหมด 13 หลัก โดยไม่ต้องเว้นวรรคและไม่ต้องระบุเครื่องหมายขีด (-)").required(),laser_code:r.string().matches(/^([A-Z]{2})?[0-9]{10}$/,"กรุณากรอกหมายเลขและตัวอักษรหลังบัตรประชาชนทั้งหมด 12 หลัก โดยไม่ต้องเว้นวรรคและไม่ต้องระบุเครื่องหมายขีด (-)").required(),first_name:r.string().required(),last_name:r.string().required(),date_of_birth:r.string().matches(o,"birthDate must be in the format YYYY/MM/DD").required()}),t.registerSchema=r.object({line_id:r.string().required(),citizen_id:r.string().matches(_,"กรุณากรอกหมายเลขบัตรประชาชนทั้งหมด 13 หลัก โดยไม่ต้องเว้นวรรคและไม่ต้องระบุเครื่องหมายขีด (-)").required(),first_name:r.string().required(),last_name:r.string().required(),date_of_birth:r.string().matches(o,"birthDate must be in the format YYYY/MM/DD").required(),mobile_number:r.string().matches(c,"รูปแบบเบอร์โทรศัพท์ของท่านไม่ถูกต้อง กรุณากรอกเบอร์โทรศัพท์จำนวน 10 หลัก โดยขึ้นต้นด้วย 0").required(),email:r.string().email("รูปแบบ email ไม่ถูกต้อง").required(),pin:r.string().matches(u,"รหัสผ่านของท่านมีความปลอดภัยในระดับต่ำ กรุณาตั้งรหัสผ่านใหม่ตามเงื่อนไขที่กำหนด").test("true","รหัสผ่านของท่านมีความปลอดภัยในระดับต่ำ กรุณาตั้งรหัสผ่านใหม่ตามเงื่อนไขที่กำหนด",(e=>(0,t.validatorPin)(e))).required(),pin_confirm:r.string().matches(u,"รหัสผ่านของท่านมีความปลอดภัยในระดับต่ำ กรุณาตั้งรหัสผ่านใหม่ตามเงื่อนไขที่กำหนด").test("true","รหัสผ่านของท่านมีความปลอดภัยในระดับต่ำ กรุณาตั้งรหัสผ่านใหม่ตามเงื่อนไขที่กำหนด",(e=>(0,t.validatorPin)(e))).required()}),t.pinSchema=r.object({line_id:r.string().required(),pin:r.string().matches(d,"กรุณากรอกตัวเลข 6 หลัก").required(),new_pin:r.string().matches(u,"รหัสผ่านของท่านมีความปลอดภัยในระดับต่ำ กรุณาตั้งรหัสผ่านใหม่ตามเงื่อนไขที่กำหนด").test("true","รหัสผ่านของท่านมีความปลอดภัยในระดับต่ำ กรุณาตั้งรหัสผ่านใหม่ตามเงื่อนไขที่กำหนด",(e=>(0,t.validatorPin)(e))).required(),new_pin_confirm:r.string().matches(u,"รหัสผ่านของท่านมีความปลอดภัยในระดับต่ำ กรุณาตั้งรหัสผ่านใหม่ตามเงื่อนไขที่กำหนด").test("true","รหัสผ่านของท่านมีความปลอดภัยในระดับต่ำ กรุณาตั้งรหัสผ่านใหม่ตามเงื่อนไขที่กำหนด",(e=>(0,t.validatorPin)(e))).required()}),t.updateEmailSchema=r.object({line_id:r.string().required(),pin:r.string().matches(d,"กรุณากรอกตัวเลข 6 หลัก").required(),email:r.string().email("รูปแบบ email ไม่ถูกต้อง").required()}),t.addressSchema=r.object({line_id:r.string(),pin:r.string().matches(d,"กรุณากรอกตัวเลข 6 หลัก").required(),address:r.string(),village:r.string(),moo:r.string(),floor:r.string(),soi:r.string(),road:r.string(),sub_district_id:r.string().required(),district_id:r.string().required(),province_id:r.string().required(),post_code:r.string().required()}),t.emailSchema=r.object({line_id:r.string().required(),email:r.string().email("รูปแบบ email ไม่ถูกต้อง").required()}),t.mobileSchema=r.object({line_id:r.string().required(),mobile_number:r.string().matches(c,"รูปแบบเบอร์โทรศัพท์ของท่านไม่ถูกต้อง กรุณากรอกเบอร์โทรศัพท์ใหม่อีกครั้ง").required()}),t.inquirySchema=r.object({subject_id:r.number().required(),detail:r.string(),date:r.string().matches(/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/,"รูปแบบวันที่ไม่ถูกต้อง").required(),file_document:r.object()}),t.scanQrSchema=r.object({line_id:r.string().required(),data:r.string().matches(/[A-Za-zก-๙0-9.()-_]*\|[A-Za-zก-๙0-9.()-_]*\|[A-Za-zก-๙0-9.()-_]*$/,"รูปแบบของข้อมูลไม่ถูกต้อง").required()}),t.ncbSchema=r.object({ncb_type:r.string().required(),is_ncb:r.boolean().test("true","กรุณากดยอมรับข้อกำหนดและเงื่อนไขการให้บริการ",(e=>0!=e)).required(),is_ncb_terms:r.boolean().test("true","กรุณากดยอมรับข้อกำหนดและเงื่อนไขการให้บริการ",(e=>0!=e)).required(),booking_no:r.string().required(),contract_id:r.string().required(),contract_no:r.string(),project_code:r.string().required(),project_name:r.string().required(),customer_data:r.object().required()}),t.bankIdpSchema=r.object({ncb_id:r.string().required(),bank_code:r.string().required(),bank_mode:r.number().required(),pin:r.string().matches(d,"กรุณากรอกตัวเลข 6 หลัก").required()}),t.customerLoanSchema=r.object({loan_id:r.string().required(),number_of_house:r.string().matches(l,"กรุณากรอกข้อมูล ห้ามติดลบ"),number_of_debt_house:r.string().matches(l,"กรุณากรอกข้อมูล ห้ามติดลบ"),company_business_type_id:r.string(),grade_bureau_id:r.string(),welfare_id:r.string(),welfare_bank_type:r.array()}),t.incomeSchema=r.object({loan_id:r.string().required(),income:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),ot:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),commission:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),bonus:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),service_charge:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),perdiem:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),income_other_fix:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),income_other_not_fix:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),income_extra:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),income_rental:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),total_income:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable()}),t.paySchema=r.object({loan_id:r.string().required(),pay_social_insurance:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),pay_slip_tax:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),pay_slip_cooperative:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),pay_slip_other:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),pay_providentfund:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),pay_home_loan:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),pay_car_loan:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),debt_total_credit_card:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),debt_credit_card_per_month:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),debt_cash_card:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),debt_other:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable(),total_debt:r.number().min(0,"กรุณากรอกตัวเลข ห้ามติดลบ").nullable()}),t.selectBankSchema=r.object({loan_id:r.string().required(),select_bank:r.array().min(1,"กรุณาเลือกธนาคาร").required("กรุณาเลือกธนาคาร"),pin:r.string().matches(d,"กรุณากรอกตัวเลข 6 หลัก").required()}),t.docSchema=r.object({loan_id:r.string().required(),file_document:r.array()}),t.requestPinSchema=r.object({line_id:r.string().required(),last_citizen_id:r.string().matches(/^[0-9]{4}$/,"กรุณาระบุหมายเลขบัตรประชาชน 4 ตัวสุดท้าย").required()})},5600:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Log_Api=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.type=e.type,this.method=e.method,this.origin=e.origin,this.header=e.header,this.body=e.body,this.response=e.response,this.create_date=e.create_date,this.update_date=e.update_date,this.error_message=e.error_message}insert(e){return u.insert(e,{id:this.id,type:this.type,method:this.method,origin:this.origin,header:this.header,body:this.body,response:this.response,create_date:this.create_date,update_date:this.update_date,error_message:this.error_message})}update(e){return u.update(e,{id:this.id,type:this.type,method:this.method,origin:this.origin,header:this.header,body:this.body,response:this.response,create_date:this.create_date,update_date:this.update_date,error_message:this.error_message},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Log_Api=u,u.builder=new d.SqlBuilder("Log_Api",{id:{name:"Id",type:o.default.NVarChar,is_identity:!1,is_primary:!0},type:{name:"Type",type:o.default.NVarChar,is_identity:!1,is_primary:!1},method:{name:"Method",type:o.default.NVarChar,is_identity:!1,is_primary:!1},origin:{name:"Origin",type:o.default.NVarChar,is_identity:!1,is_primary:!1},header:{name:"Header",type:o.default.NVarChar,is_identity:!1,is_primary:!1},body:{name:"Body",type:o.default.NVarChar,is_identity:!1,is_primary:!1},response:{name:"Response",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},error_message:{name:"ErrorMessage",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},[],["id","type","method","origin","header","body","response","create_date","update_date","error_message"])},8574:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Log_Email=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Log_Email=u,u.builder=new d.SqlBuilder("Log_Email",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","create_date","update_date"])},6040:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Log_Loan=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Log_Loan=u,u.builder=new d.SqlBuilder("Log_Loan",{id:{name:"Id",type:o.default.Int,is_identity:!1,is_primary:!0},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},[],["id","create_date","update_date"])},5541:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Log_Ncb=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.type=e.type,this.method=e.method,this.origin=e.origin,this.header=e.header,this.body=e.body,this.response=e.response,this.create_date=e.create_date,this.update_date=e.update_date,this.error_message=e.error_message}insert(e){return u.insert(e,{id:this.id,type:this.type,method:this.method,origin:this.origin,header:this.header,body:this.body,response:this.response,create_date:this.create_date,update_date:this.update_date,error_message:this.error_message})}update(e){return u.update(e,{id:this.id,type:this.type,method:this.method,origin:this.origin,header:this.header,body:this.body,response:this.response,create_date:this.create_date,update_date:this.update_date,error_message:this.error_message},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Log_Ncb=u,u.builder=new d.SqlBuilder("Log_Ncb",{id:{name:"Id",type:o.default.NVarChar,is_identity:!1,is_primary:!0},type:{name:"Type",type:o.default.NVarChar,is_identity:!1,is_primary:!1},method:{name:"Method",type:o.default.NVarChar,is_identity:!1,is_primary:!1},origin:{name:"Origin",type:o.default.NVarChar,is_identity:!1,is_primary:!1},header:{name:"Header",type:o.default.NVarChar,is_identity:!1,is_primary:!1},body:{name:"Body",type:o.default.NVarChar,is_identity:!1,is_primary:!1},response:{name:"Response",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},error_message:{name:"ErrorMessage",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},[],["id","type","method","origin","header","body","response","create_date","update_date","error_message"])},8301:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Log_Payment=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.value=e.value,this.payment_method=e.payment_method,this.status=e.status,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,value:this.value,payment_method:this.payment_method,status:this.status,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,value:this.value,payment_method:this.payment_method,status:this.status,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Log_Payment=u,u.builder=new d.SqlBuilder("Log_Payment",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},value:{name:"Value",type:o.default.Text,is_identity:!1,is_primary:!1},payment_method:{name:"Payment_Method",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","value","payment_method","status","create_date","update_date"])},1221:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Log_Sms=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.type=e.type,this.body=e.body,this.error_message=e.error_message,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,type:this.type,body:this.body,error_message:this.error_message,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,type:this.type,body:this.body,error_message:this.error_message,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Log_Sms=u,u.builder=new d.SqlBuilder("Log_Sms",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},type:{name:"Type",type:o.default.NVarChar,is_identity:!1,is_primary:!1},body:{name:"Body",type:o.default.NVarChar,is_identity:!1,is_primary:!1},error_message:{name:"ErrorMessage",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","type","body","error_message","create_date","update_date"])},4003:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Mapping_Customer_Register=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.line_id=e.line_id,this.line_name=e.line_name,this.customer_id=e.customer_id,this.pin=e.pin,this.status=e.status,this.is_accept=e.is_accept,this.count_wrong_pin=e.count_wrong_pin,this.expied_date_blocked_pin=e.expied_date_blocked_pin,this.blocked_minutes=e.blocked_minutes,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,line_id:this.line_id,line_name:this.line_name,customer_id:this.customer_id,pin:this.pin,status:this.status,is_accept:this.is_accept,count_wrong_pin:this.count_wrong_pin,expied_date_blocked_pin:this.expied_date_blocked_pin,blocked_minutes:this.blocked_minutes,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,line_id:this.line_id,line_name:this.line_name,customer_id:this.customer_id,pin:this.pin,status:this.status,is_accept:this.is_accept,count_wrong_pin:this.count_wrong_pin,expied_date_blocked_pin:this.expied_date_blocked_pin,blocked_minutes:this.blocked_minutes,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Mapping_Customer_Register=u,u.builder=new d.SqlBuilder("Mapping_Customer_Register",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},line_id:{name:"LineId",type:o.default.NVarChar,is_identity:!1,is_primary:!0},line_name:{name:"LineName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},pin:{name:"Pin",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},is_accept:{name:"IsAccept",type:o.default.Bit,is_identity:!1,is_primary:!1},count_wrong_pin:{name:"CountWrongPin",type:o.default.Int,is_identity:!1,is_primary:!1},expied_date_blocked_pin:{name:"ExpiedDateBlockedPin",type:o.default.DateTime,is_identity:!1,is_primary:!1},blocked_minutes:{name:"BlockedMinutes",type:o.default.Int,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","line_id","line_name","customer_id","pin","status","is_accept","count_wrong_pin","expied_date_blocked_pin","blocked_minutes","create_date","update_date"])},7407:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Mapping_Customer_Reserve=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.prefix_id=e.prefix_id,this.first_name=e.first_name,this.last_name=e.last_name,this.married_status_id=e.married_status_id,this.mobile_number=e.mobile_number,this.email=e.email,this.ref_customer_id=e.ref_customer_id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,prefix_id:this.prefix_id,first_name:this.first_name,last_name:this.last_name,married_status_id:this.married_status_id,mobile_number:this.mobile_number,email:this.email,ref_customer_id:this.ref_customer_id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,prefix_id:this.prefix_id,first_name:this.first_name,last_name:this.last_name,married_status_id:this.married_status_id,mobile_number:this.mobile_number,email:this.email,ref_customer_id:this.ref_customer_id,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Mapping_Customer_Reserve=u,u.builder=new d.SqlBuilder("Mapping_Customer_Reserve",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},prefix_id:{name:"PrefixId",type:o.default.Int,is_identity:!1,is_primary:!1},first_name:{name:"FirstName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},last_name:{name:"LastName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},married_status_id:{name:"MarriedStatusId",type:o.default.Int,is_identity:!1,is_primary:!1},mobile_number:{name:"MobileNumber",type:o.default.NVarChar,is_identity:!1,is_primary:!1},email:{name:"Email",type:o.default.NVarChar,is_identity:!1,is_primary:!1},ref_customer_id:{name:"RefCustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","prefix_id","first_name","last_name","married_status_id","mobile_number","email","ref_customer_id","create_date","update_date"])},3190:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Mapping_Customer_Unit=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.unit_id=e.unit_id,this.customer_id=e.customer_id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,unit_id:this.unit_id,customer_id:this.customer_id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,unit_id:this.unit_id,customer_id:this.customer_id,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Mapping_Customer_Unit=u,u.builder=new d.SqlBuilder("Mapping_Customer_Unit",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},unit_id:{name:"UnitId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","unit_id","customer_id","create_date","update_date"])},5199:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Mapping_Loan=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.loan_id=e.loan_id,this.customer_id=e.customer_id,this.type_of_borrower=e.type_of_borrower,this.seq_of_borrower=e.seq_of_borrower,this.relation_with_borrower=e.relation_with_borrower,this.customer_address=e.customer_address,this.customer_data=e.customer_data,this.mobile_number=e.mobile_number,this.email=e.email,this.status=e.status,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,loan_id:this.loan_id,customer_id:this.customer_id,type_of_borrower:this.type_of_borrower,seq_of_borrower:this.seq_of_borrower,relation_with_borrower:this.relation_with_borrower,customer_address:this.customer_address,customer_data:this.customer_data,mobile_number:this.mobile_number,email:this.email,status:this.status,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,loan_id:this.loan_id,customer_id:this.customer_id,type_of_borrower:this.type_of_borrower,seq_of_borrower:this.seq_of_borrower,relation_with_borrower:this.relation_with_borrower,customer_address:this.customer_address,customer_data:this.customer_data,mobile_number:this.mobile_number,email:this.email,status:this.status,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Mapping_Loan=u,u.builder=new d.SqlBuilder("Mapping_Loan",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},loan_id:{name:"LoanId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},type_of_borrower:{name:"TypeOfBorrower",type:o.default.NVarChar,is_identity:!1,is_primary:!1},seq_of_borrower:{name:"SeqOfBorrower",type:o.default.Int,is_identity:!1,is_primary:!1},relation_with_borrower:{name:"RelationWithBorrower",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_address:{name:"CustomerAddress",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_data:{name:"CustomerData",type:o.default.NVarChar,is_identity:!1,is_primary:!1},mobile_number:{name:"MobileNumber",type:o.default.NVarChar,is_identity:!1,is_primary:!1},email:{name:"Email",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","loan_id","customer_id","type_of_borrower","seq_of_borrower","relation_with_borrower","customer_address","customer_data","mobile_number","email","status","create_date","update_date"])},2363:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Mapping_Loan_Bank=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.loan_id=e.loan_id,this.bank_code=e.bank_code,this.customer_id=e.customer_id,this.is_select_bank=e.is_select_bank,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,loan_id:this.loan_id,bank_code:this.bank_code,customer_id:this.customer_id,is_select_bank:this.is_select_bank,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,loan_id:this.loan_id,bank_code:this.bank_code,customer_id:this.customer_id,is_select_bank:this.is_select_bank,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Mapping_Loan_Bank=u,u.builder=new d.SqlBuilder("Mapping_Loan_Bank",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},loan_id:{name:"LoanId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},bank_code:{name:"BankCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},is_select_bank:{name:"IsSelectBank",type:o.default.Bit,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","loan_id","bank_code","customer_id","is_select_bank","create_date","update_date"])},58:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Bank=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.bank_code=e.bank_code,this.name=e.name,this.name_eng=e.name_eng,this.bank_logo=e.bank_logo,this.status=e.status}insert(e){return u.insert(e,{id:this.id,bank_code:this.bank_code,name:this.name,name_eng:this.name_eng,bank_logo:this.bank_logo,status:this.status})}update(e){return u.update(e,{id:this.id,bank_code:this.bank_code,name:this.name,name_eng:this.name_eng,bank_logo:this.bank_logo,status:this.status},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Bank=u,u.builder=new d.SqlBuilder("Master_Bank",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},bank_code:{name:"BankCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name:{name:"Name",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},bank_logo:{name:"BankLogo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","bank_code","name","name_eng","bank_logo","status"])},1138:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Bank_Status=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.code=e.code,this.name=e.name,this.group_id=e.group_id}insert(e){return u.insert(e,{id:this.id,code:this.code,name:this.name,group_id:this.group_id})}update(e){return u.update(e,{id:this.id,code:this.code,name:this.name,group_id:this.group_id},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Bank_Status=u,u.builder=new d.SqlBuilder("Master_Bank_Status",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},code:{name:"Code",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name:{name:"Name",type:o.default.NVarChar,is_identity:!1,is_primary:!1},group_id:{name:"GroupId",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","code","name","group_id"])},942:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Bareau=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Bareau=u,u.builder=new d.SqlBuilder("Master_Bareau",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","create_date","update_date"])},9692:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Business=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.create_date=e.create_date,this.update_date=e.update_date,this.rem_code=e.rem_code}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date,rem_code:this.rem_code})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date,rem_code:this.rem_code},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Business=u,u.builder=new d.SqlBuilder("Master_Business",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},rem_code:{name:"RemCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","create_date","update_date","rem_code"])},5129:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Customer=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("customer_id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{customer_id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.customer_id=e.customer_id,this.customer_id_rem=e.customer_id_rem,this.member_id=e.member_id,this.prefix_id=e.prefix_id,this.prefix_id_eng=e.prefix_id_eng,this.first_name=e.first_name,this.middle_name=e.middle_name,this.last_name=e.last_name,this.first_name_eng=e.first_name_eng,this.middle_name_eng=e.middle_name_eng,this.last_name_eng=e.last_name_eng,this.date_of_birth=e.date_of_birth,this.nick_name=e.nick_name,this.gender_code=e.gender_code,this.married_status_id=e.married_status_id,this.age=e.age,this.customer_type=e.customer_type,this.nationality_id=e.nationality_id,this.race_id=e.race_id,this.ref_code=e.ref_code,this.citizen_id=e.citizen_id,this.authority=e.authority,this.citizen_date_of_issue=e.citizen_date_of_issue,this.citizen_date_of_expiry=e.citizen_date_of_expiry,this.passport_no=e.passport_no,this.passport_country=e.passport_country,this.mobile_number=e.mobile_number,this.phone_number=e.phone_number,this.inter_number=e.inter_number,this.email=e.email,this.facebook=e.facebook,this.customer_line_id=e.customer_line_id,this.we_chat=e.we_chat,this.whats_app=e.whats_app,this.occupation_id=e.occupation_id,this.company_name=e.company_name,this.position=e.position,this.work_number=e.work_number,this.education_id=e.education_id,this.first_job_start_date=e.first_job_start_date,this.current_job_start_date=e.current_job_start_date,this.is_accept=e.is_accept,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,customer_id:this.customer_id,customer_id_rem:this.customer_id_rem,member_id:this.member_id,prefix_id:this.prefix_id,prefix_id_eng:this.prefix_id_eng,first_name:this.first_name,middle_name:this.middle_name,last_name:this.last_name,first_name_eng:this.first_name_eng,middle_name_eng:this.middle_name_eng,last_name_eng:this.last_name_eng,date_of_birth:this.date_of_birth,nick_name:this.nick_name,gender_code:this.gender_code,married_status_id:this.married_status_id,age:this.age,customer_type:this.customer_type,nationality_id:this.nationality_id,race_id:this.race_id,ref_code:this.ref_code,citizen_id:this.citizen_id,authority:this.authority,citizen_date_of_issue:this.citizen_date_of_issue,citizen_date_of_expiry:this.citizen_date_of_expiry,passport_no:this.passport_no,passport_country:this.passport_country,mobile_number:this.mobile_number,phone_number:this.phone_number,inter_number:this.inter_number,email:this.email,facebook:this.facebook,customer_line_id:this.customer_line_id,we_chat:this.we_chat,whats_app:this.whats_app,occupation_id:this.occupation_id,company_name:this.company_name,position:this.position,work_number:this.work_number,education_id:this.education_id,first_job_start_date:this.first_job_start_date,current_job_start_date:this.current_job_start_date,is_accept:this.is_accept,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,customer_id:this.customer_id,customer_id_rem:this.customer_id_rem,member_id:this.member_id,prefix_id:this.prefix_id,prefix_id_eng:this.prefix_id_eng,first_name:this.first_name,middle_name:this.middle_name,last_name:this.last_name,first_name_eng:this.first_name_eng,middle_name_eng:this.middle_name_eng,last_name_eng:this.last_name_eng,date_of_birth:this.date_of_birth,nick_name:this.nick_name,gender_code:this.gender_code,married_status_id:this.married_status_id,age:this.age,customer_type:this.customer_type,nationality_id:this.nationality_id,race_id:this.race_id,ref_code:this.ref_code,citizen_id:this.citizen_id,authority:this.authority,citizen_date_of_issue:this.citizen_date_of_issue,citizen_date_of_expiry:this.citizen_date_of_expiry,passport_no:this.passport_no,passport_country:this.passport_country,mobile_number:this.mobile_number,phone_number:this.phone_number,inter_number:this.inter_number,email:this.email,facebook:this.facebook,customer_line_id:this.customer_line_id,we_chat:this.we_chat,whats_app:this.whats_app,occupation_id:this.occupation_id,company_name:this.company_name,position:this.position,work_number:this.work_number,education_id:this.education_id,first_job_start_date:this.first_job_start_date,current_job_start_date:this.current_job_start_date,is_accept:this.is_accept,create_date:this.create_date,update_date:this.update_date},{customer_id:this.customer_id})}delete(e,t){return u.delete(e,{customer_id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Customer=u,u.builder=new d.SqlBuilder("Master_Customer",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!0},customer_id_rem:{name:"CustomerIdRem",type:o.default.NVarChar,is_identity:!1,is_primary:!1},member_id:{name:"MemberId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},prefix_id:{name:"PrefixId",type:o.default.Int,is_identity:!1,is_primary:!1},prefix_id_eng:{name:"PrefixIdEng",type:o.default.Int,is_identity:!1,is_primary:!1},first_name:{name:"FirstName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},middle_name:{name:"MiddleName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},last_name:{name:"LastName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},first_name_eng:{name:"FirstNameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},middle_name_eng:{name:"MiddleNameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},last_name_eng:{name:"LastNameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},date_of_birth:{name:"DateOfBirth",type:o.default.NVarChar,is_identity:!1,is_primary:!1},nick_name:{name:"NickName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},gender_code:{name:"GenderCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},married_status_id:{name:"MarriedStatusId",type:o.default.Int,is_identity:!1,is_primary:!1},age:{name:"Age",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_type:{name:"CustomerType",type:o.default.NVarChar,is_identity:!1,is_primary:!1},nationality_id:{name:"NationalityId",type:o.default.Int,is_identity:!1,is_primary:!1},race_id:{name:"RaceId",type:o.default.Int,is_identity:!1,is_primary:!1},ref_code:{name:"RefCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},citizen_id:{name:"CitizenId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},authority:{name:"Authority",type:o.default.NVarChar,is_identity:!1,is_primary:!1},citizen_date_of_issue:{name:"CitizenDateOfIssue",type:o.default.NVarChar,is_identity:!1,is_primary:!1},citizen_date_of_expiry:{name:"CitizenDateOfExpiry",type:o.default.NVarChar,is_identity:!1,is_primary:!1},passport_no:{name:"PassportNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},passport_country:{name:"PassportCountry",type:o.default.NVarChar,is_identity:!1,is_primary:!1},mobile_number:{name:"MobileNumber",type:o.default.NVarChar,is_identity:!1,is_primary:!1},phone_number:{name:"PhoneNumber",type:o.default.NVarChar,is_identity:!1,is_primary:!1},inter_number:{name:"InterNumber",type:o.default.NVarChar,is_identity:!1,is_primary:!1},email:{name:"Email",type:o.default.NVarChar,is_identity:!1,is_primary:!1},facebook:{name:"Facebook",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_line_id:{name:"CustomerLineId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},we_chat:{name:"WeChat",type:o.default.NVarChar,is_identity:!1,is_primary:!1},whats_app:{name:"WhatsApp",type:o.default.NVarChar,is_identity:!1,is_primary:!1},occupation_id:{name:"OccupationId",type:o.default.Int,is_identity:!1,is_primary:!1},company_name:{name:"CompanyName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},position:{name:"Position",type:o.default.NVarChar,is_identity:!1,is_primary:!1},work_number:{name:"WorkNumber",type:o.default.NVarChar,is_identity:!1,is_primary:!1},education_id:{name:"EducationId",type:o.default.Int,is_identity:!1,is_primary:!1},first_job_start_date:{name:"FirstJobStartDate",type:o.default.NVarChar,is_identity:!1,is_primary:!1},current_job_start_date:{name:"CurrentJobStartDate",type:o.default.NVarChar,is_identity:!1,is_primary:!1},is_accept:{name:"IsAccept",type:o.default.Bit,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","customer_id","customer_id_rem","member_id","prefix_id","prefix_id_eng","first_name","middle_name","last_name","first_name_eng","middle_name_eng","last_name_eng","date_of_birth","nick_name","gender_code","married_status_id","age","customer_type","nationality_id","race_id","ref_code","citizen_id","authority","citizen_date_of_issue","citizen_date_of_expiry","passport_no","passport_country","mobile_number","phone_number","inter_number","email","facebook","customer_line_id","we_chat","whats_app","occupation_id","company_name","position","work_number","education_id","first_job_start_date","current_job_start_date","is_accept","create_date","update_date"])},3051:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Customer_Address=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.customer_id=e.customer_id,this.address_type=e.address_type,this.address_type_name=e.address_type_name,this.address=e.address,this.moo=e.moo,this.village=e.village,this.floor=e.floor,this.soi=e.soi,this.road=e.road,this.sub_district_id=e.sub_district_id,this.sub_district_name=e.sub_district_name,this.district_id=e.district_id,this.district_name=e.district_name,this.province_id=e.province_id,this.province_name=e.province_name,this.post_code=e.post_code,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,customer_id:this.customer_id,address_type:this.address_type,address_type_name:this.address_type_name,address:this.address,moo:this.moo,village:this.village,floor:this.floor,soi:this.soi,road:this.road,sub_district_id:this.sub_district_id,sub_district_name:this.sub_district_name,district_id:this.district_id,district_name:this.district_name,province_id:this.province_id,province_name:this.province_name,post_code:this.post_code,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,customer_id:this.customer_id,address_type:this.address_type,address_type_name:this.address_type_name,address:this.address,moo:this.moo,village:this.village,floor:this.floor,soi:this.soi,road:this.road,sub_district_id:this.sub_district_id,sub_district_name:this.sub_district_name,district_id:this.district_id,district_name:this.district_name,province_id:this.province_id,province_name:this.province_name,post_code:this.post_code,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Customer_Address=u,u.builder=new d.SqlBuilder("Master_Customer_Address",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},address_type:{name:"AddressType",type:o.default.Int,is_identity:!1,is_primary:!1},address_type_name:{name:"AddressTypeName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},address:{name:"Address",type:o.default.NVarChar,is_identity:!1,is_primary:!1},moo:{name:"Moo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},village:{name:"Village",type:o.default.NVarChar,is_identity:!1,is_primary:!1},floor:{name:"Floor",type:o.default.NVarChar,is_identity:!1,is_primary:!1},soi:{name:"Soi",type:o.default.NVarChar,is_identity:!1,is_primary:!1},road:{name:"Road",type:o.default.NVarChar,is_identity:!1,is_primary:!1},sub_district_id:{name:"SubDistrictId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},sub_district_name:{name:"SubDistrictName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},district_id:{name:"DistrictId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},district_name:{name:"DistrictName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},province_id:{name:"ProvinceId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},province_name:{name:"ProvinceName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},post_code:{name:"PostCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","customer_id","address_type","address_type_name","address","moo","village","floor","soi","road","sub_district_id","sub_district_name","district_id","district_name","province_id","province_name","post_code","create_date","update_date"])},9604:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Customer_Loan=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.number_of_house=e.number_of_house,this.number_of_debt_house=e.number_of_debt_house,this.company_business_type_id=e.company_business_type_id,this.company_business_type_name=e.company_business_type_name,this.grade_bureau_id=e.grade_bureau_id,this.grade_bureau_name=e.grade_bureau_name,this.welfare_id=e.welfare_id,this.welfare_name=e.welfare_name,this.welfare_bank_type=e.welfare_bank_type,this.income=e.income,this.ot=e.ot,this.commission=e.commission,this.bonus=e.bonus,this.service_charge=e.service_charge,this.perdiem=e.perdiem,this.income_other_fix=e.income_other_fix,this.income_other_not_fix=e.income_other_not_fix,this.income_extra=e.income_extra,this.income_rental=e.income_rental,this.total_income=e.total_income,this.pay_social_insurance=e.pay_social_insurance,this.pay_slip_tax=e.pay_slip_tax,this.pay_slip_cooperative=e.pay_slip_cooperative,this.pay_slip_other=e.pay_slip_other,this.pay_providentfund=e.pay_providentfund,this.pay_home_loan=e.pay_home_loan,this.pay_car_loan=e.pay_car_loan,this.debt_total_credit_card=e.debt_total_credit_card,this.debt_credit_card_per_month=e.debt_credit_card_per_month,this.debt_cash_card=e.debt_cash_card,this.debt_other=e.debt_other,this.total_debt=e.total_debt,this.customer_id=e.customer_id,this.loan_id=e.loan_id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,number_of_house:this.number_of_house,number_of_debt_house:this.number_of_debt_house,company_business_type_id:this.company_business_type_id,company_business_type_name:this.company_business_type_name,grade_bureau_id:this.grade_bureau_id,grade_bureau_name:this.grade_bureau_name,welfare_id:this.welfare_id,welfare_name:this.welfare_name,welfare_bank_type:this.welfare_bank_type,income:this.income,ot:this.ot,commission:this.commission,bonus:this.bonus,service_charge:this.service_charge,perdiem:this.perdiem,income_other_fix:this.income_other_fix,income_other_not_fix:this.income_other_not_fix,income_extra:this.income_extra,income_rental:this.income_rental,total_income:this.total_income,pay_social_insurance:this.pay_social_insurance,pay_slip_tax:this.pay_slip_tax,pay_slip_cooperative:this.pay_slip_cooperative,pay_slip_other:this.pay_slip_other,pay_providentfund:this.pay_providentfund,pay_home_loan:this.pay_home_loan,pay_car_loan:this.pay_car_loan,debt_total_credit_card:this.debt_total_credit_card,debt_credit_card_per_month:this.debt_credit_card_per_month,debt_cash_card:this.debt_cash_card,debt_other:this.debt_other,total_debt:this.total_debt,customer_id:this.customer_id,loan_id:this.loan_id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,number_of_house:this.number_of_house,number_of_debt_house:this.number_of_debt_house,company_business_type_id:this.company_business_type_id,company_business_type_name:this.company_business_type_name,grade_bureau_id:this.grade_bureau_id,grade_bureau_name:this.grade_bureau_name,welfare_id:this.welfare_id,welfare_name:this.welfare_name,welfare_bank_type:this.welfare_bank_type,income:this.income,ot:this.ot,commission:this.commission,bonus:this.bonus,service_charge:this.service_charge,perdiem:this.perdiem,income_other_fix:this.income_other_fix,income_other_not_fix:this.income_other_not_fix,income_extra:this.income_extra,income_rental:this.income_rental,total_income:this.total_income,pay_social_insurance:this.pay_social_insurance,pay_slip_tax:this.pay_slip_tax,pay_slip_cooperative:this.pay_slip_cooperative,pay_slip_other:this.pay_slip_other,pay_providentfund:this.pay_providentfund,pay_home_loan:this.pay_home_loan,pay_car_loan:this.pay_car_loan,debt_total_credit_card:this.debt_total_credit_card,debt_credit_card_per_month:this.debt_credit_card_per_month,debt_cash_card:this.debt_cash_card,debt_other:this.debt_other,total_debt:this.total_debt,customer_id:this.customer_id,loan_id:this.loan_id,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Customer_Loan=u,u.builder=new d.SqlBuilder("Master_Customer_Loan",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},number_of_house:{name:"NumberOfHouse",type:o.default.NVarChar,is_identity:!1,is_primary:!1},number_of_debt_house:{name:"NumberOfDebtHouse",type:o.default.NVarChar,is_identity:!1,is_primary:!1},company_business_type_id:{name:"CompanyBusinessTypeId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},company_business_type_name:{name:"CompanyBusinessTypeName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},grade_bureau_id:{name:"GradeBureauId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},grade_bureau_name:{name:"GradeBureauName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},welfare_id:{name:"WelfareId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},welfare_name:{name:"WelfareName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},welfare_bank_type:{name:"WelfareBankType",type:o.default.NVarChar,is_identity:!1,is_primary:!1},income:{name:"Income",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},ot:{name:"Ot",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},commission:{name:"Commission",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},bonus:{name:"Bonus",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},service_charge:{name:"ServiceCharge",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},perdiem:{name:"Perdiem",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},income_other_fix:{name:"IncomeOtherFix",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},income_other_not_fix:{name:"IncomeOtherNotFix",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},income_extra:{name:"IncomeExtra",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},income_rental:{name:"IncomeRental",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},total_income:{name:"TotalIncome",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},pay_social_insurance:{name:"PaySocialInsurance",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},pay_slip_tax:{name:"PaySlipTax",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},pay_slip_cooperative:{name:"PaySlipCooperative",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},pay_slip_other:{name:"PaySlipOther",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},pay_providentfund:{name:"PayProvidentfund",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},pay_home_loan:{name:"PayHomeLoan",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},pay_car_loan:{name:"PayCarLoan",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},debt_total_credit_card:{name:"DebtTotalCreditCard",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},debt_credit_card_per_month:{name:"DebtCreditCardPerMonth",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},debt_cash_card:{name:"DebtCashCard",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},debt_other:{name:"DebtOther",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},total_debt:{name:"TotalDebt",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},loan_id:{name:"LoanId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","number_of_house","number_of_debt_house","company_business_type_id","company_business_type_name","grade_bureau_id","grade_bureau_name","welfare_id","welfare_name","welfare_bank_type","income","ot","commission","bonus","service_charge","perdiem","income_other_fix","income_other_not_fix","income_extra","income_rental","total_income","pay_social_insurance","pay_slip_tax","pay_slip_cooperative","pay_slip_other","pay_providentfund","pay_home_loan","pay_car_loan","debt_total_credit_card","debt_credit_card_per_month","debt_cash_card","debt_other","total_debt","customer_id","loan_id","create_date","update_date"])},5591:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Developer=void 0;const s=a(i(9424)),r=i(622);class o{constructor(e){null!=e&&this.loadByData(e)}loadByData(e){this.id=e.id,this.developer_code=e.developer_code,this.developer_name=e.developer_name,this.developer_image_url=e.developer_image_url,this.url_api=e.url_api,this.header_api=e.header_api,this.is_active=e.is_active,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return o.insert(e,{id:this.id,developer_code:this.developer_code,developer_name:this.developer_name,developer_image_url:this.developer_image_url,url_api:this.url_api,header_api:this.header_api,is_active:this.is_active,create_date:this.create_date,update_date:this.update_date})}static find(e,t){return n(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new o(e)))}))}static findOne(e,t){return n(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new o(i)}))}static count(e,t){return n(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Developer=o,o.builder=new r.SqlBuilder("Master_Developer",{id:{name:"Id",type:s.default.Int,is_identity:!1,is_primary:!1},developer_code:{name:"DeveloperCode",type:s.default.NVarChar,is_identity:!1,is_primary:!1},developer_name:{name:"DeveloperName",type:s.default.NVarChar,is_identity:!1,is_primary:!1},developer_image_url:{name:"DeveloperImageUrl",type:s.default.NVarChar,is_identity:!1,is_primary:!1},url_api:{name:"UrlApi",type:s.default.NVarChar,is_identity:!1,is_primary:!1},header_api:{name:"HeaderApi",type:s.default.NVarChar,is_identity:!1,is_primary:!1},is_active:{name:"IsActive",type:s.default.Int,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:s.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:s.default.DateTime,is_identity:!1,is_primary:!1}},[],["id","developer_code","developer_name","developer_image_url","url_api","header_api","is_active","create_date","update_date"])},6264:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_District=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("district_id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{district_id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.district_id=e.district_id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.province_id=e.province_id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,district_id:this.district_id,name_th:this.name_th,name_eng:this.name_eng,province_id:this.province_id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,district_id:this.district_id,name_th:this.name_th,name_eng:this.name_eng,province_id:this.province_id,create_date:this.create_date,update_date:this.update_date},{district_id:this.district_id})}delete(e,t){return u.delete(e,{district_id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_District=u,u.builder=new d.SqlBuilder("Master_District",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!1},district_id:{name:"DistrictId",type:o.default.NVarChar,is_identity:!1,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},province_id:{name:"ProvinceId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","district_id","name_th","name_eng","province_id","create_date","update_date"])},3930:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Education=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Education=u,u.builder=new d.SqlBuilder("Master_Education",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","create_date","update_date"])},6920:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_File=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.ref_id=e.ref_id,this.ref_type=e.ref_type,this.group_type=e.group_type,this.file_path=e.file_path,this.file_name=e.file_name,this.file_size=e.file_size,this.file_extension=e.file_extension,this.file_type=e.file_type,this.status=e.status,this.remark_th=e.remark_th,this.remark_eng=e.remark_eng,this.description_th=e.description_th,this.description_eng=e.description_eng,this.customer_id=e.customer_id,this.sort_id=e.sort_id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,ref_id:this.ref_id,ref_type:this.ref_type,group_type:this.group_type,file_path:this.file_path,file_name:this.file_name,file_size:this.file_size,file_extension:this.file_extension,file_type:this.file_type,status:this.status,remark_th:this.remark_th,remark_eng:this.remark_eng,description_th:this.description_th,description_eng:this.description_eng,customer_id:this.customer_id,sort_id:this.sort_id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,ref_id:this.ref_id,ref_type:this.ref_type,group_type:this.group_type,file_path:this.file_path,file_name:this.file_name,file_size:this.file_size,file_extension:this.file_extension,file_type:this.file_type,status:this.status,remark_th:this.remark_th,remark_eng:this.remark_eng,description_th:this.description_th,description_eng:this.description_eng,customer_id:this.customer_id,sort_id:this.sort_id,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_File=u,u.builder=new d.SqlBuilder("Master_File",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},ref_id:{name:"RefId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},ref_type:{name:"RefType",type:o.default.NVarChar,is_identity:!1,is_primary:!1},group_type:{name:"GroupType",type:o.default.NVarChar,is_identity:!1,is_primary:!1},file_path:{name:"FilePath",type:o.default.NVarChar,is_identity:!1,is_primary:!1},file_name:{name:"FileName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},file_size:{name:"FileSize",type:o.default.BigInt,is_identity:!1,is_primary:!1},file_extension:{name:"FileExtension",type:o.default.NVarChar,is_identity:!1,is_primary:!1},file_type:{name:"FileType",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},remark_th:{name:"RemarkTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},remark_eng:{name:"RemarkEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},description_th:{name:"DescriptionTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},description_eng:{name:"DescriptionEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},sort_id:{name:"SortId",type:o.default.Int,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","ref_id","ref_type","group_type","file_path","file_name","file_size","file_extension","file_type","status","remark_th","remark_eng","description_th","description_eng","customer_id","sort_id","create_date","update_date"])},7276:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Gender=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.rem_code=e.rem_code,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Gender=u,u.builder=new d.SqlBuilder("Master_Gender",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},rem_code:{name:"RemCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","rem_code","create_date","update_date"])},304:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Idp=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.idp_id=e.idp_id,this.name=e.name,this.name_eng=e.name_eng,this.idp_logo=e.idp_logo,this.status=e.status}insert(e){return u.insert(e,{id:this.id,idp_id:this.idp_id,name:this.name,name_eng:this.name_eng,idp_logo:this.idp_logo,status:this.status})}update(e){return u.update(e,{id:this.id,idp_id:this.idp_id,name:this.name,name_eng:this.name_eng,idp_logo:this.idp_logo,status:this.status},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Idp=u,u.builder=new d.SqlBuilder("Master_Idp",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},idp_id:{name:"IdpId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name:{name:"Name",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},idp_logo:{name:"IdpLogo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","idp_id","name","name_eng","idp_logo","status"])},8522:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Loan=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.loan_id=e.loan_id,this.booking_no=e.booking_no,this.contract_id=e.contract_id,this.contract_no=e.contract_no,this.unit_id=e.unit_id,this.project_code=e.project_code,this.developer_code=e.developer_code,this.total_collateral_price=e.total_collateral_price,this.request_amt=e.request_amt,this.down_payment=e.down_payment,this.book_amount=e.book_amount,this.approve_date=e.approve_date,this.book_date=e.book_date,this.status=e.status,this.sale_name=e.sale_name,this.sale_email=e.sale_email,this.count_borrowers=e.count_borrowers,this.is_credit_out=e.is_credit_out,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,loan_id:this.loan_id,booking_no:this.booking_no,contract_id:this.contract_id,contract_no:this.contract_no,unit_id:this.unit_id,project_code:this.project_code,developer_code:this.developer_code,total_collateral_price:this.total_collateral_price,request_amt:this.request_amt,down_payment:this.down_payment,book_amount:this.book_amount,approve_date:this.approve_date,book_date:this.book_date,status:this.status,sale_name:this.sale_name,sale_email:this.sale_email,count_borrowers:this.count_borrowers,is_credit_out:this.is_credit_out,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,loan_id:this.loan_id,booking_no:this.booking_no,contract_id:this.contract_id,contract_no:this.contract_no,unit_id:this.unit_id,project_code:this.project_code,developer_code:this.developer_code,total_collateral_price:this.total_collateral_price,request_amt:this.request_amt,down_payment:this.down_payment,book_amount:this.book_amount,approve_date:this.approve_date,book_date:this.book_date,status:this.status,sale_name:this.sale_name,sale_email:this.sale_email,count_borrowers:this.count_borrowers,is_credit_out:this.is_credit_out,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Loan=u,u.builder=new d.SqlBuilder("Master_Loan",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},loan_id:{name:"LoanId",type:o.default.NVarChar,is_identity:!1,is_primary:!0},booking_no:{name:"BookingNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},contract_id:{name:"ContractId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},contract_no:{name:"ContractNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},unit_id:{name:"UnitId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},project_code:{name:"ProjectCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},developer_code:{name:"DeveloperCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},total_collateral_price:{name:"TotalCollateralPrice",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},request_amt:{name:"RequestAmt",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},down_payment:{name:"DownPayment",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},book_amount:{name:"BookAmount",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},approve_date:{name:"ApproveDate",type:o.default.NVarChar,is_identity:!1,is_primary:!1},book_date:{name:"BookDate",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},sale_name:{name:"SaleName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},sale_email:{name:"SaleEmail",type:o.default.NVarChar,is_identity:!1,is_primary:!1},count_borrowers:{name:"CountBorrowers",type:o.default.Int,is_identity:!1,is_primary:!1},is_credit_out:{name:"IsCreditOut",type:o.default.Bit,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","loan_id","booking_no","contract_id","contract_no","unit_id","project_code","developer_code","total_collateral_price","request_amt","down_payment","book_amount","approve_date","book_date","status","sale_name","sale_email","count_borrowers","is_credit_out","create_date","update_date"])},2474:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Married_Status=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Married_Status=u,u.builder=new d.SqlBuilder("Master_Married_Status",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","create_date","update_date"])},2681:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Melfare=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Melfare=u,u.builder=new d.SqlBuilder("Master_Melfare",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","create_date","update_date"])},7914:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Nationlity=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.seq=e.seq,this.rem_code=e.rem_code,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,seq:this.seq,rem_code:this.rem_code,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,seq:this.seq,rem_code:this.rem_code,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Nationlity=u,u.builder=new d.SqlBuilder("Master_Nationlity",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},seq:{name:"Seq",type:o.default.Int,is_identity:!1,is_primary:!1},rem_code:{name:"RemCode",type:o.default.Int,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","seq","rem_code","create_date","update_date"])},1751:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Ncb=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.ncb_id=e.ncb_id,this.is_ncb=e.is_ncb,this.is_ncb_terms=e.is_ncb_terms,this.ncb_status_code=e.ncb_status_code,this.ncb_type=e.ncb_type,this.ncb_count=e.ncb_count,this.bank_code=e.bank_code,this.bank_mode=e.bank_mode,this.reference_id=e.reference_id,this.ndid_request_id=e.ndid_request_id,this.ndid_response=e.ndid_response,this.customer_id=e.customer_id,this.booking_no=e.booking_no,this.contract_id=e.contract_id,this.contract_no=e.contract_no,this.project_code=e.project_code,this.project_name=e.project_name,this.unit_id=e.unit_id,this.create_date=e.create_date,this.update_date=e.update_date,this.ncb_date_of_expiry=e.ncb_date_of_expiry,this.ndid_reference=e.ndid_reference,this.icon_reference_ndid=e.icon_reference_ndid,this.request_params=e.request_params}insert(e){return u.insert(e,{id:this.id,ncb_id:this.ncb_id,is_ncb:this.is_ncb,is_ncb_terms:this.is_ncb_terms,ncb_status_code:this.ncb_status_code,ncb_type:this.ncb_type,ncb_count:this.ncb_count,bank_code:this.bank_code,bank_mode:this.bank_mode,reference_id:this.reference_id,ndid_request_id:this.ndid_request_id,ndid_response:this.ndid_response,customer_id:this.customer_id,booking_no:this.booking_no,contract_id:this.contract_id,contract_no:this.contract_no,project_code:this.project_code,project_name:this.project_name,unit_id:this.unit_id,create_date:this.create_date,update_date:this.update_date,ncb_date_of_expiry:this.ncb_date_of_expiry,ndid_reference:this.ndid_reference,icon_reference_ndid:this.icon_reference_ndid,request_params:this.request_params})}update(e){return u.update(e,{id:this.id,ncb_id:this.ncb_id,is_ncb:this.is_ncb,is_ncb_terms:this.is_ncb_terms,ncb_status_code:this.ncb_status_code,ncb_type:this.ncb_type,ncb_count:this.ncb_count,bank_code:this.bank_code,bank_mode:this.bank_mode,reference_id:this.reference_id,ndid_request_id:this.ndid_request_id,ndid_response:this.ndid_response,customer_id:this.customer_id,booking_no:this.booking_no,contract_id:this.contract_id,contract_no:this.contract_no,project_code:this.project_code,project_name:this.project_name,unit_id:this.unit_id,create_date:this.create_date,update_date:this.update_date,ncb_date_of_expiry:this.ncb_date_of_expiry,ndid_reference:this.ndid_reference,icon_reference_ndid:this.icon_reference_ndid,request_params:this.request_params},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Ncb=u,u.builder=new d.SqlBuilder("Master_Ncb",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},ncb_id:{name:"NcbId",type:o.default.NVarChar,is_identity:!1,is_primary:!0},is_ncb:{name:"IsNcb",type:o.default.Bit,is_identity:!1,is_primary:!1},is_ncb_terms:{name:"IsNcbTerms",type:o.default.Bit,is_identity:!1,is_primary:!1},ncb_status_code:{name:"NcbStatusCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},ncb_type:{name:"NcbType",type:o.default.NVarChar,is_identity:!1,is_primary:!1},ncb_count:{name:"NcbCount",type:o.default.Int,is_identity:!1,is_primary:!1},bank_code:{name:"BankCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},bank_mode:{name:"BankMode",type:o.default.Int,is_identity:!1,is_primary:!1},reference_id:{name:"ReferenceId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},ndid_request_id:{name:"NdidRequestId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},ndid_response:{name:"NdidResponse",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},booking_no:{name:"BookingNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},contract_id:{name:"ContractId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},contract_no:{name:"ContractNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},project_code:{name:"ProjectCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},project_name:{name:"ProjectName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},unit_id:{name:"UnitId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},ncb_date_of_expiry:{name:"NcbDateOfExpiry",type:o.default.DateTime,is_identity:!1,is_primary:!1},ndid_reference:{name:"NdidReference",type:o.default.Int,is_identity:!1,is_primary:!1},icon_reference_ndid:{name:"IconReferenceNdid",type:o.default.NVarChar,is_identity:!1,is_primary:!1},request_params:{name:"RequestParams",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","ncb_id","is_ncb","is_ncb_terms","ncb_status_code","ncb_type","ncb_count","bank_code","bank_mode","reference_id","ndid_request_id","ndid_response","customer_id","booking_no","contract_id","contract_no","project_code","project_name","unit_id","create_date","update_date","ncb_date_of_expiry","ndid_reference","icon_reference_ndid","request_params"])},4742:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Ncb_Order=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Ncb_Order=u,u.builder=new d.SqlBuilder("Master_Ncb_Order",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","create_date","update_date"])},5490:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Ncb_Status=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.ncb_status_code=e.ncb_status_code,this.name=e.name,this.name_eng=e.name_eng,this.discription=e.discription,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,ncb_status_code:this.ncb_status_code,name:this.name,name_eng:this.name_eng,discription:this.discription,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,ncb_status_code:this.ncb_status_code,name:this.name,name_eng:this.name_eng,discription:this.discription,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Ncb_Status=u,u.builder=new d.SqlBuilder("Master_Ncb_Status",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},ncb_status_code:{name:"NcbStatusCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name:{name:"Name",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},discription:{name:"Discription",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","ncb_status_code","name","name_eng","discription","create_date","update_date"])},1478:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Occupation=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.rem_code=e.rem_code,this.seq=e.seq,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,seq:this.seq,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,seq:this.seq,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Occupation=u,u.builder=new d.SqlBuilder("Master_Occupation",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},rem_code:{name:"RemCode",type:o.default.Int,is_identity:!1,is_primary:!1},seq:{name:"Seq",type:o.default.Int,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","rem_code","seq","create_date","update_date"])},9418:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Position=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.rem_code=e.rem_code,this.seq=e.seq,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,seq:this.seq,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,seq:this.seq,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Position=u,u.builder=new d.SqlBuilder("Master_Position",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},rem_code:{name:"RemCode",type:o.default.Int,is_identity:!1,is_primary:!1},seq:{name:"Seq",type:o.default.Int,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","rem_code","seq","create_date","update_date"])},8623:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Prefix=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.text=e.text,this.full_text=e.full_text,this.rem_code=e.rem_code,this.seq=e.seq,this.language=e.language,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,text:this.text,full_text:this.full_text,rem_code:this.rem_code,seq:this.seq,language:this.language,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,text:this.text,full_text:this.full_text,rem_code:this.rem_code,seq:this.seq,language:this.language,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Prefix=u,u.builder=new d.SqlBuilder("Master_Prefix",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},text:{name:"Text",type:o.default.NVarChar,is_identity:!1,is_primary:!1},full_text:{name:"FullText",type:o.default.NVarChar,is_identity:!1,is_primary:!1},rem_code:{name:"RemCode",type:o.default.Int,is_identity:!1,is_primary:!1},seq:{name:"Seq",type:o.default.Int,is_identity:!1,is_primary:!1},language:{name:"Language",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","text","full_text","rem_code","seq","language","create_date","update_date"])},6170:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Project=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.project_code=e.project_code,this.project_name=e.project_name,this.project_type=e.project_type,this.project_type_name=e.project_type_name,this.developer_code=e.developer_code,this.developer_name=e.developer_name,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,project_code:this.project_code,project_name:this.project_name,project_type:this.project_type,project_type_name:this.project_type_name,developer_code:this.developer_code,developer_name:this.developer_name,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,project_code:this.project_code,project_name:this.project_name,project_type:this.project_type,project_type_name:this.project_type_name,developer_code:this.developer_code,developer_name:this.developer_name,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Project=u,u.builder=new d.SqlBuilder("Master_Project",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},project_code:{name:"ProjectCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},project_name:{name:"ProjectName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},project_type:{name:"ProjectType",type:o.default.NVarChar,is_identity:!1,is_primary:!1},project_type_name:{name:"ProjectTypeName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},developer_code:{name:"DeveloperCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},developer_name:{name:"DeveloperName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","project_code","project_name","project_type","project_type_name","developer_code","developer_name","create_date","update_date"])},4975:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Project_Type=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.rem_code=e.rem_code,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Project_Type=u,u.builder=new d.SqlBuilder("Master_Project_Type",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},rem_code:{name:"RemCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","rem_code","create_date","update_date"])},8937:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Province=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("province_id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{province_id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.province_id=e.province_id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,province_id:this.province_id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,province_id:this.province_id,name_th:this.name_th,name_eng:this.name_eng,create_date:this.create_date,update_date:this.update_date},{province_id:this.province_id})}delete(e,t){return u.delete(e,{province_id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Province=u,u.builder=new d.SqlBuilder("Master_Province",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!1},province_id:{name:"ProvinceId",type:o.default.NVarChar,is_identity:!1,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","province_id","name_th","name_eng","create_date","update_date"])},2573:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Race=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.rem_code=e.rem_code,this.seq=e.seq,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,seq:this.seq,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,name_th:this.name_th,name_eng:this.name_eng,rem_code:this.rem_code,seq:this.seq,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Race=u,u.builder=new d.SqlBuilder("Master_Race",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},rem_code:{name:"RemCode",type:o.default.Int,is_identity:!1,is_primary:!1},seq:{name:"Seq",type:o.default.Int,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","name_th","name_eng","rem_code","seq","create_date","update_date"])},4825:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_SubDistrict=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("sub_district_id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{sub_district_id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.sub_district_id=e.sub_district_id,this.name_th=e.name_th,this.name_eng=e.name_eng,this.province_id=e.province_id,this.district_id=e.district_id,this.post_code=e.post_code,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,sub_district_id:this.sub_district_id,name_th:this.name_th,name_eng:this.name_eng,province_id:this.province_id,district_id:this.district_id,post_code:this.post_code,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,sub_district_id:this.sub_district_id,name_th:this.name_th,name_eng:this.name_eng,province_id:this.province_id,district_id:this.district_id,post_code:this.post_code,create_date:this.create_date,update_date:this.update_date},{sub_district_id:this.sub_district_id})}delete(e,t){return u.delete(e,{sub_district_id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_SubDistrict=u,u.builder=new d.SqlBuilder("Master_SubDistrict",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!1},sub_district_id:{name:"SubDistrictId",type:o.default.NVarChar,is_identity:!1,is_primary:!0},name_th:{name:"NameTh",type:o.default.NVarChar,is_identity:!1,is_primary:!1},name_eng:{name:"NameEng",type:o.default.NVarChar,is_identity:!1,is_primary:!1},province_id:{name:"ProvinceId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},district_id:{name:"DistrictId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},post_code:{name:"PostCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","sub_district_id","name_th","name_eng","province_id","district_id","post_code","create_date","update_date"])},833:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Subject_Inquiry=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.subject=e.subject,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,subject:this.subject,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,subject:this.subject,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Subject_Inquiry=u,u.builder=new d.SqlBuilder("Master_Subject_Inquiry",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},subject:{name:"Subject",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","subject","create_date","update_date"])},9335:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Master_Unit=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.unit_id=e.unit_id,this.unit_no=e.unit_no,this.unit_type=e.unit_type,this.unit_type_name=e.unit_type_name,this.collateral_price=e.collateral_price,this.title_deed_no=e.title_deed_no,this.floor_no=e.floor_no,this.zone_no=e.zone_no,this.building_no=e.building_no,this.model_name=e.model_name,this.project_code=e.project_code,this.project_name=e.project_name,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,unit_id:this.unit_id,unit_no:this.unit_no,unit_type:this.unit_type,unit_type_name:this.unit_type_name,collateral_price:this.collateral_price,title_deed_no:this.title_deed_no,floor_no:this.floor_no,zone_no:this.zone_no,building_no:this.building_no,model_name:this.model_name,project_code:this.project_code,project_name:this.project_name,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,unit_id:this.unit_id,unit_no:this.unit_no,unit_type:this.unit_type,unit_type_name:this.unit_type_name,collateral_price:this.collateral_price,title_deed_no:this.title_deed_no,floor_no:this.floor_no,zone_no:this.zone_no,building_no:this.building_no,model_name:this.model_name,project_code:this.project_code,project_name:this.project_name,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Master_Unit=u,u.builder=new d.SqlBuilder("Master_Unit",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},unit_id:{name:"UnitId",type:o.default.NVarChar,is_identity:!1,is_primary:!0},unit_no:{name:"UnitNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},unit_type:{name:"UnitType",type:o.default.NVarChar,is_identity:!1,is_primary:!1},unit_type_name:{name:"UnitTypeName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},collateral_price:{name:"CollateralPrice",type:o.default.Decimal(18,2),is_identity:!1,is_primary:!1},title_deed_no:{name:"TitleDeedNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},floor_no:{name:"FloorNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},zone_no:{name:"ZoneNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},building_no:{name:"BuildingNo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},model_name:{name:"ModelName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},project_code:{name:"ProjectCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},project_name:{name:"ProjectName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","unit_id","unit_no","unit_type","unit_type_name","collateral_price","title_deed_no","floor_no","zone_no","building_no","model_name","project_code","project_name","create_date","update_date"])},622:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.snakeCaseKeys=t.getWhereText=t.validateParams=t.setWhereParams=t.setRequestParams=t.SqlBuilder=void 0;const s=a(i(6517)),r=a(i(9424)),o=a(i(2245));function d(e,t,i){s.default.forEach(t,((t,n)=>{const a=Object.assign({},i[n]);a.type==r.default.DateTime&&(a.type=r.default.NVarChar,s.default.isDate(t)&&(t=(0,o.default)(t).format("YYYY-MM-DD HH:mm:ss.SSS"))),e.input(a.name,a.type,t)}))}function u(e,t,i){s.default.forEach(t,((t,n)=>{const a=Object.assign({},i[n]);a.type==r.default.DateTime&&(a.type=r.default.NVarChar,s.default.isDate(t)&&(t=(0,o.default)(t).format("YYYY-MM-DD HH:mm:ss.SSS"))),e.input("W_"+a.name,a.type,t)}))}function _(e,t=!1,i,n){var a=s.default.keys(e);return a=s.default.intersection(a,i),t&&(a=s.default.difference(a,n)),[a,e=s.default.pick(e,a)]}function c(e,t){let i="",n=!0;return s.default.forEach(e,((e,a)=>{n&&(i+="WHERE "),i+=null==e?(n?"":"AND")+" ["+t[a].name+"] IS NULL ":(n?"":"AND")+" ["+t[a].name+"] = @W_"+t[a].name+" ",n&&(n=!1)})),i}function l(e){if(s.default.isArray(e))return e.map((e=>l(e)));if(s.default.isDate(e)||0==s.default.isObject(e))return e;var t={};return s.default.map(e,((e,i)=>{s.default.isArray(e)?t[s.default.snakeCase(i)]=s.default.map(e,(e=>l(e))):s.default.isDate(e)?t[s.default.snakeCase(i)]=e:s.default.isObject(e)?t[s.default.snakeCase(i)]=l(e):t[s.default.snakeCase(i)]=e})),t}t.SqlBuilder=class{constructor(e,t,i,n){this.IDENTITY_KEY=[],this.ALL_SNAKE_KEY=[],this.init(e,t,i,n)}init(e,t,i,n){this.TABLE_NAME=e,this.SQL_COLUMN=t,this.IDENTITY_KEY=i,this.ALL_SNAKE_KEY=n}find(e,t){return n(this,void 0,void 0,(function*(){var[i,n]=_(t,!1,this.ALL_SNAKE_KEY,this.IDENTITY_KEY),a=`\n            SELECT *\n            FROM [${this.TABLE_NAME}]\n        `;return a+=c(n,this.SQL_COLUMN),u(e,n,this.SQL_COLUMN),l((yield e.query(a)).recordset)}))}findOne(e,t){return n(this,void 0,void 0,(function*(){const i=yield this.find(e,t);return i.length>0?l(i[0]):null}))}count(e,t){return n(this,void 0,void 0,(function*(){var[i,n]=_(t,!1,this.ALL_SNAKE_KEY,this.IDENTITY_KEY),a=`\n            SELECT COUNT(0) AS RW_LEN\n            FROM [${this.TABLE_NAME}]\n        `;a+=c(n,this.SQL_COLUMN),u(e,n,this.SQL_COLUMN);const s=yield e.query(a);return 0==s.recordset.length?0:s.recordset[0].RW_LEN}))}insert(e,t){return n(this,void 0,void 0,(function*(){var[i,n]=_(t,!0,this.ALL_SNAKE_KEY,this.IDENTITY_KEY),a=`\n            INSERT INTO [${this.TABLE_NAME}]\n            (\n                ${i.map(((e,t)=>`[${this.SQL_COLUMN[e].name}]`))}\n            )\n            VALUES\n            (\n                ${i.map(((e,t)=>`@${this.SQL_COLUMN[e].name}`))}\n            )\n            SELECT SCOPE_IDENTITY() AS [SCOPE_IDENTITY];\n        `;d(e,n,this.SQL_COLUMN);const s=yield e.query(a);return this.IDENTITY_KEY.length>0&&s.recordset.length>0?s.recordset[0].SCOPE_IDENTITY:""}))}update(e,t,i){return n(this,void 0,void 0,(function*(){var[n,a]=_(t,!0,this.ALL_SNAKE_KEY,this.IDENTITY_KEY),[s,r]=_(i,!1,this.ALL_SNAKE_KEY,this.IDENTITY_KEY),o=`\n        UPDATE [${this.TABLE_NAME}]\n        SET\n            ${n.map(((e,t)=>`[${this.SQL_COLUMN[e].name}] = @${this.SQL_COLUMN[e].name}`))}\n        `;o+=c(r,this.SQL_COLUMN),d(e,a,this.SQL_COLUMN),u(e,r,this.SQL_COLUMN),yield e.query(o)}))}delete(e,t){return n(this,void 0,void 0,(function*(){var[i,n]=_(t,!1,this.ALL_SNAKE_KEY,this.IDENTITY_KEY),a=`\n        DELETE [${this.TABLE_NAME}]\n        `;a+=c(n,this.SQL_COLUMN),u(e,n,this.SQL_COLUMN),yield e.query(a)}))}},t.setRequestParams=d,t.setWhereParams=u,t.validateParams=_,t.getWhereText=c,t.snakeCaseKeys=l},2345:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Sys_Config_RunFormat=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.run_key=e.run_key,this.format=e.format,this.caption=e.caption,this.field_name=e.field_name,this.table_name=e.table_name,this.is_continues=e.is_continues}insert(e){return u.insert(e,{id:this.id,run_key:this.run_key,format:this.format,caption:this.caption,field_name:this.field_name,table_name:this.table_name,is_continues:this.is_continues})}update(e){return u.update(e,{id:this.id,run_key:this.run_key,format:this.format,caption:this.caption,field_name:this.field_name,table_name:this.table_name,is_continues:this.is_continues},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Sys_Config_RunFormat=u,u.builder=new d.SqlBuilder("Sys_Config_RunFormat",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},run_key:{name:"RunKey",type:o.default.NVarChar,is_identity:!1,is_primary:!1},format:{name:"Format",type:o.default.NVarChar,is_identity:!1,is_primary:!1},caption:{name:"Caption",type:o.default.NVarChar,is_identity:!1,is_primary:!1},field_name:{name:"FieldName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},table_name:{name:"TableName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},is_continues:{name:"IsContinues",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","run_key","format","caption","field_name","table_name","is_continues"])},4769:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Sys_Config_RunNumber=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.run_key=e.run_key,this.key_code=e.key_code,this.run_year=e.run_year,this.run_month=e.run_month,this.run_number=e.run_number,this.document_format=e.document_format}insert(e){return u.insert(e,{id:this.id,run_key:this.run_key,key_code:this.key_code,run_year:this.run_year,run_month:this.run_month,run_number:this.run_number,document_format:this.document_format})}update(e){return u.update(e,{id:this.id,run_key:this.run_key,key_code:this.key_code,run_year:this.run_year,run_month:this.run_month,run_number:this.run_number,document_format:this.document_format},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Sys_Config_RunNumber=u,u.builder=new d.SqlBuilder("Sys_Config_RunNumber",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},run_key:{name:"RunKey",type:o.default.Int,is_identity:!1,is_primary:!0},key_code:{name:"KeyCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},run_year:{name:"RunYear",type:o.default.Int,is_identity:!1,is_primary:!1},run_month:{name:"RunMonth",type:o.default.Int,is_identity:!1,is_primary:!1},run_number:{name:"RunNumber",type:o.default.Int,is_identity:!1,is_primary:!1},document_format:{name:"DocumentFormat",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","run_key","key_code","run_year","run_month","run_number","document_format"])},853:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Customer_Login=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.line_id=e.line_id,this.token_id=e.token_id,this.status=e.status,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,line_id:this.line_id,token_id:this.token_id,status:this.status,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,line_id:this.line_id,token_id:this.token_id,status:this.status,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Transaction_Customer_Login=u,u.builder=new d.SqlBuilder("Transaction_Customer_Login",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},line_id:{name:"LineId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},token_id:{name:"TokenId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},[],["id","line_id","token_id","status","create_date","update_date"])},3429:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Document=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.ref_file_id=e.ref_file_id,this.loan_id=e.loan_id,this.customer_id=e.customer_id,this.file_name=e.file_name,this.file_path=e.file_path,this.doc_type=e.doc_type,this.file_type=e.file_type,this.developer_code=e.developer_code,this.rem_file_id=e.rem_file_id,this.rem_link_url=e.rem_link_url,this.status=e.status,this.error_message=e.error_message,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,ref_file_id:this.ref_file_id,loan_id:this.loan_id,customer_id:this.customer_id,file_name:this.file_name,file_path:this.file_path,doc_type:this.doc_type,file_type:this.file_type,developer_code:this.developer_code,rem_file_id:this.rem_file_id,rem_link_url:this.rem_link_url,status:this.status,error_message:this.error_message,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,ref_file_id:this.ref_file_id,loan_id:this.loan_id,customer_id:this.customer_id,file_name:this.file_name,file_path:this.file_path,doc_type:this.doc_type,file_type:this.file_type,developer_code:this.developer_code,rem_file_id:this.rem_file_id,rem_link_url:this.rem_link_url,status:this.status,error_message:this.error_message,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Transaction_Document=u,u.builder=new d.SqlBuilder("Transaction_Document",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},ref_file_id:{name:"RefFileId",type:o.default.Int,is_identity:!1,is_primary:!1},loan_id:{name:"LoanId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},file_name:{name:"FileName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},file_path:{name:"FilePath",type:o.default.NVarChar,is_identity:!1,is_primary:!1},doc_type:{name:"DocType",type:o.default.Int,is_identity:!1,is_primary:!1},file_type:{name:"FileType",type:o.default.Int,is_identity:!1,is_primary:!1},developer_code:{name:"DeveloperCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},rem_file_id:{name:"RemFileId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},rem_link_url:{name:"RemLinkUrl",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},error_message:{name:"ErrorMessage",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","ref_file_id","loan_id","customer_id","file_name","file_path","doc_type","file_type","developer_code","rem_file_id","rem_link_url","status","error_message","create_date","update_date"])},9035:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Email=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.send_to=e.send_to,this.send_cc=e.send_cc,this.subject=e.subject,this.body=e.body,this.create_date=e.create_date,this.effective_date=e.effective_date,this.sent_date=e.sent_date,this.error_date=e.error_date,this.error_message=e.error_message,this.error_count=e.error_count,this.status=e.status,this.job_id=e.job_id}insert(e){return u.insert(e,{id:this.id,send_to:this.send_to,send_cc:this.send_cc,subject:this.subject,body:this.body,create_date:this.create_date,effective_date:this.effective_date,sent_date:this.sent_date,error_date:this.error_date,error_message:this.error_message,error_count:this.error_count,status:this.status,job_id:this.job_id})}update(e){return u.update(e,{id:this.id,send_to:this.send_to,send_cc:this.send_cc,subject:this.subject,body:this.body,create_date:this.create_date,effective_date:this.effective_date,sent_date:this.sent_date,error_date:this.error_date,error_message:this.error_message,error_count:this.error_count,status:this.status,job_id:this.job_id},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Transaction_Email=u,u.builder=new d.SqlBuilder("Transaction_Email",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},send_to:{name:"SendTo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},send_cc:{name:"SendCC",type:o.default.NVarChar,is_identity:!1,is_primary:!1},subject:{name:"Subject",type:o.default.NVarChar,is_identity:!1,is_primary:!1},body:{name:"Body",type:o.default.NText,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},effective_date:{name:"EffectiveDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},sent_date:{name:"SentDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},error_date:{name:"ErrorDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},error_message:{name:"ErrorMessage",type:o.default.NVarChar,is_identity:!1,is_primary:!1},error_count:{name:"ErrorCount",type:o.default.Int,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},job_id:{name:"JobId",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","send_to","send_cc","subject","body","create_date","effective_date","sent_date","error_date","error_message","error_count","status","job_id"])},6386:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Email_Otp=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.line_id=e.line_id,this.email=e.email,this.token=e.token,this.pin_code=e.pin_code,this.status=e.status,this.create_date=e.create_date,this.update_date=e.update_date,this.expied_date=e.expied_date}insert(e){return u.insert(e,{id:this.id,line_id:this.line_id,email:this.email,token:this.token,pin_code:this.pin_code,status:this.status,create_date:this.create_date,update_date:this.update_date,expied_date:this.expied_date})}update(e){return u.update(e,{id:this.id,line_id:this.line_id,email:this.email,token:this.token,pin_code:this.pin_code,status:this.status,create_date:this.create_date,update_date:this.update_date,expied_date:this.expied_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Transaction_Email_Otp=u,u.builder=new d.SqlBuilder("Transaction_Email_Otp",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},line_id:{name:"LineId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},email:{name:"Email",type:o.default.NVarChar,is_identity:!1,is_primary:!1},token:{name:"Token",type:o.default.NVarChar,is_identity:!1,is_primary:!1},pin_code:{name:"PinCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},expied_date:{name:"ExpiedDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","line_id","email","token","pin_code","status","create_date","update_date","expied_date"])},3291:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Inquiry=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.customer_id=e.customer_id,this.subject_id=e.subject_id,this.subject_name=e.subject_name,this.detail=e.detail,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,customer_id:this.customer_id,subject_id:this.subject_id,subject_name:this.subject_name,detail:this.detail,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,customer_id:this.customer_id,subject_id:this.subject_id,subject_name:this.subject_name,detail:this.detail,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Transaction_Inquiry=u,u.builder=new d.SqlBuilder("Transaction_Inquiry",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},subject_id:{name:"SubjectId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},subject_name:{name:"SubjectName",type:o.default.NVarChar,is_identity:!1,is_primary:!1},detail:{name:"Detail",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","customer_id","subject_id","subject_name","detail","create_date","update_date"])},135:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Ncb_Payment=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.create_date=e.create_date,this.update_date=e.update_date}insert(e){return u.insert(e,{id:this.id,create_date:this.create_date,update_date:this.update_date})}update(e){return u.update(e,{id:this.id,create_date:this.create_date,update_date:this.update_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Transaction_Ncb_Payment=u,u.builder=new d.SqlBuilder("Transaction_Ncb_Payment",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","create_date","update_date"])},6102:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Notification_Line=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.send_to=e.send_to,this.customer_id=e.customer_id,this.subject=e.subject,this.body=e.body,this.create_date=e.create_date,this.effective_date=e.effective_date,this.sent_date=e.sent_date,this.error_date=e.error_date,this.error_message=e.error_message,this.error_count=e.error_count,this.status=e.status,this.message_type=e.message_type}insert(e){return u.insert(e,{id:this.id,send_to:this.send_to,customer_id:this.customer_id,subject:this.subject,body:this.body,create_date:this.create_date,effective_date:this.effective_date,sent_date:this.sent_date,error_date:this.error_date,error_message:this.error_message,error_count:this.error_count,status:this.status,message_type:this.message_type})}update(e){return u.update(e,{id:this.id,send_to:this.send_to,customer_id:this.customer_id,subject:this.subject,body:this.body,create_date:this.create_date,effective_date:this.effective_date,sent_date:this.sent_date,error_date:this.error_date,error_message:this.error_message,error_count:this.error_count,status:this.status,message_type:this.message_type},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Transaction_Notification_Line=u,u.builder=new d.SqlBuilder("Transaction_Notification_Line",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},send_to:{name:"SendTo",type:o.default.NVarChar,is_identity:!1,is_primary:!1},customer_id:{name:"CustomerId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},subject:{name:"Subject",type:o.default.NVarChar,is_identity:!1,is_primary:!1},body:{name:"Body",type:o.default.NText,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},effective_date:{name:"EffectiveDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},sent_date:{name:"SentDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},error_date:{name:"ErrorDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},error_message:{name:"ErrorMessage",type:o.default.NVarChar,is_identity:!1,is_primary:!1},error_count:{name:"ErrorCount",type:o.default.Int,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},message_type:{name:"MessageType",type:o.default.NVarChar,is_identity:!1,is_primary:!1}},["id"],["id","send_to","customer_id","subject","body","create_date","effective_date","sent_date","error_date","error_message","error_count","status","message_type"])},3692:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Sms_Otp=void 0;const o=s(i(9424)),d=i(622);class u{constructor(e,t){if(t){if(null==e)throw new Error("Pool request is required.");this.load(e,t)}else{if(e instanceof o.Request)throw new Error("id is required.");this.loadByData(e)}}load(e,t){return r(this,void 0,void 0,(function*(){const i=yield u.findOne(e,{id:t});this.loadByData(i)}))}loadByData(e){this.id=e.id,this.line_id=e.line_id,this.mobile_number=e.mobile_number,this.token=e.token,this.pin_code=e.pin_code,this.status=e.status,this.create_date=e.create_date,this.update_date=e.update_date,this.expied_date=e.expied_date}insert(e){return u.insert(e,{id:this.id,line_id:this.line_id,mobile_number:this.mobile_number,token:this.token,pin_code:this.pin_code,status:this.status,create_date:this.create_date,update_date:this.update_date,expied_date:this.expied_date})}update(e){return u.update(e,{id:this.id,line_id:this.line_id,mobile_number:this.mobile_number,token:this.token,pin_code:this.pin_code,status:this.status,create_date:this.create_date,update_date:this.update_date,expied_date:this.expied_date},{id:this.id})}delete(e,t){return u.delete(e,{id:t})}static find(e,t){return r(this,void 0,void 0,(function*(){return(yield this.builder.find(e,t)).map((e=>new u(e)))}))}static findOne(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.builder.findOne(e,t);return null==i?null:new u(i)}))}static count(e,t){return r(this,void 0,void 0,(function*(){return yield this.builder.count(e,t)}))}static insert(e,t){return this.builder.insert(e,t)}static update(e,t,i){return this.builder.update(e,t,i)}static delete(e,t){return this.builder.delete(e,t)}}t.Transaction_Sms_Otp=u,u.builder=new d.SqlBuilder("Transaction_Sms_Otp",{id:{name:"Id",type:o.default.Int,is_identity:!0,is_primary:!0},line_id:{name:"LineId",type:o.default.NVarChar,is_identity:!1,is_primary:!1},mobile_number:{name:"MobileNumber",type:o.default.NVarChar,is_identity:!1,is_primary:!1},token:{name:"Token",type:o.default.NVarChar,is_identity:!1,is_primary:!1},pin_code:{name:"PinCode",type:o.default.NVarChar,is_identity:!1,is_primary:!1},status:{name:"Status",type:o.default.NVarChar,is_identity:!1,is_primary:!1},create_date:{name:"CreateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},update_date:{name:"UpdateDate",type:o.default.DateTime,is_identity:!1,is_primary:!1},expied_date:{name:"ExpiedDate",type:o.default.DateTime,is_identity:!1,is_primary:!1}},["id"],["id","line_id","mobile_number","token","pin_code","status","create_date","update_date","expied_date"])},7287:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction_Notification_Line=t.Transaction_Ncb_Payment=t.Transaction_Inquiry=t.Transaction_Email_Otp=t.Transaction_Email=t.Transaction_Document=t.Transaction_Customer_Login=t.Sys_Config_RunNumber=t.Sys_Config_RunFormat=t.Master_Unit=t.Master_Subject_Inquiry=t.Master_SubDistrict=t.Master_Race=t.Master_Province=t.Master_Project_Type=t.Master_Project=t.Master_Prefix=t.Master_Position=t.Master_Occupation=t.Master_Ncb_Status=t.Master_Ncb_Order=t.Master_Ncb=t.Master_Nationlity=t.Master_Melfare=t.Master_Married_Status=t.Master_Loan=t.Master_Idp=t.Master_Gender=t.Master_File=t.Master_Education=t.Master_District=t.Master_Developer=t.Master_Customer_Loan=t.Master_Customer_Address=t.Master_Customer=t.Master_Business=t.Master_Bareau=t.Master_Bank_Status=t.Master_Bank=t.Mapping_Loan_Bank=t.Mapping_Loan=t.Mapping_Customer_Unit=t.Mapping_Customer_Reserve=t.Mapping_Customer_Register=t.Log_Sms=t.Log_Payment=t.Log_Ncb=t.Log_Loan=t.Log_Email=t.Log_Api=void 0,t.Transaction_Sms_Otp=void 0;const n=i(5600);Object.defineProperty(t,"Log_Api",{enumerable:!0,get:function(){return n.Log_Api}});const a=i(8574);Object.defineProperty(t,"Log_Email",{enumerable:!0,get:function(){return a.Log_Email}});const s=i(6040);Object.defineProperty(t,"Log_Loan",{enumerable:!0,get:function(){return s.Log_Loan}});const r=i(5541);Object.defineProperty(t,"Log_Ncb",{enumerable:!0,get:function(){return r.Log_Ncb}});const o=i(8301);Object.defineProperty(t,"Log_Payment",{enumerable:!0,get:function(){return o.Log_Payment}});const d=i(1221);Object.defineProperty(t,"Log_Sms",{enumerable:!0,get:function(){return d.Log_Sms}});const u=i(4003);Object.defineProperty(t,"Mapping_Customer_Register",{enumerable:!0,get:function(){return u.Mapping_Customer_Register}});const _=i(7407);Object.defineProperty(t,"Mapping_Customer_Reserve",{enumerable:!0,get:function(){return _.Mapping_Customer_Reserve}});const c=i(3190);Object.defineProperty(t,"Mapping_Customer_Unit",{enumerable:!0,get:function(){return c.Mapping_Customer_Unit}});const l=i(5199);Object.defineProperty(t,"Mapping_Loan",{enumerable:!0,get:function(){return l.Mapping_Loan}});const p=i(2363);Object.defineProperty(t,"Mapping_Loan_Bank",{enumerable:!0,get:function(){return p.Mapping_Loan_Bank}});const m=i(58);Object.defineProperty(t,"Master_Bank",{enumerable:!0,get:function(){return m.Master_Bank}});const y=i(1138);Object.defineProperty(t,"Master_Bank_Status",{enumerable:!0,get:function(){return y.Master_Bank_Status}});const f=i(942);Object.defineProperty(t,"Master_Bareau",{enumerable:!0,get:function(){return f.Master_Bareau}});const h=i(9692);Object.defineProperty(t,"Master_Business",{enumerable:!0,get:function(){return h.Master_Business}});const b=i(5129);Object.defineProperty(t,"Master_Customer",{enumerable:!0,get:function(){return b.Master_Customer}});const v=i(3051);Object.defineProperty(t,"Master_Customer_Address",{enumerable:!0,get:function(){return v.Master_Customer_Address}});const g=i(9604);Object.defineProperty(t,"Master_Customer_Loan",{enumerable:!0,get:function(){return g.Master_Customer_Loan}});const O=i(5591);Object.defineProperty(t,"Master_Developer",{enumerable:!0,get:function(){return O.Master_Developer}});const w=i(6264);Object.defineProperty(t,"Master_District",{enumerable:!0,get:function(){return w.Master_District}});const N=i(3930);Object.defineProperty(t,"Master_Education",{enumerable:!0,get:function(){return N.Master_Education}});const C=i(6920);Object.defineProperty(t,"Master_File",{enumerable:!0,get:function(){return C.Master_File}});const S=i(7276);Object.defineProperty(t,"Master_Gender",{enumerable:!0,get:function(){return S.Master_Gender}});const D=i(304);Object.defineProperty(t,"Master_Idp",{enumerable:!0,get:function(){return D.Master_Idp}});const P=i(8522);Object.defineProperty(t,"Master_Loan",{enumerable:!0,get:function(){return P.Master_Loan}});const M=i(2474);Object.defineProperty(t,"Master_Married_Status",{enumerable:!0,get:function(){return M.Master_Married_Status}});const k=i(2681);Object.defineProperty(t,"Master_Melfare",{enumerable:!0,get:function(){return k.Master_Melfare}});const q=i(7914);Object.defineProperty(t,"Master_Nationlity",{enumerable:!0,get:function(){return q.Master_Nationlity}});const R=i(1751);Object.defineProperty(t,"Master_Ncb",{enumerable:!0,get:function(){return R.Master_Ncb}});const T=i(4742);Object.defineProperty(t,"Master_Ncb_Order",{enumerable:!0,get:function(){return T.Master_Ncb_Order}});const j=i(5490);Object.defineProperty(t,"Master_Ncb_Status",{enumerable:!0,get:function(){return j.Master_Ncb_Status}});const I=i(1478);Object.defineProperty(t,"Master_Occupation",{enumerable:!0,get:function(){return I.Master_Occupation}});const L=i(9418);Object.defineProperty(t,"Master_Position",{enumerable:!0,get:function(){return L.Master_Position}});const x=i(8623);Object.defineProperty(t,"Master_Prefix",{enumerable:!0,get:function(){return x.Master_Prefix}});const E=i(6170);Object.defineProperty(t,"Master_Project",{enumerable:!0,get:function(){return E.Master_Project}});const A=i(4975);Object.defineProperty(t,"Master_Project_Type",{enumerable:!0,get:function(){return A.Master_Project_Type}});const B=i(8937);Object.defineProperty(t,"Master_Province",{enumerable:!0,get:function(){return B.Master_Province}});const U=i(2573);Object.defineProperty(t,"Master_Race",{enumerable:!0,get:function(){return U.Master_Race}});const V=i(4825);Object.defineProperty(t,"Master_SubDistrict",{enumerable:!0,get:function(){return V.Master_SubDistrict}});const F=i(833);Object.defineProperty(t,"Master_Subject_Inquiry",{enumerable:!0,get:function(){return F.Master_Subject_Inquiry}});const J=i(9335);Object.defineProperty(t,"Master_Unit",{enumerable:!0,get:function(){return J.Master_Unit}});const z=i(2345);Object.defineProperty(t,"Sys_Config_RunFormat",{enumerable:!0,get:function(){return z.Sys_Config_RunFormat}});const $=i(4769);Object.defineProperty(t,"Sys_Config_RunNumber",{enumerable:!0,get:function(){return $.Sys_Config_RunNumber}});const K=i(853);Object.defineProperty(t,"Transaction_Customer_Login",{enumerable:!0,get:function(){return K.Transaction_Customer_Login}});const Y=i(3429);Object.defineProperty(t,"Transaction_Document",{enumerable:!0,get:function(){return Y.Transaction_Document}});const H=i(9035);Object.defineProperty(t,"Transaction_Email",{enumerable:!0,get:function(){return H.Transaction_Email}});const G=i(6386);Object.defineProperty(t,"Transaction_Email_Otp",{enumerable:!0,get:function(){return G.Transaction_Email_Otp}});const W=i(3291);Object.defineProperty(t,"Transaction_Inquiry",{enumerable:!0,get:function(){return W.Transaction_Inquiry}});const Q=i(135);Object.defineProperty(t,"Transaction_Ncb_Payment",{enumerable:!0,get:function(){return Q.Transaction_Ncb_Payment}});const X=i(6102);Object.defineProperty(t,"Transaction_Notification_Line",{enumerable:!0,get:function(){return X.Transaction_Notification_Line}});const Z=i(3692);Object.defineProperty(t,"Transaction_Sms_Otp",{enumerable:!0,get:function(){return Z.Transaction_Sms_Otp}})},2900:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decryptionFileIdentifier=t.encryptionFileIdentifier=void 0;const s=a(i(6113));t.encryptionFileIdentifier=e=>n(void 0,void 0,void 0,(function*(){let t="";if(null!=e){const i="aes-256-cbc",n=s.default.createCipheriv(i,process.env.FILE_SECRET_KEY,process.env.FILE_PLUBIC_KEY);t=n.update(e,"utf-8","hex"),t+=n.final("hex")}return t})),t.decryptionFileIdentifier=e=>n(void 0,void 0,void 0,(function*(){let t="";try{if(null!=e){const i="aes-256-cbc",n=s.default.createDecipheriv(i,process.env.FILE_SECRET_KEY,process.env.FILE_PLUBIC_KEY);t=n.update(e,"hex","utf-8"),t+=n.final("utf8")}return t}catch(e){return t}}))},1366:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkPin=void 0;const s=i(2275),r=i(7287),o=a(i(7096)),d=a(i(2245));t.checkPin=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{const{pin:a}=e.body;if(!a)return t.status(400).send({status:400,message:"ขออภัยไม่สามารถทำรายการได้ กรุณาใส่รหัสผ่าน"});const u=yield r.Mapping_Customer_Register.findOne((0,s.createRequest)(),{line_id:e.line_id,status:"active"});if(!u)return t.status(400).send({status:400,message:"ไม่พบข้อมูลผู้ใช้งานของท่าน"});const _=yield function(e,t,i){return n(this,void 0,void 0,(function*(){const n=(0,d.default)().format("YYYY-MM-DD HH:mm:ss"),a=(0,d.default)(t||n).format("YYYY-MM-DD HH:mm:ss");let s={status:200,message:"PIN ไม่ถูกระงับการใช้งาน",data:{count_wrong_pin:e,blocked_minutes:i,expied_date_blocked_pin:a,blocked_pin:!1}};return e>=3&&(0,d.default)(n).unix()<(0,d.default)(a).unix()&&(s={status:401,message:"ขออภัย PIN ถูกระงับการใช้งาน",data:{count_wrong_pin:e,blocked_minutes:i,expied_date_blocked_pin:a,blocked_pin:!0}}),s}))}(u.count_wrong_pin,u.expied_date_blocked_pin,u.blocked_minutes);if(200!==_.status)return t.status(_.status).send({status:_.status,message:_.message,data:_.data});if(!u||!o.default.compareSync(a,u.pin)){let i=0;const a=yield function(e,t,i,a,o){return n(this,void 0,void 0,(function*(){let n,u,_=a||0,c=!1;return(e=t+1)<3&&(n="ท่านระบุรหัสผ่านไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง (ท่านสามารถระบุรหัสผ่านได้ 3 ครั้ง)",u=i||new Date),e>=3&&(c=!0,_+=30,u=new Date((0,d.default)().add(_,"minutes").toString()),n="ขออภัย ท่านใส่รหัสผ่านผิดเกินกำหนด กรุณารอ "+_+"นาที หรือกดลืมรหัสผ่าน"),yield r.Mapping_Customer_Register.update((0,s.createRequest)(),{count_wrong_pin:e,expied_date_blocked_pin:u,blocked_minutes:_},{line_id:o,status:"active"}),{message:n,count_wrong_pin:e,expied_date_blocked_pin:(0,d.default)(u).format("YYYY-MM-DD HH:mm:ss"),blocked_minutes:_,blocked_pin:c}}))}(i,u.count_wrong_pin,u.expied_date_blocked_pin,u.blocked_minutes,e.line_id);return t.status(401).send({status:401,message:a.message,data:{count_wrong_pin:a.count_wrong_pin,blocked_minutes:a.blocked_minutes,expied_date_blocked_pin:a.expied_date_blocked_pin,blocked_pin:a.blocked_pin}})}i()}catch(e){t.status(401).send({status:401,message:e.message})}}))},8535:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.verifyPin=t.verifyEmailOtp=t.verifySmsOtp=t.requestPin=t.requestEmailOtp=t.requestSmsOtp=void 0;const n=i(9669),a=i(7287),s=i(2275),r=new n.RateLimiterMemory({points:2,duration:60,blockDuration:60}),o=new n.RateLimiterMemory({points:2,duration:60,blockDuration:60}),d=new n.RateLimiterMemory({points:2,duration:60,blockDuration:60}),u=new n.RateLimiterMemory({points:5,duration:60,blockDuration:30}),_=new n.RateLimiterMemory({points:5,duration:60,blockDuration:30}),c=new n.RateLimiterMemory({points:3,duration:60,blockDuration:30});t.requestSmsOtp=(e,t,i)=>{r.consume(e.body.line_id,1).then((e=>{i()})).catch((i=>{a.Log_Api.insert((0,s.createRequest)(),{type:"inbound",method:e.method,header:"Rate limiter",origin:e.url,body:JSON.stringify(Object.assign({ip:e.ip},e.body))});const n=Math.round(i.msBeforeNext/1e3)||1;t.set("Retry-After",String(n)),t.status(429).send({status:429,message:"ขออภัย ไม่สามารถขอรหัส OTP ใหม่ได้ กรุณารอ "+n+" วินาที."})}))},t.requestEmailOtp=(e,t,i)=>{o.consume(e.body.line_id,1).then((e=>{i()})).catch((i=>{a.Log_Api.insert((0,s.createRequest)(),{type:"inbound",method:e.method,header:"Rate limiter",origin:e.url,body:JSON.stringify(Object.assign({ip:e.ip},e.body))});const n=Math.round(i.msBeforeNext/1e3)||1;t.set("Retry-After",String(n)),t.status(429).send({status:429,message:"ขออภัย ไม่สามารถขอรหัส OTP ใหม่ได้ กรุณารอ "+n+" วินาที."})}))},t.requestPin=(e,t,i)=>{d.consume(e.body.line_id,1).then((e=>{i()})).catch((i=>{a.Log_Api.insert((0,s.createRequest)(),{type:"inbound",method:e.method,header:"Rate limiter",origin:e.url,body:JSON.stringify(Object.assign({ip:e.ip},e.body))});const n=Math.round(i.msBeforeNext/1e3)||1;t.set("Retry-After",String(n)),t.status(429).send({status:429,message:"ขออภัย ไม่สามารถขอรหัสใหม่ได้ กรุณารอ "+n+" วินาที."})}))},t.verifySmsOtp=(e,t,i)=>{u.consume(e.body.token,1).then((e=>{i()})).catch((i=>{a.Log_Api.insert((0,s.createRequest)(),{type:"inbound",method:e.method,header:"Rate limiter",origin:e.url,body:JSON.stringify(Object.assign({ip:e.ip},e.body))}),a.Transaction_Sms_Otp.update((0,s.createRequest)(),{status:"deactive",expied_date:new Date},{token:e.body.token,status:"pending"});const n=Math.round(i.msBeforeNext/1e3)||1;t.set("Retry-After",String(n)),t.status(429).send({status:429,message:"ท่านระบุรหัส OTP ไม่ถูกต้อง กรุณาขอ OTP ใหม่อีกครั้ง (ท่านสามารถระบุรหัส OTP ได้ 5 ครั้ง)"})}))},t.verifyEmailOtp=(e,t,i)=>{_.consume(e.body.token,1).then((e=>{i()})).catch((i=>{a.Log_Api.insert((0,s.createRequest)(),{type:"inbound",method:e.method,header:"Rate limiter",origin:e.url,body:JSON.stringify(Object.assign({ip:e.ip},e.body))}),a.Transaction_Email_Otp.update((0,s.createRequest)(),{status:"deactive",expied_date:new Date},{token:e.body.token,status:"pending"});const n=Math.round(i.msBeforeNext/1e3)||1;t.set("Retry-After",String(n)),t.status(429).send({status:429,message:"ท่านระบุรหัส OTP ไม่ถูกต้อง กรุณาขอ OTP ใหม่อีกครั้ง (ท่านสามารถระบุรหัส OTP ได้ 5 ครั้ง)"})}))},t.verifyPin=(e,t,i)=>{c.consume(e.body.token,1).then((e=>{i()})).catch((i=>{a.Log_Api.insert((0,s.createRequest)(),{type:"inbound",method:e.method,header:"Rate limiter",origin:e.url,body:JSON.stringify(Object.assign({ip:e.ip},e.body))}),a.Transaction_Email_Otp.update((0,s.createRequest)(),{status:"deactive",expied_date:new Date},{token:e.body.token,status:"pending"});const n=Math.round(i.msBeforeNext/1e3)||1;t.set("Retry-After",String(n)),t.status(429).send({status:429,message:"ท่านระบุรหัสไม่ถูกต้อง กรุณาขอรหัสใหม่อีกครั้ง (ท่านสามารถระบุรหัสได้ 3 ครั้ง)"})}))}},2821:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.withAuthenForToken=t.withAuthenParms=t.withAuthen=void 0;const s=a(i(5960)),r=i(2275),o=i(7287),d=a(i(6517)),u=a(i(9424));t.withAuthen=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{if(!e.headers.authorization||"Bearer"!==e.headers.authorization.split(" ")[0])throw new Error("ไม่มี token");{const t=e.headers.authorization.split(" ")[1];if(!(yield o.Transaction_Customer_Login.findOne((0,r.createRequest)(),{token_id:t,status:"active"})))throw new Error("ไม่พบข้อมูล");{const n=s.default.verify(t,null);if(!n||!n.customer_id)throw new Error("Token หมดอายุ");{const t=yield o.Master_Customer.findOne((0,r.createRequest)(),{customer_id:n.customer_id});if(!t)throw new Error("ไม่พบข้อมูล");e.auth=d.default.omit(t,["password","created_date","modified_date","status"]),e.customer_id=e.auth.customer_id,e.line_id=n.line_id,i()}}}}catch(e){t.status(401).send({status:401,message:e.message,expired:!0})}})),t.withAuthenParms=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{if(!e.query.token)throw new Error("ไม่มี token");{const t=e.query.token;if(!(yield o.Transaction_Customer_Login.findOne((0,r.createRequest)(),{token_id:t,status:"active"})))throw new Error("ไม่พบข้อมูล");{const n=s.default.verify(t,null);if(!n||!n.customer_id)throw new Error("Token หมดอายุ");{const t=yield o.Master_Customer.findOne((0,r.createRequest)(),{customer_id:n.customer_id});if(!t)throw new Error("ไม่พบข้อมูล");e.auth=d.default.omit(t,["password","created_date","modified_date","status"]),e.customer_id=e.auth.customer_id,i()}}}}catch(e){t.status(401).send({status:401,message:e.message})}})),t.withAuthenForToken=(e,t,i)=>n(void 0,void 0,void 0,(function*(){try{if(!e.headers.authorization||"Bearer"!==e.headers.authorization.split(" ")[0])throw new Error("ไม่มี token");{const t=e.headers.authorization.split(" ")[1];if(!(yield o.Transaction_Customer_Login.findOne((0,r.createRequest)(),{token_id:t,status:"active"})))throw new Error("ไม่พบข้อมูล");{const n=s.default.verify(t,null);if(!n)throw new Error("Token หมดอายุ");{const t=yield(0,r.createRequest)().input("line_id",u.default.NVarChar,n.line_id).query("SELECT t1.CustomerId, t2.LineId, t2.LineName, t2.Status FROM Master_Customer t1 \n                    INNER JOIN Mapping_Customer_Register t2 ON t1.CustomerId = t2.CustomerId\n                    WHERE t2.Status = 'active' AND t2.LineId = @line_id\n            ");if(!t)throw new Error("ไม่พบข้อมูล");e.customer_id=t.recordset[0].CustomerId,e.line_id=n.line_id,i()}}}}catch(e){t.status(401).send({status:401,message:e.message,expired:!0})}}))},8604:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertFileResponse=t.fileResponse=void 0;class i{constructor(e){this.id=e.id,this.name=e.file_name,this.file_size=e.file_size,this.content_type=e.file_type,this.file_extension=e.file_extension,this.document_type=e.group_type,this.ref_document_name=e.ref_type,this.developer_code=(null==e?void 0:e.developer_code)||"",this.url=process.env.URL+`/files/${e.id}`}}t.fileResponse=i,t.convertFileResponse=function(e){return e.map((e=>new i(e)))}},7728:function(e,t,i){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(i(6860)),s=n(i(5045)),r=n(i(3685)),o=n(i(5142)),d=n(i(5022)),u=i(2275),_=n(i(5960)),c=n(i(7806)),l=n(i(6891)),p=n(i(3582)),m=n(i(7455)),y=n(i(9470)),f=i(3833),h=n(i(1017));let b;const v=o.default.config();if(v.error)throw v.error;const g=v.parsed;_.default.setKeyFromPath("src/keys");const O=(0,a.default)();O.use((0,c.default)()),O.use((0,l.default)()),O.use((0,p.default)({origin:"*",methods:["GET","POST","DELETE","UPDATE","PUT","PATCH"]})),O.disable("x-powered-by"),O.use(c.default.frameguard({action:"sameorigin"})),O.use((0,m.default)()),O.use(a.default.json({limit:"20mb"})),O.use(a.default.urlencoded({extended:!0})),O.use((0,y.default)("dev")),O.use("/api/statics",a.default.static(h.default.join("src","../public"))),O.use("/images",a.default.static("./images/")),O.use(s.default),O.use((function(e,t,i,n){if(console.log(t.body),i.headersSent)return n(e);e.status&&e.status<500?f.logger.info(e.message):e.stack?f.logger.error(e.stack):f.logger.info(e.message),i.status(e.status||500).send({error_code:e.status||500,error_message:e.message||"System error, Something went wrong"})})),process.on("uncaughtException",(function(e){f.logger.error(e.stack),console.error(d.default.red(e.stack)),process.exit(1)})),process.on("SIGINT",(function(){u.pool&&u.pool.close((e=>{console.log(d.default.blueBright.inverse("Pool release")),process.exit(e?1:0)}))}));const w={server:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME,requestTimeout:3e4,pool:{max:10,min:0,idleTimeoutMillis:3e4},options:{encrypt:!1,rowCollectionOnDone:!0,useUTC:!1,enableArithAbort:!0}};(0,u.createPool)(w).then((()=>{console.log(d.default.green.inverse("Pool connected")),b=new Date,r.default.createServer(O).listen(g.PORT,(()=>{console.log(d.default.green.inverse(`Listening on port ${g.PORT}`))})),r.default.createServer(O).setTimeout(3e4)})).catch((e=>{console.log(d.default.red.inverse("Pool connect error"),e)}))},82:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},r=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sendMail=void 0;const d=i(448),u=i(2275),_=i(7287),c=s(i(5214));o(i(5142)).default.config(),t.sendMail=e=>r(void 0,void 0,void 0,(function*(){try{let t="",i="",n=`${process.env.URL}/images/logo-gateway.png`,a=[];const s=yield _.Transaction_Email.insert((0,u.createRequest)(),{send_to:e.send_to,subject:e.subject,body:JSON.stringify(e),status:"pending"});let r={};switch(e.type){case"email_otp":r={pin_code:e.pin_code,ref_code:e.ref_code,logo:n},i=c.module.emailOtpHtml(r);break;case"email_request_pin":r={pin_code:e.pin_code,logo:n},i=c.module.emailRequestPinHtml(r);break;case"email_inquiry":r={subject_name:e.subject_name,detail:e.detail,customer_name:e.customer_name,mobile_number:e.mobile_number,email:e.email,logo:n},i=c.module.emailInquiryHtml(r),a=e.file_document}try{return yield d.transport.sendMail({to:e.send_to.split(","),from:process.env.EMAIL_USERNAME,subject:e.subject,text:t,html:i,attachments:a}),yield _.Transaction_Email.update((0,u.createRequest)(),{effective_date:new Date,sent_date:new Date,status:"success",job_id:""},{id:s}),!0}catch(e){return yield _.Transaction_Email.update((0,u.createRequest)(),{effective_date:new Date,error_date:new Date,error_message:e.message,job_id:""},{id:s}),!1}}catch(e){return!1}}))},6497:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getUserLineProfile=t.sendMessageToUserByLineMessageAPI=t.lineOaUnLinkMenuToUser=t.lineOaLinkMenuToUser=void 0;const s=a(i(2167));a(i(5142)).default.config(),t.lineOaLinkMenuToUser=e=>n(void 0,void 0,void 0,(function*(){try{return yield(0,s.default)({url:`${process.env.LINE_URL}/user/${e}/richmenu/${process.env.LINE_MENU}`,method:"POST",headers:{Authorization:`Bearer ${process.env.LINE_TOKEN}`}}),!0}catch(e){return!1}})),t.lineOaUnLinkMenuToUser=e=>n(void 0,void 0,void 0,(function*(){try{return yield(0,s.default)({url:`${process.env.LINE_URL}/user/${e}/richmenu`,method:"DELETE",headers:{Authorization:`Bearer ${process.env.LINE_TOKEN}`}}),!0}catch(e){return!1}})),t.sendMessageToUserByLineMessageAPI=(e,t)=>n(void 0,void 0,void 0,(function*(){try{return yield(0,s.default)({url:`${process.env.LINE_URL}/message/push`,method:"POST",headers:{Authorization:`Bearer ${process.env.LINE_TOKEN}`},data:{to:e,messages:[t]}}),!0}catch(e){return!1}})),t.getUserLineProfile=e=>n(void 0,void 0,void 0,(function*(){try{const t=yield(0,s.default)({url:`${process.env.LINE_URL}/profile/${e}`,method:"GET",headers:{Authorization:`Bearer ${process.env.LINE_TOKEN}`}});return JSON.parse(JSON.stringify(t.data))}catch(e){return!1}}))},9138:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function r(e){try{d(n.next(e))}catch(e){s(e)}}function o(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sendSms=void 0;const s=a(i(5142)),r=a(i(2167));s.default.config(),t.sendSms=(e,t)=>n(void 0,void 0,void 0,(function*(){let i={status:0,message:""};try{var n={method:"post",url:process.env.SMS_MKT_URL_API,headers:{"Content-Type":"application/json",api_key:process.env.SMS_MKT_API_KEY,secret_key:process.env.SMS_MKT_SECRET_KEY},data:JSON.stringify({sender:process.env.SMS_MKT_SENDER,phone:t,message:`ICON Digital Gateway The SMS-OTP is ${e}. OTP will be expired with in 5 mins`})};return yield(0,r.default)(n).then((function(e){i="000"===e.data.code?{status:200,message:e.data}:{status:500,message:e.data.detail}})).catch((function(e){i={status:500,message:e.detail}})),i}catch(e){return i={status:500,message:e.message},i}}))},3833:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.snakeCaseKeys=void 0;const r=s(i(6517));a(i(9572),t),t.snakeCaseKeys=e=>{if(r.default.isDate(e)||0==r.default.isObject(e))return e;function i(e){let i={};return r.default.map(e,((e,n)=>{r.default.isArray(e)?i[r.default.snakeCase(n)]=r.default.map(e,(e=>(0,t.snakeCaseKeys)(e))):r.default.isDate(e)?i[r.default.snakeCase(n)]=e:r.default.isObject(e)?i[r.default.snakeCase(n)]=(0,t.snakeCaseKeys)(e):i[r.default.snakeCase(n)]=e})),i}return r.default.isArray(e)?r.default.map(e,(e=>i(e))):i(e)}},5960:function(e,t,i){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(i(7147)),s=n(i(9344));var r="",o="";t.default={setKey:(e,t)=>{r=e,o=t},setKeyFromPath:e=>{var t,i;r=null===(t=a.default.readFileSync(`${e}/private.key`))||void 0===t?void 0:t.toString(),o=null===(i=a.default.readFileSync(`${e}/public.key`))||void 0===i?void 0:i.toString()},sign:(e,t)=>s.default.sign(e,r,t),verify:(e,t)=>{try{return s.default.verify(e,o,t)}catch(e){return!1}},decode:e=>s.default.decode(e,{complete:!0})}},9572:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,a)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;const r=s(i(7773));t.logger=r.default.createLogger({format:r.format.combine(r.format.timestamp(),r.format.splat(),r.format.simple()),transports:[new r.default.transports.File({filename:"error.log",level:"error"}),new r.default.transports.File({filename:"combined.log",level:"info"})],exceptionHandlers:[new r.default.transports.File({filename:"exceptions.log"})]})},5107:e=>{e.exports=require("@azure/storage-blob")},2167:e=>{e.exports=require("axios")},7096:e=>{e.exports=require("bcrypt")},5022:e=>{e.exports=require("chalk")},7455:e=>{e.exports=require("compression")},3582:e=>{e.exports=require("cors")},5142:e=>{e.exports=require("dotenv")},6860:e=>{e.exports=require("express")},7806:e=>{e.exports=require("helmet")},9344:e=>{e.exports=require("jsonwebtoken")},6517:e=>{e.exports=require("lodash")},2245:e=>{e.exports=require("moment")},9470:e=>{e.exports=require("morgan")},9424:e=>{e.exports=require("mssql")},1738:e=>{e.exports=require("multer")},6891:e=>{e.exports=require("nocache")},5184:e=>{e.exports=require("nodemailer")},7325:e=>{e.exports=require("randomstring")},9669:e=>{e.exports=require("rate-limiter-flexible")},7441:e=>{e.exports=require("sharp")},5828:e=>{e.exports=require("uuid")},7773:e=>{e.exports=require("winston")},5609:e=>{e.exports=require("yup")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},1017:e=>{e.exports=require("path")}},t={};!function i(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}(7728)})();